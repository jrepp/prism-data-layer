<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-rfc docs-version-current docs-doc-page docs-doc-id-rfc-001" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Prism Data Access Layer Architecture | Prism</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://jrepp.github.io/prism-data-layer/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://jrepp.github.io/prism-data-layer/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://jrepp.github.io/prism-data-layer/rfc/rfc-001"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-rfc-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-rfc-current"><meta data-rh="true" property="og:title" content="Prism Data Access Layer Architecture | Prism"><meta data-rh="true" name="description" content="Abstract"><meta data-rh="true" property="og:description" content="Abstract"><link data-rh="true" rel="icon" href="/prism-data-layer/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jrepp.github.io/prism-data-layer/rfc/rfc-001"><link data-rh="true" rel="alternate" href="https://jrepp.github.io/prism-data-layer/rfc/rfc-001" hreflang="en"><link data-rh="true" rel="alternate" href="https://jrepp.github.io/prism-data-layer/rfc/rfc-001" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Prism Data Access Layer Architecture • RFC-001","item":"https://jrepp.github.io/prism-data-layer/rfc/rfc-001"}]}</script><link rel="stylesheet" href="/prism-data-layer/assets/css/styles.3b9928e7.css">
<script src="/prism-data-layer/assets/js/runtime~main.3c9822a6.js" defer="defer"></script>
<script src="/prism-data-layer/assets/js/main.ce16e020.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/prism-data-layer/"><div class="navbar__logo"><img src="/prism-data-layer/img/prism-logo-transparent-background.png" alt="Prism Data Gateway Logo" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="32"><img src="/prism-data-layer/img/prism-logo-transparent-background.png" alt="Prism Data Gateway Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="32"></div><b class="navbar__title text--truncate">Prism</b></a><a class="navbar__item navbar__link" href="/prism-data-layer/docs/intro">Overview</a><a class="navbar__item navbar__link" href="/prism-data-layer/docs/changelog">Change Log</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Documentation</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/prism-data-layer/adr">ADRs (Architecture Decision Records)</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/prism-data-layer/rfc">RFCs (Request for Comments)</a></li><li><a class="dropdown__link" href="/prism-data-layer/memos">Memos (Technical Analysis)</a></li><li><a class="dropdown__link" href="/prism-data-layer/prds">PRDs (Product Requirements)</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="buildInfo_asc2"><span class="version_ADrX" title="Build: ebbc5f9">ebbc5f9</span><span class="separator_VfCt">•</span><span class="buildTime_n1Nn" title="Last updated: Oct 13, 2:10 PM PDT">Oct 13, 2:10 PM PDT</span></div><div class="navbar__item"><a href="https://github.com/jrepp/prism-data-layer/actions/workflows/docs.yml" target="_blank" rel="noopener noreferrer" title="GitHub Pages" style="display: flex; align-items: center; padding: 0 0.5rem;"><img src="https://github.com/jrepp/prism-data-layer/actions/workflows/docs.yml/badge.svg" alt="Build" style="margin: 0;"></a></div><a href="https://github.com/jrepp/prism-data-layer" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_x44X"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/"><span title="Request for Comments (RFCs)" class="linkLabel_WmDU">Request for Comments (RFCs)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/prism-data-layer/rfc/rfc-001"><span title="Prism Data Access Layer Architecture • RFC-001" class="linkLabel_WmDU">Prism Data Access Layer Architecture • RFC-001</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-002"><span title="Data Layer Interface Specification • RFC-002" class="linkLabel_WmDU">Data Layer Interface Specification • RFC-002</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-003"><span title="Admin Interface for Prism • RFC-003" class="linkLabel_WmDU">Admin Interface for Prism • RFC-003</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-004"><span title="Redis Integration for Cache, PubSub, and Vector Search • RFC-004" class="linkLabel_WmDU">Redis Integration for Cache, PubSub, and Vector Search • RFC-004</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-005"><span title="ClickHouse Integration for Time Series Analytics • RFC-005" class="linkLabel_WmDU">ClickHouse Integration for Time Series Analytics • RFC-005</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-006"><span title="RFC-006 Admin CLI" class="linkLabel_WmDU">RFC-006 Admin CLI</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-007"><span title="RFC-007 Cache Strategies" class="linkLabel_WmDU">RFC-007 Cache Strategies</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-008"><span title="RFC-008 Plugin Architecture" class="linkLabel_WmDU">RFC-008 Plugin Architecture</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-009"><span title="Distributed Reliability Data Patterns • RFC-009" class="linkLabel_WmDU">Distributed Reliability Data Patterns • RFC-009</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-010"><span title="Admin Protocol with OIDC Authentication • RFC-010" class="linkLabel_WmDU">Admin Protocol with OIDC Authentication • RFC-010</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-011"><span title="Data Proxy Authentication (Input/Output) • RFC-011" class="linkLabel_WmDU">Data Proxy Authentication (Input/Output) • RFC-011</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-012"><span title="Prism Network Gateway (prism-netgw) - Multi-Region Control Plane • RFC-012" class="linkLabel_WmDU">Prism Network Gateway (prism-netgw) - Multi-Region Control Plane • RFC-012</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-013"><span title="Neptune Graph Backend Implementation • RFC-013" class="linkLabel_WmDU">Neptune Graph Backend Implementation • RFC-013</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-014"><span title="Layered Data Access Patterns • RFC-014" class="linkLabel_WmDU">Layered Data Access Patterns • RFC-014</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-015"><span title="Plugin Acceptance Test Framework (Interface-Based Testing) • RFC-015" class="linkLabel_WmDU">Plugin Acceptance Test Framework (Interface-Based Testing) • RFC-015</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-016"><span title="Local Development Infrastructure • RFC-016" class="linkLabel_WmDU">Local Development Infrastructure • RFC-016</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-017"><span title="Multicast Registry Pattern • RFC-017" class="linkLabel_WmDU">Multicast Registry Pattern • RFC-017</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-018"><span title="POC Implementation Strategy • RFC-018" class="linkLabel_WmDU">POC Implementation Strategy • RFC-018</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-019"><span title="Pattern SDK Authorization Layer - Token Validation and Policy Enforcement • RFC-019" class="linkLabel_WmDU">Pattern SDK Authorization Layer - Token Validation and Policy Enforcement • RFC-019</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-020"><span title="Streaming HTTP Listener - API-Specific Adapter Pattern • RFC-020" class="linkLabel_WmDU">Streaming HTTP Listener - API-Specific Adapter Pattern • RFC-020</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-021"><span title="POC 1 - Three Minimal Plugins Implementation Plan • RFC-021" class="linkLabel_WmDU">POC 1 - Three Minimal Plugins Implementation Plan • RFC-021</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-022"><span title="Core Pattern SDK - Build System and Physical Code Layout • RFC-022" class="linkLabel_WmDU">Core Pattern SDK - Build System and Physical Code Layout • RFC-022</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-023"><span title="Publish Snapshotter Plugin - Write-Only Event Buffering with Pagination • RFC-023" class="linkLabel_WmDU">Publish Snapshotter Plugin - Write-Only Event Buffering with Pagination • RFC-023</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-024"><span title="Distributed Session Store Pattern - Cross-Region Session Management • RFC-024" class="linkLabel_WmDU">Distributed Session Store Pattern - Cross-Region Session Management • RFC-024</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-025"><span title="Pattern SDK Architecture - Backend Drivers and Concurrency Primitives • RFC-025" class="linkLabel_WmDU">Pattern SDK Architecture - Backend Drivers and Concurrency Primitives • RFC-025</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-026"><span title="POC 1 - KeyValue with MemStore Implementation Plan (Original) • RFC-026" class="linkLabel_WmDU">POC 1 - KeyValue with MemStore Implementation Plan (Original) • RFC-026</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-027"><span title="Namespace Configuration and Client Request Flow • RFC-027" class="linkLabel_WmDU">Namespace Configuration and Client Request Flow • RFC-027</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-028"><span title="prism-probe - CLI Client for Testing and Debugging • RFC-028" class="linkLabel_WmDU">prism-probe - CLI Client for Testing and Debugging • RFC-028</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-029"><span title="Load Testing Framework Evaluation and Strategy • RFC-029" class="linkLabel_WmDU">Load Testing Framework Evaluation and Strategy • RFC-029</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/rfc/rfc-030"><span title="Schema Evolution and Validation for Decoupled Pub/Sub • RFC-030" class="linkLabel_WmDU">Schema Evolution and Validation for Decoupled Pub/Sub • RFC-030</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/prism-data-layer/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Prism Data Access Layer Architecture • RFC-001</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="docMetadata_NQcq"><div class="metadataRow_PvZM"><span class="metadataItem_RMFE info_Qo8L"><strong>Status:</strong> <!-- -->Draft</span><span class="metadataItem_RMFE"><strong>Author:</strong> <!-- -->Core Team</span><span class="metadataItem_RMFE"><strong>Created:</strong> <!-- -->Oct 6, 2025</span><span class="metadataItem_RMFE"><strong>Updated:</strong> <!-- -->Oct 6, 2025</span></div></div><div class="theme-doc-markdown markdown"><header><h1>Prism Data Access Layer Architecture</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="abstract">Abstract<a href="#abstract" class="hash-link" aria-label="Direct link to Abstract" title="Direct link to Abstract" translate="no">​</a></h2>
<p>This RFC defines the complete architecture for Prism, a high-performance data access layer gateway that provides a unified, client-configurable interface to heterogeneous data backends. Prism is inspired by Netflix&#x27;s Data Gateway but designed for superior performance, developer experience, and operational simplicity.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-introduction">1. Introduction<a href="#1-introduction" class="hash-link" aria-label="Direct link to 1. Introduction" title="Direct link to 1. Introduction" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-purpose">1.1 Purpose<a href="#11-purpose" class="hash-link" aria-label="Direct link to 1.1 Purpose" title="Direct link to 1.1 Purpose" translate="no">​</a></h3>
<p>Prism addresses the complexity of managing multiple data backends in modern applications by providing:</p>
<ol>
<li><strong>Unified Interface</strong>: Single gRPC API for accessing databases, message queues, and pub/sub systems</li>
<li><strong>Dynamic Configuration</strong>: Clients declare their data access patterns; Prism handles provisioning and routing</li>
<li><strong>Performance</strong>: Rust-based proxy with sub-millisecond overhead and 10k+ RPS per connection</li>
<li><strong>Backend Abstraction</strong>: Applications can switch backends without code changes</li>
<li><strong>Observability</strong>: Built-in tracing, metrics, and audit logging</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-goals">1.2 Goals<a href="#12-goals" class="hash-link" aria-label="Direct link to 1.2 Goals" title="Direct link to 1.2 Goals" translate="no">​</a></h3>
<ul>
<li><strong>Performance</strong>: P99 latency <code>&lt;10ms</code>, 10k+ RPS sustained per connection</li>
<li><strong>Flexibility</strong>: Support multiple access patterns (KV, Queue, PubSub, Paged Reader, Transactions)</li>
<li><strong>Scalability</strong>: Horizontal scaling of both proxy and backend-specific containers</li>
<li><strong>Security</strong>: mTLS, OAuth2, PII tagging, audit logging</li>
<li><strong>Developer Experience</strong>: Type-safe gRPC interfaces with generated clients</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-non-goals">1.3 Non-Goals<a href="#13-non-goals" class="hash-link" aria-label="Direct link to 1.3 Non-Goals" title="Direct link to 1.3 Non-Goals" translate="no">​</a></h3>
<ul>
<li><strong>Not a database</strong>: Prism is a gateway, not a storage engine</li>
<li><strong>Not for complex queries</strong>: Simple access patterns only; complex analytics use dedicated tools</li>
<li><strong>Not a cache</strong>: Caching is optional per-namespace configuration</li>
<li><strong>Not a message broker</strong>: Prism wraps existing brokers (Kafka, NATS), doesn&#x27;t replace them</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-architecture-overview">2. Architecture Overview<a href="#2-architecture-overview" class="hash-link" aria-label="Direct link to 2. Architecture Overview" title="Direct link to 2. Architecture Overview" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-system-components">2.1 System Components<a href="#21-system-components" class="hash-link" aria-label="Direct link to 2.1 System Components" title="Direct link to 2.1 System Components" translate="no">​</a></h3>
<p>┌──────────────────────────────────────────────────────────┐
│                   Client Applications                    │
│              (Go, Rust, Python, JavaScript)              │
└────────────────────────┬─────────────────────────────────┘
│ gRPC/HTTP2
│
┌────────────────────────▼─────────────────────────────────┐
│                   Prism Proxy Core                       │
│                   (Rust + Tokio)                         │
│                                                           │
│  ┌─────────────┐  ┌─────────────┐  ┌──────────────┐    │
│  │   Config    │  │   Session   │  │    Queue     │    │
│  │   Service   │  │   Service   │  │   Service    │    │
│  └─────────────┘  └─────────────┘  └──────────────┘    │
│                                                           │
│  ┌─────────────┐  ┌─────────────┐  ┌──────────────┐    │
│  │   PubSub    │  │   Reader    │  │   Transact   │    │
│  │   Service   │  │   Service   │  │   Service    │    │
│  └─────────────┘  └─────────────┘  └──────────────┘    │
└────────────────────────┬─────────────────────────────────┘
│
┌────────────────┴────────────────┐
│                                 │
┌───────▼──────────┐           ┌──────────▼────────┐
│ Container Plugins│           │ Container Plugins │
│                  │           │                   │
│ • Kafka Pub      │           │ • NATS Pub       │
│ • Kafka Con      │           │ • NATS Con       │
│ • Indexed Reader │           │ • Transact Proc  │
│ • Mailbox Listen │           │ • Custom...      │
└───────┬──────────┘           └──────────┬────────┘
│                                 │
┌───────▼──────────┐           ┌──────────▼────────┐
│     Backends     │           │     Backends      │
│                  │           │                   │
│ • Postgres       │           │ • Kafka          │
│ • SQLite         │           │ • NATS           │
│ • Neptune        │           │ • Redis          │
└──────────────────┘           └───────────────────┘</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### 2.2 Key Design Principles</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. **gRPC-First**: All communication uses gRPC for performance and type safety</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. **Session-Based**: All operations require an authenticated session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. **Layered Interfaces**: From basic (sessions) to use-case-specific (queue, pubsub, reader, transact)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. **Backend Polymorphism**: Each interface layer supports multiple backend implementations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. **Container Plugins**: Backend-specific logic deployed as independent, scalable containers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6. **Protobuf-Driven**: All APIs, configurations, and data models defined in protobuf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## 3. Client Configuration System</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### 3.1 Overview</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Prism separates **server configuration** (infrastructure) from **client configuration** (access patterns).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Server Configuration** (static, admin-controlled):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Backend connection strings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Resource pools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Auth policies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Rate limits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Client Configuration** (dynamic, runtime):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Access pattern (Queue, PubSub, Reader, Transact)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Backend selection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Consistency requirements</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Cache policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### 3.2 Configuration Descriptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Clients provide configuration as protobuf messages:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>message ClientConfig {
string name = 1;                  // Named config or custom
string version = 2;               // For evolution
AccessPattern pattern = 3;        // QUEUE, PUBSUB, READER, TRANSACT
BackendConfig backend = 4;        // Backend type + options
ConsistencyConfig consistency = 5; // EVENTUAL, STRONG, BOUNDED_STALENESS
CacheConfig cache = 6;            // TTL, size, enabled
RateLimitConfig rate_limit = 7;   // RPS, burst
string namespace = 8;             // Multi-tenancy isolation
}</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### 3.3 Configuration Sources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Named Configurations** (server-provided templates):</span><br></span></code></pre></div></div>
<h1>Client requests pre-configured pattern</h1>
<p>config, err := client.GetConfig(&quot;user-profiles&quot;)
session, err := client.StartSession(config)</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Inline Configurations** (client-provided):</span><br></span></code></pre></div></div>
<p>config := &amp;ClientConfig{
Pattern: ACCESS_PATTERN_QUEUE,
Backend: &amp;BackendConfig{Type: BACKEND_TYPE_KAFKA},
Consistency: &amp;ConsistencyConfig{Level: CONSISTENCY_LEVEL_EVENTUAL},
}
session, err := client.StartSession(config)</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### 3.4 Configuration Validation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server validates all configurations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Backend compatibility with access pattern</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Namespace existence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Rate limit sanity checks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Resource availability</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## 4. Session Management</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### 4.1 Session Lifecycle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. **Create**: Client authenticates and provides configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. **Active**: Session token used for all operations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. **Heartbeat**: Periodic keepalives extend session lifetime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. **Close**: Clean shutdown releases resources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### 4.2 Session Service API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>service SessionService {
rpc CreateSession(CreateSessionRequest) returns (CreateSessionResponse);
rpc CloseSession(CloseSessionRequest) returns (CloseSessionResponse);
rpc Heartbeat(HeartbeatRequest) returns (HeartbeatResponse);
rpc GetSession(GetSessionRequest) returns (GetSessionResponse);
}</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### 4.3 Session State</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server tracks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Session ID and token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- User/client identity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Active configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Backend connections</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Creation and expiration timestamps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Activity for idle timeout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### 4.4 Session Security</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- mTLS for service-to-service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- OAuth2/JWT for user-facing APIs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- API keys for machine clients</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Session tokens opaque to clients</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Audit log for all session events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## 5. Interface Layers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### 5.1 Layer Hierarchy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  Layer 5: Use-Case Specific Interfaces    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌────────┐ ┌────────┐ ┌────────┐        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │ Queue  │ │ PubSub │ │ Reader │        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └────────┘ └────────┘ └────────┘        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌────────┐                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │Transact│                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └────────┘                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└────────────────┬───────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌────────────────▼───────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  Layer 1: Session Service (Foundation)     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - Authentication                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - Authorization                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - Auditing                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - Connection State                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└────────────────────────────────────────────┘</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-queue-service">5.2 Queue Service<a href="#52-queue-service" class="hash-link" aria-label="Direct link to 5.2 Queue Service" title="Direct link to 5.2 Queue Service" translate="no">​</a></h3>
<p><strong>Purpose</strong>: Kafka-style message queue operations</p>
<p><strong>Operations</strong>:</p>
<ul>
<li><code>Publish</code>: Send message to topic</li>
<li><code>Subscribe</code>: Stream messages from topic (server-streaming)</li>
<li><code>Acknowledge</code>: Confirm message processing</li>
<li><code>Commit</code>: Commit offset</li>
<li><code>Seek</code>: Jump to specific offset</li>
</ul>
<p><strong>Backend Mapping</strong>:</p>
<ul>
<li>Kafka → Topics, partitions, offsets</li>
<li>NATS JetStream → Streams, consumers, sequences</li>
<li>Postgres → Table-based queue with SKIP LOCKED</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="53-pubsub-service">5.3 PubSub Service<a href="#53-pubsub-service" class="hash-link" aria-label="Direct link to 5.3 PubSub Service" title="Direct link to 5.3 PubSub Service" translate="no">​</a></h3>
<p><strong>Purpose</strong>: NATS-style publish-subscribe with topic wildcards</p>
<p><strong>Operations</strong>:</p>
<ul>
<li><code>Publish</code>: Publish event to topic</li>
<li><code>Subscribe</code>: Subscribe to topic pattern (server-streaming)</li>
<li><code>Unsubscribe</code>: Cancel subscription</li>
</ul>
<p><strong>Topic Patterns</strong>:</p>
<ul>
<li>Exact: <code>events.user.created</code></li>
<li>Wildcard: <code>events.user.*</code></li>
<li>Multi-level: <code>events.&gt;</code></li>
</ul>
<p><strong>Backend Mapping</strong>:</p>
<ul>
<li>NATS → Native subject routing</li>
<li>Kafka → Topic prefix matching</li>
<li>Redis Pub/Sub → Channel patterns</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="54-reader-service">5.4 Reader Service<a href="#54-reader-service" class="hash-link" aria-label="Direct link to 5.4 Reader Service" title="Direct link to 5.4 Reader Service" translate="no">​</a></h3>
<p><strong>Purpose</strong>: Database-style paged reading and queries</p>
<p><strong>Operations</strong>:</p>
<ul>
<li><code>Read</code>: Stream pages of data (cursor-based pagination)</li>
<li><code>Query</code>: Stream filtered/sorted results</li>
<li><code>Count</code>: Count matching records</li>
</ul>
<p><strong>Pagination</strong>:</p>
<ul>
<li>Cursor-based (opaque continuation tokens)</li>
<li>Server streams pages as client ready</li>
<li>No client-side buffering of full result set</li>
</ul>
<p><strong>Backend Mapping</strong>:</p>
<ul>
<li>Postgres/SQLite → SQL with LIMIT/OFFSET</li>
<li>DynamoDB → Query with pagination tokens</li>
<li>Neptune → Gremlin with pagination</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="55-transact-service">5.5 Transact Service<a href="#55-transact-service" class="hash-link" aria-label="Direct link to 5.5 Transact Service" title="Direct link to 5.5 Transact Service" translate="no">​</a></h3>
<p><strong>Purpose</strong>: Transactional writes across two tables (inbox/outbox pattern)</p>
<p><strong>Operations</strong>:</p>
<ul>
<li><code>Write</code>: Single transactional write (data + mailbox)</li>
<li><code>Transaction</code>: Streaming transaction (begin, writes, commit/rollback)</li>
</ul>
<p><strong>Two-Table Pattern</strong>:</p>
<ol>
<li><strong>Data Table</strong>: Business data (users, orders, etc.)</li>
<li><strong>Mailbox Table</strong>: Outbox for downstream processing</li>
</ol>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Transactional outbox pattern</li>
<li>Event sourcing with guaranteed writes</li>
<li>Saga coordination</li>
</ul>
<p><strong>Backend Mapping</strong>:</p>
<ul>
<li>Postgres/SQLite → Native transactions</li>
<li>DynamoDB → TransactWriteItems</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-container-plugin-model">6. Container Plugin Model<a href="#6-container-plugin-model" class="hash-link" aria-label="Direct link to 6. Container Plugin Model" title="Direct link to 6. Container Plugin Model" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-plugin-architecture">6.1 Plugin Architecture<a href="#61-plugin-architecture" class="hash-link" aria-label="Direct link to 6.1 Plugin Architecture" title="Direct link to 6.1 Plugin Architecture" translate="no">​</a></h3>
<p>Backend-specific functionality deployed as independent containers:</p>
<p><strong>Plugin Roles</strong>:</p>
<ul>
<li><strong>Publisher</strong>: Produces messages to backend (Kafka Publisher, NATS Publisher)</li>
<li><strong>Consumer</strong>: Consumes messages from backend (Kafka Consumer, NATS Consumer)</li>
<li><strong>Processor</strong>: Processes operations (Transaction Processor)</li>
<li><strong>Listener</strong>: Listens for events (Mailbox Listener)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62-plugin-contract">6.2 Plugin Contract<a href="#62-plugin-contract" class="hash-link" aria-label="Direct link to 6.2 Plugin Contract" title="Direct link to 6.2 Plugin Contract" translate="no">​</a></h3>
<p>All plugins implement standard interfaces:</p>
<div class="language-protobuf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-protobuf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">service</span><span class="token plain"> </span><span class="token class-name">HealthService</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">rpc</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Live</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">LiveRequest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">LiveResponse</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Liveness probe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">rpc</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Ready</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ReadyRequest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ReadyResponse</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Readiness probe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">service</span><span class="token plain"> </span><span class="token class-name">MetricsService</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">rpc</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetMetrics</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">MetricsRequest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">MetricsResponse</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Prometheus metrics</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">service</span><span class="token plain"> </span><span class="token class-name">PluginInfoService</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">rpc</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetInfo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">InfoRequest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">InfoResponse</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Name, version, role, backend</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="63-configuration">6.3 Configuration<a href="#63-configuration" class="hash-link" aria-label="Direct link to 6.3 Configuration" title="Direct link to 6.3 Configuration" translate="no">​</a></h3>
<p>Plugins configured via environment variables (12-factor):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Common</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PRISM_PROXY_ENDPOINT</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">localhost:8980</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PRISM_PLUGIN_ROLE</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">publisher</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PRISM_BACKEND_TYPE</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">kafka</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PRISM_NAMESPACE</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Backend-specific</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">KAFKA_BROKERS</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">localhost:9092</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">KAFKA_TOPIC</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">NATS_URL</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">nats://localhost:4222</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">DATABASE_URL</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">postgres://</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="64-deployment">6.4 Deployment<a href="#64-deployment" class="hash-link" aria-label="Direct link to 6.4 Deployment" title="Direct link to 6.4 Deployment" translate="no">​</a></h3>
<p><strong>Docker Compose</strong>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">prism-proxy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prism/proxy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;8980:8980&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kafka-publisher</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prism/kafka</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">publisher</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">PRISM_PROXY_ENDPOINT</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prism</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">proxy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">8980</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">KAFKA_BROKERS</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kafka</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">deploy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><br></span></code></pre></div></div>
<p><strong>Kubernetes</strong>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prism</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">kafka</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">consumer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kafka</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">consumer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prism/kafka</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">consumer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PRISM_PROXY_ENDPOINT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;prism-proxy:8980&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="65-scaling">6.5 Scaling<a href="#65-scaling" class="hash-link" aria-label="Direct link to 6.5 Scaling" title="Direct link to 6.5 Scaling" translate="no">​</a></h3>
<ul>
<li><strong>Horizontal</strong>: Deploy multiple replicas per plugin</li>
<li><strong>Independent</strong>: Scale each plugin independently based on load</li>
<li><strong>Stateless</strong>: Plugins are stateless (state in backend or proxy)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-data-flow-examples">7. Data Flow Examples<a href="#7-data-flow-examples" class="hash-link" aria-label="Direct link to 7. Data Flow Examples" title="Direct link to 7. Data Flow Examples" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="71-queue-kafka-publisher-flow">7.1 Queue: Kafka Publisher Flow<a href="#71-queue-kafka-publisher-flow" class="hash-link" aria-label="Direct link to 7.1 Queue: Kafka Publisher Flow" title="Direct link to 7.1 Queue: Kafka Publisher Flow" translate="no">​</a></h3>
<ol>
<li>Client calls <code>Publish(topic, message)</code></li>
<li>Proxy validates session</li>
<li>Proxy enqueues message to internal queue</li>
<li>Kafka Publisher container polls internal queue</li>
<li>Publisher sends to Kafka broker</li>
<li>Publisher acknowledges to proxy</li>
<li>Proxy returns <code>PublishResponse</code> to client</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="72-transactional-write-flow">7.2 Transactional Write Flow<a href="#72-transactional-write-flow" class="hash-link" aria-label="Direct link to 7.2 Transactional Write Flow" title="Direct link to 7.2 Transactional Write Flow" translate="no">​</a></h3>
<ol>
<li>Client calls <code>Write(data, mailbox)</code></li>
<li>Proxy routes to Transaction Processor container</li>
<li>Processor begins database transaction</li>
<li>Processor inserts into data table</li>
<li>Processor inserts into mailbox table</li>
<li>Processor commits transaction</li>
<li>Processor returns success to proxy</li>
<li>Proxy returns <code>WriteResponse</code> to client</li>
<li>Mailbox Listener container polls mailbox table</li>
<li>Listener processes new messages</li>
<li>Listener marks messages as processed</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="73-paged-reader-flow">7.3 Paged Reader Flow<a href="#73-paged-reader-flow" class="hash-link" aria-label="Direct link to 7.3 Paged Reader Flow" title="Direct link to 7.3 Paged Reader Flow" translate="no">​</a></h3>
<ol>
<li>Client calls <code>Read(collection, page_size=100)</code></li>
<li>Proxy starts server-streaming response</li>
<li>Indexed Reader container queries database (LIMIT 100)</li>
<li>Reader streams page 1 to proxy</li>
<li>Proxy streams page 1 to client</li>
<li>Reader queries next page (OFFSET 100)</li>
<li>Reader streams page 2 to proxy</li>
<li>Proxy streams page 2 to client</li>
<li>Repeat until no more results</li>
<li>Reader closes stream</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-observability">8. Observability<a href="#8-observability" class="hash-link" aria-label="Direct link to 8. Observability" title="Direct link to 8. Observability" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="81-distributed-tracing">8.1 Distributed Tracing<a href="#81-distributed-tracing" class="hash-link" aria-label="Direct link to 8.1 Distributed Tracing" title="Direct link to 8.1 Distributed Tracing" translate="no">​</a></h3>
<ul>
<li>OpenTelemetry from day one</li>
<li>Spans for all gRPC operations</li>
<li>Trace propagation across services</li>
<li>Export to Jaeger/Tempo</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="82-metrics">8.2 Metrics<a href="#82-metrics" class="hash-link" aria-label="Direct link to 8.2 Metrics" title="Direct link to 8.2 Metrics" translate="no">​</a></h3>
<p><strong>Proxy Metrics</strong>:</p>
<ul>
<li>Request rate (per service)</li>
<li>Request latency (P50, P95, P99)</li>
<li>Active sessions</li>
<li>Backend connection pool utilization</li>
<li>Cache hit rate</li>
</ul>
<p><strong>Plugin Metrics</strong>:</p>
<ul>
<li>Messages published/consumed</li>
<li>Processing latency</li>
<li>Error rate</li>
<li>Queue depth</li>
</ul>
<p><strong>Export</strong>: Prometheus <code>/metrics</code> endpoint</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="83-logging">8.3 Logging<a href="#83-logging" class="hash-link" aria-label="Direct link to 8.3 Logging" title="Direct link to 8.3 Logging" translate="no">​</a></h3>
<p><strong>Rust (Proxy)</strong>:</p>
<ul>
<li><code>tracing</code> crate for structured logging</li>
<li>JSON output in production</li>
<li>Span context for correlation</li>
</ul>
<p><strong>Go (Tooling/Clients)</strong>:</p>
<ul>
<li><code>slog</code> for structured logging</li>
<li>Context propagation</li>
<li>JSON output</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="84-audit-logging">8.4 Audit Logging<a href="#84-audit-logging" class="hash-link" aria-label="Direct link to 8.4 Audit Logging" title="Direct link to 8.4 Audit Logging" translate="no">​</a></h3>
<p>All operations logged with:</p>
<ul>
<li>Session ID</li>
<li>User identity</li>
<li>Operation type</li>
<li>Resource accessed</li>
<li>Timestamp</li>
<li>Success/failure</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="9-security">9. Security<a href="#9-security" class="hash-link" aria-label="Direct link to 9. Security" title="Direct link to 9. Security" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="91-authentication">9.1 Authentication<a href="#91-authentication" class="hash-link" aria-label="Direct link to 9.1 Authentication" title="Direct link to 9.1 Authentication" translate="no">​</a></h3>
<p><strong>Service-to-Service</strong>:</p>
<ul>
<li>mTLS with mutual certificate validation</li>
<li>Certificate rotation</li>
</ul>
<p><strong>User-Facing</strong>:</p>
<ul>
<li>OAuth2 with JWT tokens</li>
<li>API keys for machine clients</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="92-authorization">9.2 Authorization<a href="#92-authorization" class="hash-link" aria-label="Direct link to 9.2 Authorization" title="Direct link to 9.2 Authorization" translate="no">​</a></h3>
<ul>
<li>Namespace-level policies</li>
<li>Role-based access control (RBAC)</li>
<li>Operation-level permissions</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="93-data-protection">9.3 Data Protection<a href="#93-data-protection" class="hash-link" aria-label="Direct link to 9.3 Data Protection" title="Direct link to 9.3 Data Protection" translate="no">​</a></h3>
<p><strong>PII Tagging</strong>:</p>
<div class="language-protobuf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-protobuf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">message</span><span class="token plain"> </span><span class="token class-name">UserProfile</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin">string</span><span class="token plain"> user_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin">string</span><span class="token plain"> email </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prism</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pii</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin">string</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prism</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pii</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;name&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>Automatic Handling</strong>:</p>
<ul>
<li>Encryption at rest (per-field)</li>
<li>Audit logging for PII access</li>
<li>Masking in logs</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="10-performance-targets">10. Performance Targets<a href="#10-performance-targets" class="hash-link" aria-label="Direct link to 10. Performance Targets" title="Direct link to 10. Performance Targets" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="101-latency">10.1 Latency<a href="#101-latency" class="hash-link" aria-label="Direct link to 10.1 Latency" title="Direct link to 10.1 Latency" translate="no">​</a></h3>
<ul>
<li><strong>P50</strong>: <code>&lt;2ms overhead</code></li>
<li><strong>P95</strong>: <code>&lt;5ms overhead</code></li>
<li><strong>P99</strong>: <code>&lt;10ms overhead</code></li>
</ul>
<p>(Overhead measured from gRPC request receipt to backend call)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="102-throughput">10.2 Throughput<a href="#102-throughput" class="hash-link" aria-label="Direct link to 10.2 Throughput" title="Direct link to 10.2 Throughput" translate="no">​</a></h3>
<ul>
<li><strong>Per connection</strong>: 10k+ RPS sustained</li>
<li><strong>Per proxy instance</strong>: 100k+ RPS (10k connections × 10 RPS)</li>
<li><strong>Horizontally scalable</strong>: Add more proxy instances</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="103-resource-utilization">10.3 Resource Utilization<a href="#103-resource-utilization" class="hash-link" aria-label="Direct link to 10.3 Resource Utilization" title="Direct link to 10.3 Resource Utilization" translate="no">​</a></h3>
<ul>
<li><strong>Proxy</strong>: <code>&lt;500MB RAM</code> per instance</li>
<li><strong>Plugins</strong>: <code>&lt;100MB RAM</code> per container</li>
<li><strong>CPU</strong>: <code>&lt;10% overhead</code> for routing logic</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="11-implementation-roadmap">11. Implementation Roadmap<a href="#11-implementation-roadmap" class="hash-link" aria-label="Direct link to 11. Implementation Roadmap" title="Direct link to 11. Implementation Roadmap" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-1-foundation-weeks-1-4">Phase 1: Foundation (Weeks 1-4)<a href="#phase-1-foundation-weeks-1-4" class="hash-link" aria-label="Direct link to Phase 1: Foundation (Weeks 1-4)" title="Direct link to Phase 1: Foundation (Weeks 1-4)" translate="no">​</a></h3>
<p><strong>Week 1</strong>:</p>
<ul>
<li>✅ Protobuf foundation (ADR-011, Step 1 complete)</li>
<li>Rust proxy skeleton (Step 2)</li>
</ul>
<p><strong>Week 2</strong>:</p>
<ul>
<li>KeyValue protobuf + stubs (Step 3)</li>
<li>SQLite backend implementation (Step 4)</li>
</ul>
<p><strong>Week 3-4</strong>:</p>
<ul>
<li>Integration tests + CI (Step 5)</li>
<li>Postgres backend + docs (Step 6)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-2-sessions--config-weeks-5-6">Phase 2: Sessions + Config (Weeks 5-6)<a href="#phase-2-sessions--config-weeks-5-6" class="hash-link" aria-label="Direct link to Phase 2: Sessions + Config (Weeks 5-6)" title="Direct link to Phase 2: Sessions + Config (Weeks 5-6)" translate="no">​</a></h3>
<ul>
<li>Dynamic client configuration system (ADR-022)</li>
<li>Session service implementation</li>
<li>Named configuration storage</li>
<li>Auth integration (mTLS, OAuth2)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-3-queue-layer-weeks-7-8">Phase 3: Queue Layer (Weeks 7-8)<a href="#phase-3-queue-layer-weeks-7-8" class="hash-link" aria-label="Direct link to Phase 3: Queue Layer (Weeks 7-8)" title="Direct link to Phase 3: Queue Layer (Weeks 7-8)" translate="no">​</a></h3>
<ul>
<li>Queue service protobuf + implementation</li>
<li>Kafka publisher container</li>
<li>Kafka consumer container</li>
<li>Integration tests with local Kafka</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-4-pubsub-layer-weeks-9-10">Phase 4: PubSub Layer (Weeks 9-10)<a href="#phase-4-pubsub-layer-weeks-9-10" class="hash-link" aria-label="Direct link to Phase 4: PubSub Layer (Weeks 9-10)" title="Direct link to Phase 4: PubSub Layer (Weeks 9-10)" translate="no">​</a></h3>
<ul>
<li>PubSub service protobuf + implementation</li>
<li>NATS publisher container</li>
<li>NATS consumer container</li>
<li>Topic pattern matching</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-5-reader-layer-weeks-11-12">Phase 5: Reader Layer (Weeks 11-12)<a href="#phase-5-reader-layer-weeks-11-12" class="hash-link" aria-label="Direct link to Phase 5: Reader Layer (Weeks 11-12)" title="Direct link to Phase 5: Reader Layer (Weeks 11-12)" translate="no">​</a></h3>
<ul>
<li>Reader service protobuf + implementation</li>
<li>Indexed reader container</li>
<li>Cursor-based pagination</li>
<li>Query filtering</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-6-transact-layer-weeks-13-14">Phase 6: Transact Layer (Weeks 13-14)<a href="#phase-6-transact-layer-weeks-13-14" class="hash-link" aria-label="Direct link to Phase 6: Transact Layer (Weeks 13-14)" title="Direct link to Phase 6: Transact Layer (Weeks 13-14)" translate="no">​</a></h3>
<ul>
<li>Transact service protobuf + implementation</li>
<li>Transaction processor container</li>
<li>Mailbox listener container</li>
<li>Two-table transaction tests</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-7-production-readiness-weeks-15-16">Phase 7: Production Readiness (Weeks 15-16)<a href="#phase-7-production-readiness-weeks-15-16" class="hash-link" aria-label="Direct link to Phase 7: Production Readiness (Weeks 15-16)" title="Direct link to Phase 7: Production Readiness (Weeks 15-16)" translate="no">​</a></h3>
<ul>
<li>OpenTelemetry integration</li>
<li>Prometheus metrics</li>
<li>Performance benchmarking</li>
<li>Load testing</li>
<li>Documentation</li>
<li>Deployment guides</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="12-success-criteria">12. Success Criteria<a href="#12-success-criteria" class="hash-link" aria-label="Direct link to 12. Success Criteria" title="Direct link to 12. Success Criteria" translate="no">​</a></h2>
<p>✅ <strong>Functional</strong>:</p>
<ul>
<li>All 5 interface layers implemented</li>
<li>All backend plugins working</li>
<li>End-to-end tests passing</li>
</ul>
<p>✅ <strong>Performance</strong>:</p>
<ul>
<li>P99 <code>&lt;10ms latency</code></li>
<li>10k+ RPS sustained</li>
</ul>
<p>✅ <strong>Operational</strong>:</p>
<ul>
<li>Deployed to production</li>
<li>Monitoring dashboards</li>
<li>Runbooks complete</li>
</ul>
<p>✅ <strong>Developer Experience</strong>:</p>
<ul>
<li>Client libraries for Go, Rust, Python</li>
<li>Complete API documentation</li>
<li>Example applications</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="13-open-questions">13. Open Questions<a href="#13-open-questions" class="hash-link" aria-label="Direct link to 13. Open Questions" title="Direct link to 13. Open Questions" translate="no">​</a></h2>
<ol>
<li><strong>Shadow traffic</strong>: When to implement for backend migrations?</li>
<li><strong>Multi-region</strong>: Active-active or active-passive?</li>
<li><strong>Cache layer</strong>: Implement now or defer?</li>
<li><strong>Admin UI</strong>: Build Ember UI or defer to CLI tools?</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="14-references">14. References<a href="#14-references" class="hash-link" aria-label="Direct link to 14. References" title="Direct link to 14. References" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="adrs">ADRs<a href="#adrs" class="hash-link" aria-label="Direct link to ADRs" title="Direct link to ADRs" translate="no">​</a></h3>
<ul>
<li>ADR-001: Rust for the Proxy</li>
<li>ADR-003: Protobuf as Single Source of Truth</li>
<li>ADR-011: Implementation Roadmap</li>
<li>ADR-022: Dynamic Client Configuration</li>
<li>ADR-023: gRPC-First Interface Design</li>
<li>ADR-024: Layered Interface Hierarchy</li>
<li>ADR-025: Container Plugin Model</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="external">External<a href="#external" class="hash-link" aria-label="Direct link to External" title="Direct link to External" translate="no">​</a></h3>
<ul>
<li><a href="https://netflixtechblog.com/data-gateway-a-platform-for-growing-and-protecting-the-data-tier-f1-2019-3fd1a829503" target="_blank" rel="noopener noreferrer">Netflix Data Gateway</a></li>
<li><a href="https://grpc.io" target="_blank" rel="noopener noreferrer">gRPC Documentation</a></li>
<li><a href="https://microservices.io/patterns/data/transactional-outbox.html" target="_blank" rel="noopener noreferrer">Inbox/Outbox Pattern</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="15-revision-history">15. Revision History<a href="#15-revision-history" class="hash-link" aria-label="Direct link to 15. Revision History" title="Direct link to 15. Revision History" translate="no">​</a></h2>
<ul>
<li>2025-10-07: Initial draft</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/jrepp/prism-data-layer/tree/main/docs-cms/../docs-cms/rfcs/rfc-001-prism-architecture.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/prism-data-layer/rfc/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Request for Comments (RFCs)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/prism-data-layer/rfc/rfc-002"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Data Layer Interface Specification • RFC-002</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#abstract" class="table-of-contents__link toc-highlight">Abstract</a></li><li><a href="#1-introduction" class="table-of-contents__link toc-highlight">1. Introduction</a><ul><li><a href="#11-purpose" class="table-of-contents__link toc-highlight">1.1 Purpose</a></li><li><a href="#12-goals" class="table-of-contents__link toc-highlight">1.2 Goals</a></li><li><a href="#13-non-goals" class="table-of-contents__link toc-highlight">1.3 Non-Goals</a></li></ul></li><li><a href="#2-architecture-overview" class="table-of-contents__link toc-highlight">2. Architecture Overview</a><ul><li><a href="#21-system-components" class="table-of-contents__link toc-highlight">2.1 System Components</a></li><li><a href="#52-queue-service" class="table-of-contents__link toc-highlight">5.2 Queue Service</a></li><li><a href="#53-pubsub-service" class="table-of-contents__link toc-highlight">5.3 PubSub Service</a></li><li><a href="#54-reader-service" class="table-of-contents__link toc-highlight">5.4 Reader Service</a></li><li><a href="#55-transact-service" class="table-of-contents__link toc-highlight">5.5 Transact Service</a></li></ul></li><li><a href="#6-container-plugin-model" class="table-of-contents__link toc-highlight">6. Container Plugin Model</a><ul><li><a href="#61-plugin-architecture" class="table-of-contents__link toc-highlight">6.1 Plugin Architecture</a></li><li><a href="#62-plugin-contract" class="table-of-contents__link toc-highlight">6.2 Plugin Contract</a></li><li><a href="#63-configuration" class="table-of-contents__link toc-highlight">6.3 Configuration</a></li><li><a href="#64-deployment" class="table-of-contents__link toc-highlight">6.4 Deployment</a></li><li><a href="#65-scaling" class="table-of-contents__link toc-highlight">6.5 Scaling</a></li></ul></li><li><a href="#7-data-flow-examples" class="table-of-contents__link toc-highlight">7. Data Flow Examples</a><ul><li><a href="#71-queue-kafka-publisher-flow" class="table-of-contents__link toc-highlight">7.1 Queue: Kafka Publisher Flow</a></li><li><a href="#72-transactional-write-flow" class="table-of-contents__link toc-highlight">7.2 Transactional Write Flow</a></li><li><a href="#73-paged-reader-flow" class="table-of-contents__link toc-highlight">7.3 Paged Reader Flow</a></li></ul></li><li><a href="#8-observability" class="table-of-contents__link toc-highlight">8. Observability</a><ul><li><a href="#81-distributed-tracing" class="table-of-contents__link toc-highlight">8.1 Distributed Tracing</a></li><li><a href="#82-metrics" class="table-of-contents__link toc-highlight">8.2 Metrics</a></li><li><a href="#83-logging" class="table-of-contents__link toc-highlight">8.3 Logging</a></li><li><a href="#84-audit-logging" class="table-of-contents__link toc-highlight">8.4 Audit Logging</a></li></ul></li><li><a href="#9-security" class="table-of-contents__link toc-highlight">9. Security</a><ul><li><a href="#91-authentication" class="table-of-contents__link toc-highlight">9.1 Authentication</a></li><li><a href="#92-authorization" class="table-of-contents__link toc-highlight">9.2 Authorization</a></li><li><a href="#93-data-protection" class="table-of-contents__link toc-highlight">9.3 Data Protection</a></li></ul></li><li><a href="#10-performance-targets" class="table-of-contents__link toc-highlight">10. Performance Targets</a><ul><li><a href="#101-latency" class="table-of-contents__link toc-highlight">10.1 Latency</a></li><li><a href="#102-throughput" class="table-of-contents__link toc-highlight">10.2 Throughput</a></li><li><a href="#103-resource-utilization" class="table-of-contents__link toc-highlight">10.3 Resource Utilization</a></li></ul></li><li><a href="#11-implementation-roadmap" class="table-of-contents__link toc-highlight">11. Implementation Roadmap</a><ul><li><a href="#phase-1-foundation-weeks-1-4" class="table-of-contents__link toc-highlight">Phase 1: Foundation (Weeks 1-4)</a></li><li><a href="#phase-2-sessions--config-weeks-5-6" class="table-of-contents__link toc-highlight">Phase 2: Sessions + Config (Weeks 5-6)</a></li><li><a href="#phase-3-queue-layer-weeks-7-8" class="table-of-contents__link toc-highlight">Phase 3: Queue Layer (Weeks 7-8)</a></li><li><a href="#phase-4-pubsub-layer-weeks-9-10" class="table-of-contents__link toc-highlight">Phase 4: PubSub Layer (Weeks 9-10)</a></li><li><a href="#phase-5-reader-layer-weeks-11-12" class="table-of-contents__link toc-highlight">Phase 5: Reader Layer (Weeks 11-12)</a></li><li><a href="#phase-6-transact-layer-weeks-13-14" class="table-of-contents__link toc-highlight">Phase 6: Transact Layer (Weeks 13-14)</a></li><li><a href="#phase-7-production-readiness-weeks-15-16" class="table-of-contents__link toc-highlight">Phase 7: Production Readiness (Weeks 15-16)</a></li></ul></li><li><a href="#12-success-criteria" class="table-of-contents__link toc-highlight">12. Success Criteria</a></li><li><a href="#13-open-questions" class="table-of-contents__link toc-highlight">13. Open Questions</a></li><li><a href="#14-references" class="table-of-contents__link toc-highlight">14. References</a><ul><li><a href="#adrs" class="table-of-contents__link toc-highlight">ADRs</a></li><li><a href="#external" class="table-of-contents__link toc-highlight">External</a></li></ul></li><li><a href="#15-revision-history" class="table-of-contents__link toc-highlight">15. Revision History</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/docs/intro">Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/docs/changelog">Change Log</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/adr">ADRs</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/rfc">RFCs</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/memos">Memos</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/prds">PRDs</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Project</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/jrepp/prism-data-layer" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><div>Copyright © 2025 Prism. Built with Docusaurus.</div><div style="margin-top:0.5rem;font-size:0.875rem;opacity:0.8"><span>Version <!-- -->ebbc5f9</span><span> • </span><span>Built <!-- -->Oct 13, 2025, 02:10 PM PDT</span><span> • </span><span>Commit <!-- -->ebbc5f9</span></div></div></div></div></footer></div>
</body>
</html>