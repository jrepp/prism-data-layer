"use strict";(globalThis.webpackChunkdocusaurus=globalThis.webpackChunkdocusaurus||[]).push([[81039],{28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var t=i(96540);const s={},r=t.createContext(s);function l(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(r.Provider,{value:n},e.children)}},99006:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"rfc-036","title":"Minimalist Web Framework for Prism Admin UI","description":"Abstract","source":"@site/../docs-cms/rfcs/rfc-036-minimalist-web-framework-for-prism-admin.md","sourceDirName":".","slug":"/rfc-036","permalink":"/prism-data-layer/rfc/rfc-036","draft":false,"unlisted":false,"editUrl":"https://github.com/jrepp/prism-data-layer/tree/main/docs-cms/../docs-cms/rfcs/rfc-036-minimalist-web-framework-for-prism-admin.md","tags":[{"inline":true,"label":"admin","permalink":"/prism-data-layer/rfc/tags/admin"},{"inline":true,"label":"ui","permalink":"/prism-data-layer/rfc/tags/ui"},{"inline":true,"label":"go","permalink":"/prism-data-layer/rfc/tags/go"},{"inline":true,"label":"templ","permalink":"/prism-data-layer/rfc/tags/templ"},{"inline":true,"label":"htmx","permalink":"/prism-data-layer/rfc/tags/htmx"},{"inline":true,"label":"web","permalink":"/prism-data-layer/rfc/tags/web"}],"version":"current","frontMatter":{"author":"Platform Team","created":"2025-10-15T00:00:00.000Z","doc_uuid":"f7a3c8e5-2d9f-4a16-b8e2-1c3d4e5f6a7b","id":"rfc-036","project_id":"prism-data-layer","status":"Proposed","tags":["admin","ui","go","templ","htmx","web"],"title":"Minimalist Web Framework for Prism Admin UI","updated":"2025-10-15T00:00:00.000Z"},"sidebar":"rfcSidebar","previous":{"title":"Pattern Process Launcher with Bulkhead Isolation \u2022 RFC-035","permalink":"/prism-data-layer/rfc/rfc-035"}}');var s=i(74848),r=i(28453);const l={author:"Platform Team",created:new Date("2025-10-15T00:00:00.000Z"),doc_uuid:"f7a3c8e5-2d9f-4a16-b8e2-1c3d4e5f6a7b",id:"rfc-036",project_id:"prism-data-layer",status:"Proposed",tags:["admin","ui","go","templ","htmx","web"],title:"Minimalist Web Framework for Prism Admin UI",updated:new Date("2025-10-15T00:00:00.000Z")},a=void 0,d={},c=[{value:"Abstract",id:"abstract",level:2},{value:"Motivation",id:"motivation",level:2},{value:"Proposed Design",id:"proposed-design",level:2},{value:"Core Concept",id:"core-concept",level:3},{value:"Architecture Overview",id:"architecture-overview",level:3},{value:"Technology Stack and Rationale",id:"technology-stack-and-rationale",level:2},{value:"1. templ - Type-Safe HTML Templates",id:"1-templ---type-safe-html-templates",level:3},{value:"2. htmx - HTML Over the Wire",id:"2-htmx---html-over-the-wire",level:3},{value:"3. Gin - Go HTTP Framework",id:"3-gin---go-http-framework",level:3},{value:"Comparison with ADR-028",id:"comparison-with-adr-028",level:2},{value:"Project Structure",id:"project-structure",level:2},{value:"Authentication Integration",id:"authentication-integration",level:2},{value:"Security Considerations",id:"security-considerations",level:2},{value:"XSS Protection",id:"xss-protection",level:3},{value:"CSRF Protection",id:"csrf-protection",level:3},{value:"Deployment",id:"deployment",level:2},{value:"Standalone Service",id:"standalone-service",level:3},{value:"Dockerfile",id:"dockerfile",level:3},{value:"Migration Path from ADR-028",id:"migration-path-from-adr-028",level:2},{value:"Phase 1: Parallel Deployment (Week 1-2)",id:"phase-1-parallel-deployment-week-1-2",level:3},{value:"Phase 2: Feature Parity (Week 2-4)",id:"phase-2-feature-parity-week-2-4",level:3},{value:"Phase 3: Sunset FastAPI (Week 4-6)",id:"phase-3-sunset-fastapi-week-4-6",level:3},{value:"Phase 4: Optimization (Week 6-8)",id:"phase-4-optimization-week-6-8",level:3},{value:"Testing Strategy",id:"testing-strategy",level:2},{value:"Unit Tests",id:"unit-tests",level:3},{value:"Integration Tests",id:"integration-tests",level:3},{value:"Alternatives Considered",id:"alternatives-considered",level:2},{value:"Alternative 1: Keep FastAPI (ADR-028)",id:"alternative-1-keep-fastapi-adr-028",level:3},{value:"Alternative 2: React/Vue SPA",id:"alternative-2-reactvue-spa",level:3},{value:"Alternative 3: html/template (Go stdlib)",id:"alternative-3-htmltemplate-go-stdlib",level:3},{value:"Open Questions",id:"open-questions",level:2},{value:"Implementation Roadmap",id:"implementation-roadmap",level:2},{value:"Week 1-2: Foundation",id:"week-1-2-foundation",level:3},{value:"Week 3-4: Core Features",id:"week-3-4-core-features",level:3},{value:"Week 5-6: Polish and Migration",id:"week-5-6-polish-and-migration",level:3},{value:"Week 7-8: Production Readiness",id:"week-7-8-production-readiness",level:3},{value:"References",id:"references",level:2},{value:"Appendix: Implementation Guide",id:"appendix-implementation-guide",level:2},{value:"Common Patterns",id:"common-patterns",level:3},{value:"Pattern 1: Full Page Render",id:"pattern-1-full-page-render",level:4},{value:"Pattern 2: Partial/Fragment Render",id:"pattern-2-partialfragment-render",level:4},{value:"Pattern 3: Forms",id:"pattern-3-forms",level:4},{value:"Pattern 4: Search/Filter",id:"pattern-4-searchfilter",level:4},{value:"Pattern 5: Optimistic Updates",id:"pattern-5-optimistic-updates",level:4},{value:"htmx Attribute Reference",id:"htmx-attribute-reference",level:3},{value:"Best Practices",id:"best-practices",level:3},{value:"Common Gotchas",id:"common-gotchas",level:3},{value:"Revision History",id:"revision-history",level:2}];function o(e){const n={a:"a",button:"button",code:"code",div:"div",form:"form",h1:"h1",h2:"h2",h3:"h3",h4:"h4",input:"input",li:"li",link:"link",ol:"ol",p:"p",pre:"pre",script:"script",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"abstract",children:"Abstract"}),"\n",(0,s.jsxs)(n.p,{children:["This RFC proposes using ",(0,s.jsx)(n.strong,{children:"templ + htmx + Gin"})," as an alternative web framework for the Prism Admin UI, replacing the FastAPI + gRPC-Web + Vanilla JavaScript stack proposed in ADR-028. This approach provides server-side rendering with progressive enhancement, eliminates the need for a separate Python service, and aligns the admin UI with our Go-first ecosystem while maintaining simplicity and avoiding heavy JavaScript frameworks."]}),"\n",(0,s.jsx)(n.h2,{id:"motivation",children:"Motivation"}),"\n",(0,s.jsx)(n.p,{children:"The current admin UI design (ADR-028) uses FastAPI (Python) as a gRPC-Web proxy serving static files. While functional, it introduces several challenges that this RFC aims to address."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Current Challenges:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Language Fragmentation"}),": Python service alongside Go proxy, plugins, and CLI"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Deployment Complexity"}),": Separate container for admin UI (100-150MB vs 15-20MB Go binary)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Runtime Dependencies"}),": Python interpreter, pip packages, uvicorn"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Maintenance Overhead"}),": Two languages for admin functionality (prismctl in Go + UI in Python)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Performance"}),": 1-2 second startup time vs <50ms for Go binary"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Goals:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Consolidate admin UI into Go ecosystem (same language as proxy/plugins/CLI)"}),"\n",(0,s.jsx)(n.li,{children:"Eliminate Python dependency for admin UI"}),"\n",(0,s.jsx)(n.li,{children:"Maintain simplicity (no React/Vue/Angular complexity)"}),"\n",(0,s.jsx)(n.li,{children:"Preserve progressive enhancement approach (HTML over the wire)"}),"\n",(0,s.jsx)(n.li,{children:"Enable rapid UI development with compile-time type safety"}),"\n",(0,s.jsx)(n.li,{children:"Reduce deployment footprint (single Go binary vs Python + deps)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Non-Goals:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Replace prismctl (Go CLI remains primary admin tool)"}),"\n",(0,s.jsx)(n.li,{children:"Build rich SPA-style interactions (admin UI is primarily CRUD)"}),"\n",(0,s.jsx)(n.li,{children:"Support offline-first or complex client-side state management"}),"\n",(0,s.jsx)(n.li,{children:"Real-time collaborative editing features"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"proposed-design",children:"Proposed Design"}),"\n",(0,s.jsx)(n.h3,{id:"core-concept",children:"Core Concept"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Server-side rendering with progressive enhancement"}),": Return HTML fragments from Go handlers, use htmx to swap them into the DOM. No JSON APIs between UI and handlers, no JavaScript build step, no client-side state management."]}),"\n",(0,s.jsx)(n.h3,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,s.jsx)(n.p,{children:"```text\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      Browser                            \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502  HTML Pages (rendered by templ)                   \u2502 \u2502\n\u2502  \u2502  - Namespace management                           \u2502 \u2502\n\u2502  \u2502  - Session monitoring                             \u2502 \u2502\n\u2502  \u2502  - Backend health dashboard                       \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                   \u2502 HTML/HTTP (htmx AJAX)               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Prism Admin UI Service (Gin + templ) (:8000)          \u2502\n\u2502                                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502  Gin HTTP Handlers                                 \u2502 \u2502\n\u2502  \u2502  - Serve HTML pages (templ components)            \u2502 \u2502\n\u2502  \u2502  - Return HTML fragments (htmx responses)         \u2502 \u2502\n\u2502  \u2502  - OIDC authentication middleware                 \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                   \u2502 gRPC                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Prism Proxy Admin API (gRPC) (:8981)                   \u2502\n\u2502  - prism.admin.v1.AdminService                          \u2502\n\u2502  - Namespace, Session, Backend, Operational APIs        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```"}),"\n",(0,s.jsx)(n.p,{children:"This RFC is structured as both a proposal (Sections 1-5) and implementation guide (Appendix)."}),"\n",(0,s.jsx)(n.h2,{id:"technology-stack-and-rationale",children:"Technology Stack and Rationale"}),"\n",(0,s.jsx)(n.h3,{id:"1-templ---type-safe-html-templates",children:"1. templ - Type-Safe HTML Templates"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://templ.guide",children:"templ"})," provides compile-time type-safe HTML templating in Go."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example - Namespace Card Component:"})}),"\n",(0,s.jsx)(n.p,{children:"```go\n// templates/namespace.templ\npackage templates"}),"\n",(0,s.jsx)(n.p,{children:'import "prism/proto/admin/v1"'}),"\n",(0,s.jsx)(n.p,{children:"templ NamespaceCard(ns *adminv1.Namespace) {"}),"\n  ",(0,s.jsxs)(n.div,{className:"card p-4 bg-white rounded shadow",id:'{"namespace-"',"+":"","ns.name}":"",children:["\n    ",(0,s.jsx)(n.h3,{className:"text-lg font-semibold",children:"{ns.Name}"}),"\n    ",(0,s.jsx)(n.p,{className:"text-sm text-gray-600",children:"{ns.Description}"}),"\n    ",(0,s.jsx)(n.button,{"hx-delete":'{"/admin/namespaces/"',"+":"","ns.name}":"","hx-target":'{"#namespace-"',"hx-swap":"outerHTML swap:1s","hx-confirm":"Delete namespace?",className:"btn-danger mt-2",children:"\n      Delete\n    "}),"\n  "]}),"\n}\n\\`\\`\\`\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Benefits:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Compile-Time Safety"}),": Typos in field names caught at build time, not runtime"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"IDE Support"}),": Full autocomplete for Go struct fields"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Automatic Escaping"}),": XSS protection by default"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Component Composition"}),": Reusable components with type-safe props"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Rationale"}),": templ provides the type safety and developer experience of React components, but server-side. Unlike ",(0,s.jsx)(n.code,{children:"html/template"})," (Go stdlib), templ validates templates at compile time, preventing runtime errors."]}),"\n",(0,s.jsx)(n.h3,{id:"2-htmx---html-over-the-wire",children:"2. htmx - HTML Over the Wire"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://htmx.org",children:"htmx"})," enables declarative AJAX without JavaScript:"]}),"\n",(0,s.jsx)(n.p,{children:"```html"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.input,{type:"search","hx-get":"/admin/namespaces/search","hx-trigger":"keyup changed delay:300ms","hx-target":"#namespace-list"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.button,{"hx-delete":"/admin/namespaces/analytics","hx-target":"#namespace-analytics","hx-swap":"outerHTML","hx-confirm":"Delete this namespace?",children:"\nDelete\n"}),"\n```"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Benefits:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"No JavaScript Required"}),": Declarative attributes handle AJAX"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Progressive Enhancement"}),": Works without htmx (graceful degradation)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Small Footprint"}),": 14KB gzipped (vs 100KB+ for frameworks)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Server-Authoritative"}),": UI state lives on server, not client"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Rationale"}),": htmx eliminates the need for a JavaScript framework while providing modern UX patterns. Admin UI requirements (CRUD, forms, filtering) are perfectly suited to htmx's capabilities."]}),"\n",(0,s.jsx)(n.h3,{id:"3-gin---go-http-framework",children:"3. Gin - Go HTTP Framework"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://gin-gonic.com/",children:"Gin"})," provides routing, middleware, and HTTP utilities:"]}),"\n",(0,s.jsx)(n.p,{children:"```go\nfunc ListNamespaces(c *gin.Context) {\nclient := getAdminClient(c)\nresp, err := client.ListNamespaces(c.Request.Context(), &adminv1.ListNamespacesRequest{})\nif err != nil {\nrenderError(c, err)\nreturn\n}"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'// Return full page or fragment based on HX-Request header\nif c.GetHeader("HX-Request") == "true" {\n    templates.NamespaceList(resp.Namespaces).Render(c.Request.Context(), c.Writer)\n} else {\n    templates.NamespacePage(resp.Namespaces).Render(c.Request.Context(), c.Writer)\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"}\n```"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Rationale"}),": Gin is mature, performant, and widely used in the Go ecosystem. Its middleware system integrates well with OIDC auth and htmx detection."]}),"\n",(0,s.jsx)(n.h2,{id:"comparison-with-adr-028",children:"Comparison with ADR-028"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Aspect"}),(0,s.jsx)(n.th,{children:"templ+htmx+Gin (Proposed)"}),(0,s.jsx)(n.th,{children:"FastAPI+gRPC-Web (ADR-028)"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Language"})}),(0,s.jsx)(n.td,{children:"Go only"}),(0,s.jsx)(n.td,{children:"Python + JavaScript"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Type Safety"})}),(0,s.jsx)(n.td,{children:"Full (compile-time)"}),(0,s.jsx)(n.td,{children:"Partial (runtime validation)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Build Step"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"templ generate"})}),(0,s.jsx)(n.td,{children:"None (but slower dev iteration)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Dependencies"})}),(0,s.jsx)(n.td,{children:"Go binary"}),(0,s.jsx)(n.td,{children:"Python + uvicorn + grpcio"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Container Size"})}),(0,s.jsx)(n.td,{children:"15-20MB (scratch+binary)"}),(0,s.jsx)(n.td,{children:"100-150MB (python:3.11-slim)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Startup Time"})}),(0,s.jsx)(n.td,{children:"<50ms"}),(0,s.jsx)(n.td,{children:"1-2 seconds"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Memory Usage"})}),(0,s.jsx)(n.td,{children:"20-30MB"}),(0,s.jsx)(n.td,{children:"50-100MB"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Consistency"})}),(0,s.jsx)(n.td,{children:"Matches Go ecosystem"}),(0,s.jsx)(n.td,{children:"Separate Python stack"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Admin API Access"})}),(0,s.jsx)(n.td,{children:"Native gRPC"}),(0,s.jsx)(n.td,{children:"gRPC-Web (protocol translation)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Development UX"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"templ watch"})," + ",(0,s.jsx)(n.code,{children:"air"})]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"uvicorn --reload"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Testing"})}),(0,s.jsx)(n.td,{children:"Standard Go testing"}),(0,s.jsx)(n.td,{children:"Python pytest"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Advantages:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"85-87% smaller container"})," (15-20MB vs 100-150MB)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"20-40x faster startup"})," (<50ms vs 1-2s)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Language consolidation"})," (Go for all admin tooling)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Type safety"})," (compile-time validation vs runtime)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Direct gRPC access"})," (no protocol translation overhead)"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"project-structure",children:"Project Structure"}),"\n",(0,s.jsx)(n.p,{children:"```text\ncmd/prism-admin-ui/\n\u251c\u2500\u2500 main.go              # Entry point, Gin setup\n\u251c\u2500\u2500 handlers/\n\u2502   \u251c\u2500\u2500 namespace.go     # Namespace CRUD\n\u2502   \u251c\u2500\u2500 session.go       # Session monitoring\n\u2502   \u251c\u2500\u2500 health.go        # Backend health\n\u2502   \u2514\u2500\u2500 auth.go          # OIDC login/logout\n\u251c\u2500\u2500 templates/\n\u2502   \u251c\u2500\u2500 layout.templ     # Base layout with nav\n\u2502   \u251c\u2500\u2500 namespace.templ  # Namespace components\n\u2502   \u251c\u2500\u2500 session.templ    # Session components\n\u2502   \u2514\u2500\u2500 health.templ     # Health components\n\u251c\u2500\u2500 static/\n\u2502   \u251c\u2500\u2500 css/styles.css   # Tailwind CSS\n\u2502   \u2514\u2500\u2500 js/htmx.min.js   # htmx library (14KB)\n\u2514\u2500\u2500 middleware/\n\u251c\u2500\u2500 auth.go          # OIDC token validation\n\u251c\u2500\u2500 htmx.go          # HX-Request detection\n\u2514\u2500\u2500 logging.go       # Request logging\n```"}),"\n",(0,s.jsx)(n.h2,{id:"authentication-integration",children:"Authentication Integration"}),"\n",(0,s.jsx)(n.p,{children:"Reuse OIDC infrastructure from prismctl (RFC-010):"}),"\n",(0,s.jsx)(n.p,{children:'```go\n// middleware/auth.go\nfunc OIDCAuth(validator *auth.JwtValidator) gin.HandlerFunc {\nreturn func(c *gin.Context) {\nsessionToken, err := c.Cookie("prism_session")\nif err == nil && sessionToken != "" {\nclaims, err := validator.ValidateToken(sessionToken)\nif err == nil {\nc.Set("claims", claims)\nc.Next()\nreturn\n}\n}'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'    c.Redirect(http.StatusFound, "/admin/login")\n    c.Abort()\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"}\n```"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Benefits:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Shared JWT validation logic with prismctl"}),"\n",(0,s.jsx)(n.li,{children:"Consistent OIDC configuration"}),"\n",(0,s.jsx)(n.li,{children:"No duplicate authentication code"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,s.jsx)(n.h3,{id:"xss-protection",children:"XSS Protection"}),"\n",(0,s.jsx)(n.p,{children:"templ automatically escapes all variables:"}),"\n",(0,s.jsx)(n.p,{children:"```go\ntempl UserInput(input string) {"}),"\n  ",(0,s.jsx)(n.p,{children:"{input}"}),"  // Automatically escaped\n}\n",(0,s.jsxs)(n.p,{children:['// input = "',(0,s.jsx)(n.script,{children:"alert('xss')"}),"\"\n// Renders: <script>alert('xss')<\/script>\n```"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Manual override"})," (use sparingly):"]}),"\n",(0,s.jsx)(n.p,{children:"```go\ntempl TrustedHTML(html string) {"}),"\n  ",(0,s.jsx)(n.div,{children:"{templ.Raw(html)}"}),"  // Explicit opt-in\n}\n\\`\\`\\`\n",(0,s.jsx)(n.h3,{id:"csrf-protection",children:"CSRF Protection"}),"\n",(0,s.jsx)(n.p,{children:"Use Gin middleware:"}),"\n",(0,s.jsx)(n.p,{children:'```go\nimport "github.com/utrack/gin-csrf"'}),"\n",(0,s.jsx)(n.p,{children:'r.Use(csrf.Middleware(csrf.Options{\nSecret: os.Getenv("CSRF_SECRET"),\n}))\n```'}),"\n",(0,s.jsx)(n.h2,{id:"deployment",children:"Deployment"}),"\n",(0,s.jsx)(n.h3,{id:"standalone-service",children:"Standalone Service"}),"\n",(0,s.jsx)(n.p,{children:"```yaml"}),"\n",(0,s.jsx)(n.h1,{id:"docker-composeyml",children:"docker-compose.yml"}),"\n",(0,s.jsx)(n.p,{children:'services:\nprism-proxy:\nimage: prism/proxy:latest\nports:\n- "8980:8980"  # Data plane\n- "8981:8981"  # Admin API'}),"\n",(0,s.jsxs)(n.p,{children:['prism-admin-ui:\nimage: prism/admin-ui:latest\nports:\n- "8000:8000"\nenvironment:\nPRISM_ADMIN_ENDPOINT: prism-proxy:8981\nOIDC_ISSUER: ',(0,s.jsx)(n.a,{href:"https://idp.example.com",children:"https://idp.example.com"}),"\nOIDC_AUDIENCE: prism-admin-ui\n```"]}),"\n",(0,s.jsx)(n.h3,{id:"dockerfile",children:"Dockerfile"}),"\n",(0,s.jsx)(n.p,{children:"```dockerfile\nFROM golang:1.21 AS builder\nWORKDIR /app\nCOPY go.mod go.sum ./\nRUN go mod download\nCOPY . .\nRUN go install github.com/a-h/templ/cmd/templ@latest\nRUN templ generate\nRUN CGO_ENABLED=0 go build -o prism-admin-ui ./cmd/prism-admin-ui"}),"\n",(0,s.jsx)(n.p,{children:'FROM scratch\nCOPY --from=builder /app/prism-admin-ui /prism-admin-ui\nCOPY --from=builder /app/cmd/prism-admin-ui/static /static\nEXPOSE 8000\nENTRYPOINT ["/prism-admin-ui"]\n```'}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Result"}),": 15-20MB image"]}),"\n",(0,s.jsx)(n.h2,{id:"migration-path-from-adr-028",children:"Migration Path from ADR-028"}),"\n",(0,s.jsx)(n.p,{children:"If FastAPI admin UI already exists:"}),"\n",(0,s.jsx)(n.h3,{id:"phase-1-parallel-deployment-week-1-2",children:"Phase 1: Parallel Deployment (Week 1-2)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Deploy templ+htmx UI on port 8001"}),"\n",(0,s.jsx)(n.li,{children:"Keep FastAPI UI on port 8000"}),"\n",(0,s.jsx)(n.li,{children:"A/B test both versions"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"phase-2-feature-parity-week-2-4",children:"Phase 2: Feature Parity (Week 2-4)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Implement all FastAPI features in templ+htmx"}),"\n",(0,s.jsx)(n.li,{children:"Migrate users incrementally"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"phase-3-sunset-fastapi-week-4-6",children:"Phase 3: Sunset FastAPI (Week 4-6)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Switch default to templ+htmx (port 8000)"}),"\n",(0,s.jsx)(n.li,{children:"Deprecate FastAPI UI"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"phase-4-optimization-week-6-8",children:"Phase 4: Optimization (Week 6-8)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Bundle admin UI into proxy binary (optional)"}),"\n",(0,s.jsx)(n.li,{children:"Server-side caching"}),"\n",(0,s.jsx)(n.li,{children:"Template rendering optimization"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"testing-strategy",children:"Testing Strategy"}),"\n",(0,s.jsx)(n.h3,{id:"unit-tests",children:"Unit Tests"}),"\n",(0,s.jsx)(n.p,{children:'```go\nfunc TestNamespaceCard(t *testing.T) {\nns := &adminv1.Namespace{\nName:        "test-namespace",\nDescription: "Test description",\n}'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'var buf bytes.Buffer\nerr := templates.NamespaceCard(ns).Render(context.Background(), &buf)\nrequire.NoError(t, err)\n\nhtml := buf.String()\nassert.Contains(t, html, "test-namespace")\nassert.Contains(t, html, `id="namespace-test-namespace"`)\n'})}),"\n",(0,s.jsx)(n.p,{children:"}\n```"}),"\n",(0,s.jsx)(n.h3,{id:"integration-tests",children:"Integration Tests"}),"\n",(0,s.jsx)(n.p,{children:"```go\nfunc TestNamespaceCRUD(t *testing.T) {\nmockAdmin := startMockAdminAPI(t)\ndefer mockAdmin.Close()"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'adminUI := startAdminUI(t, mockAdmin.Address())\ndefer adminUI.Close()\n\nresp, err := http.PostForm(adminUI.URL()+"/admin/namespaces", url.Values{\n    "name":        {"test-ns"},\n    "description": {"Test"},\n})\nrequire.NoError(t, err)\nassert.Equal(t, http.StatusOK, resp.StatusCode)\n'})}),"\n",(0,s.jsx)(n.p,{children:"}\n```"}),"\n",(0,s.jsx)(n.h2,{id:"alternatives-considered",children:"Alternatives Considered"}),"\n",(0,s.jsx)(n.h3,{id:"alternative-1-keep-fastapi-adr-028",children:"Alternative 1: Keep FastAPI (ADR-028)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Pros"}),": Already designed, familiar to Python developers"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cons"}),": Language fragmentation, larger footprint (100-150MB vs 15-20MB), separate maintenance"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Decision"}),": Propose templ+htmx for Go consolidation"]}),"\n",(0,s.jsx)(n.h3,{id:"alternative-2-reactvue-spa",children:"Alternative 2: React/Vue SPA"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Pros"}),": Rich interactions, large ecosystem"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cons"}),": Build complexity, large bundle, overkill for CRUD"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Decision"}),": Rejected - admin UI doesn't need SPA complexity"]}),"\n",(0,s.jsx)(n.h3,{id:"alternative-3-htmltemplate-go-stdlib",children:"Alternative 3: html/template (Go stdlib)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Pros"}),": No dependencies, standard library"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cons"}),": No type safety, no compile-time validation"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Decision"}),": Rejected - templ's type safety is critical"]}),"\n",(0,s.jsx)(n.h2,{id:"open-questions",children:"Open Questions"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Embedded vs Standalone"}),": Embed in proxy or separate service?"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Recommendation"}),": Start standalone, consider embedding in Phase 4"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"CSS Framework"}),": Tailwind (utility-first) or custom CSS?"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Recommendation"}),": Tailwind for rapid development"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Real-time Updates"}),": WebSocket for live session monitoring?"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Recommendation"}),": Start with htmx polling, add WebSocket if needed"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"implementation-roadmap",children:"Implementation Roadmap"}),"\n",(0,s.jsx)(n.p,{children:"If this RFC is accepted:"}),"\n",(0,s.jsx)(n.h3,{id:"week-1-2-foundation",children:"Week 1-2: Foundation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Set up ",(0,s.jsx)(n.code,{children:"cmd/prism-admin-ui"})," directory structure"]}),"\n",(0,s.jsx)(n.li,{children:"Implement base layout and navigation (templ)"}),"\n",(0,s.jsx)(n.li,{children:"Add OIDC authentication middleware"}),"\n",(0,s.jsx)(n.li,{children:"Deploy parallel to FastAPI UI (port 8001)"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"week-3-4-core-features",children:"Week 3-4: Core Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Namespace CRUD (full feature parity with FastAPI)"}),"\n",(0,s.jsx)(n.li,{children:"Session monitoring dashboard"}),"\n",(0,s.jsx)(n.li,{children:"Backend health checks"}),"\n",(0,s.jsx)(n.li,{children:"User testing and feedback"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"week-5-6-polish-and-migration",children:"Week 5-6: Polish and Migration"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Address feedback from user testing"}),"\n",(0,s.jsx)(n.li,{children:"Performance optimization"}),"\n",(0,s.jsx)(n.li,{children:"Switch default to templ+htmx (port 8000)"}),"\n",(0,s.jsx)(n.li,{children:"Deprecate FastAPI UI"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"week-7-8-production-readiness",children:"Week 7-8: Production Readiness"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Security audit"}),"\n",(0,s.jsx)(n.li,{children:"Load testing"}),"\n",(0,s.jsx)(n.li,{children:"Documentation"}),"\n",(0,s.jsx)(n.li,{children:"Optional: Embed in proxy binary"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://templ.guide",children:"templ Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://htmx.org",children:"htmx Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://gin-gonic.com",children:"Gin Web Framework"})}),"\n",(0,s.jsx)(n.li,{children:"ADR-028: Admin UI with FastAPI and gRPC-Web"}),"\n",(0,s.jsx)(n.li,{children:"ADR-040: Go Binary for Admin CLI (prismctl)"}),"\n",(0,s.jsx)(n.li,{children:"RFC-003: Admin Interface for Prism"}),"\n",(0,s.jsx)(n.li,{children:"RFC-010: Admin Protocol with OIDC Authentication"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"appendix-implementation-guide",children:"Appendix: Implementation Guide"}),"\n",(0,s.jsx)(n.p,{children:"This appendix serves as a practical reference for implementing templ+htmx patterns in Prism Admin UI."}),"\n",(0,s.jsx)(n.h3,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,s.jsx)(n.h4,{id:"pattern-1-full-page-render",children:"Pattern 1: Full Page Render"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"When:"})," Initial page load, navigation"]}),"\n",(0,s.jsx)(n.p,{children:"```go\ntempl NamespacePage(namespaces []*adminv1.Namespace) {"}),"\n  \n  \n    \n      ",(0,s.jsx)(n.script,{src:"/static/js/htmx.min.js"}),"\n      ",(0,s.jsx)(n.link,{rel:"stylesheet",href:"/static/css/styles.css"}),"\n    \n    \n      @NamespaceList(namespaces)\n    \n  \n}\n\\`\\`\\`\n",(0,s.jsx)(n.h4,{id:"pattern-2-partialfragment-render",children:"Pattern 2: Partial/Fragment Render"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"When:"})," htmx requests"]}),"\n",(0,s.jsx)(n.p,{children:"```go\nfunc ListNamespaces(c *gin.Context) {\nnamespaces := getNamespaces()"}),"\n",(0,s.jsx)(n.p,{children:'if c.GetHeader("HX-Request") == "true" {\ntemplates.NamespaceList(namespaces).Render(c.Request.Context(), c.Writer)\n} else {\ntemplates.NamespacePage(namespaces).Render(c.Request.Context(), c.Writer)\n}\n}\n```'}),"\n",(0,s.jsx)(n.h4,{id:"pattern-3-forms",children:"Pattern 3: Forms"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"When:"})," Create/Update operations"]}),"\n",(0,s.jsx)(n.p,{children:"```go\ntempl NamespaceForm(ns *adminv1.Namespace) {"}),"\n  ",(0,s.jsxs)(n.form,{"hx-post":"/admin/namespaces","hx-target":"#namespace-list","hx-swap":"afterbegin",children:["\n    ",(0,s.jsx)(n.input,{name:"name",value:"{ns.Name}",required:!0}),"\n    ",(0,s.jsx)(n.button,{type:"submit",children:"Create"}),"\n  "]}),"\n}\n\\`\\`\\`\n",(0,s.jsx)(n.h4,{id:"pattern-4-searchfilter",children:"Pattern 4: Search/Filter"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"When:"})," Real-time filtering"]}),"\n",(0,s.jsxs)(n.p,{children:["```go\ntempl SearchBox() {\n",(0,s.jsx)(n.input,{type:"search","hx-get":"/admin/namespaces/search","hx-trigger":"keyup changed delay:300ms","hx-target":"#namespace-list"}),"\n}\n```"]}),"\n",(0,s.jsx)(n.h4,{id:"pattern-5-optimistic-updates",children:"Pattern 5: Optimistic Updates"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"When:"})," Better UX for slow operations"]}),"\n",(0,s.jsxs)(n.p,{children:["```html\n",(0,s.jsx)(n.button,{"hx-delete":"/admin/namespaces/analytics","hx-target":"#namespace-analytics","hx-swap":"outerHTML swap:1s","hx-indicator":"#spinner",children:"\nDelete\n"})]}),"\n",(0,s.jsx)(n.div,{id:"spinner",className:"htmx-indicator",children:"Deleting..."}),"\n\\`\\`\\`\n",(0,s.jsx)(n.h3,{id:"htmx-attribute-reference",children:"htmx Attribute Reference"}),"\n",(0,s.jsx)(n.p,{children:'```text\nCore:\nhx-get="/url"              GET request\nhx-post="/url"             POST request\nhx-delete="/url"           DELETE request'}),"\n",(0,s.jsx)(n.p,{children:'Targeting:\nhx-target="#id"            Where to put response\nhx-swap="innerHTML"        How to swap'}),"\n",(0,s.jsx)(n.p,{children:'Triggers:\nhx-trigger="click"         When to fire\nhx-trigger="keyup changed delay:300ms"  Debounced'}),"\n",(0,s.jsx)(n.p,{children:'State:\nhx-indicator="#spinner"    Show during request\nhx-confirm="Are you sure?" Confirm before request\n```'}),"\n",(0,s.jsx)(n.h3,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Component Composition"}),": Break templates into small, reusable components"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Type Safety"}),": Use Go structs, let templ validate at compile time"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Predictable IDs"}),": Use consistent naming (",(0,s.jsx)(n.code,{children:'id={"namespace-" + ns.Name}'}),")"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Loading States"}),": Always provide ",(0,s.jsx)(n.code,{children:"hx-indicator"})," feedback"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Error Handling"}),": Return proper HTTP status codes with error templates"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"common-gotchas",children:"Common Gotchas"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Templates Not Regenerating"}),": Run ",(0,s.jsx)(n.code,{children:"templ generate --watch"})," during development"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"URL Encoding"}),": Use ",(0,s.jsx)(n.code,{children:"templ.URL()"})," for URLs with query params"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"XSS Protection"}),": templ escapes by default; use ",(0,s.jsx)(n.code,{children:"templ.Raw()"})," sparingly"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"CSRF Tokens"}),": Add middleware and include tokens in all forms"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Browser Caching"}),": Disable cache for htmx requests (",(0,s.jsx)(n.code,{children:"Cache-Control: no-store"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"revision-history",children:"Revision History"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"2025-10-15: Initial RFC proposing templ+htmx+Gin as alternative to ADR-028"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);