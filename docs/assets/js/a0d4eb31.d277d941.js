"use strict";(globalThis.webpackChunkdocusaurus=globalThis.webpackChunkdocusaurus||[]).push([[8849],{2651:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>o,contentTitle:()=>a,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"admin-ui-fastapi-grpc-web","title":"ADR-028: Admin UI with FastAPI and gRPC-Web","description":"Context","source":"@site/../docs-cms/adr/028-admin-ui-fastapi-grpc-web.md","sourceDirName":".","slug":"/admin-ui-fastapi-grpc-web","permalink":"/prism-data-layer/adr/admin-ui-fastapi-grpc-web","draft":false,"unlisted":false,"editUrl":"https://github.com/jrepp/prism-data-layer/tree/main/docs-cms/../docs-cms/adr/028-admin-ui-fastapi-grpc-web.md","tags":[{"inline":true,"label":"admin","permalink":"/prism-data-layer/adr/tags/admin"},{"inline":true,"label":"ui","permalink":"/prism-data-layer/adr/tags/ui"},{"inline":true,"label":"fastapi","permalink":"/prism-data-layer/adr/tags/fastapi"},{"inline":true,"label":"grpc-web","permalink":"/prism-data-layer/adr/tags/grpc-web"},{"inline":true,"label":"frontend","permalink":"/prism-data-layer/adr/tags/frontend"}],"version":"current","sidebarPosition":28,"frontMatter":{"title":"ADR-028: Admin UI with FastAPI and gRPC-Web","status":"Accepted","date":"2025-10-07T00:00:00.000Z","deciders":"Core Team","tags":["admin","ui","fastapi","grpc-web","frontend"]},"sidebar":"adrSidebar","previous":{"title":"ADR-027: Admin API via gRPC","permalink":"/prism-data-layer/adr/admin-api-grpc"},"next":{"title":"ADR-029: Protocol Recording with Protobuf Tagging","permalink":"/prism-data-layer/adr/protocol-recording-protobuf-tags"}}');var t=i(4848),r=i(8453);const l={title:"ADR-028: Admin UI with FastAPI and gRPC-Web",status:"Accepted",date:new Date("2025-10-07T00:00:00.000Z"),deciders:"Core Team",tags:["admin","ui","fastapi","grpc-web","frontend"]},a=void 0,o={},d=[{value:"Context",id:"context",level:2},{value:"Decision",id:"decision",level:2},{value:"Rationale",id:"rationale",level:2},{value:"Architecture",id:"architecture",level:3},{value:"Why FastAPI",id:"why-fastapi",level:3},{value:"Why gRPC-Web",id:"why-grpc-web",level:3},{value:"Frontend Stack",id:"frontend-stack",level:3},{value:"FastAPI Implementation",id:"fastapi-implementation",level:3},{value:"Frontend Structure",id:"frontend-structure",level:3},{value:"HTML Template",id:"html-template",level:3},{value:"JavaScript gRPC-Web Client",id:"javascript-grpc-web-client",level:3},{value:"Deployment",id:"deployment",level:3},{value:"Security",id:"security",level:3},{value:"Alternative: Envoy gRPC-Web Proxy",id:"alternative-envoy-grpc-web-proxy",level:3},{value:"Alternatives Considered",id:"alternatives-considered",level:3},{value:"Consequences",id:"consequences",level:2},{value:"Positive",id:"positive",level:3},{value:"Negative",id:"negative",level:3},{value:"Neutral",id:"neutral",level:3},{value:"Implementation Notes",id:"implementation-notes",level:2},{value:"Development Workflow",id:"development-workflow",level:3},{value:"Production Build",id:"production-build",level:3},{value:"Requirements",id:"requirements",level:3},{value:"References",id:"references",level:2},{value:"Revision History",id:"revision-history",level:2}];function c(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{id:"context",children:"Context"}),"\n",(0,t.jsx)(e.p,{children:"Prism Admin API (ADR-027) provides gRPC endpoints for administration. Need web-based UI for:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Managing client configurations"}),"\n",(0,t.jsx)(e.li,{children:"Monitoring active sessions"}),"\n",(0,t.jsx)(e.li,{children:"Viewing backend health"}),"\n",(0,t.jsx)(e.li,{children:"Namespace management"}),"\n",(0,t.jsx)(e.li,{children:"Operational tasks"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Requirements:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Browser-accessible admin interface"}),"\n",(0,t.jsx)(e.li,{children:"Communicate with gRPC backend"}),"\n",(0,t.jsx)(e.li,{children:"Lightweight deployment"}),"\n",(0,t.jsx)(e.li,{children:"Modern, responsive UI"}),"\n",(0,t.jsx)(e.li,{children:"Production-grade security"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"decision",children:"Decision"}),"\n",(0,t.jsxs)(e.p,{children:["Build ",(0,t.jsx)(e.strong,{children:"Admin UI with FastAPI + gRPC-Web"}),":"]}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"FastAPI backend"}),": Python service serving static files and gRPC-Web proxy"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"gRPC-Web"}),": Protocol translation from browser to gRPC backend"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Vanilla JavaScript"}),": Simple, no-framework frontend"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"CSS"}),": Tailwind or modern CSS for styling"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Single container"}),": All-in-one deployment"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"rationale",children:"Rationale"}),"\n",(0,t.jsx)(e.h3,{id:"architecture",children:"Architecture"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Browser                        \u2502\n\u2502                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  Admin UI (HTML/CSS/JS)            \u2502    \u2502\n\u2502  \u2502  - Configuration manager           \u2502    \u2502\n\u2502  \u2502  - Session monitor                 \u2502    \u2502\n\u2502  \u2502  - Health dashboard                \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502               \u2502 HTTP + gRPC-Web             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  FastAPI Service (:8000)                    \u2502\n\u2502                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  Static File Server                 \u2502   \u2502\n\u2502  \u2502  GET /  \u2192 index.html                \u2502   \u2502\n\u2502  \u2502  GET /static/* \u2192 CSS/JS             \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  gRPC-Web Proxy                     \u2502   \u2502\n\u2502  \u2502  POST /prism.admin.v1.AdminService  \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502 gRPC\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Prism Admin API (:8981)                    \u2502\n\u2502  - prism.admin.v1.AdminService              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,t.jsx)(e.h3,{id:"why-fastapi",children:"Why FastAPI"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Pros:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Modern Python web framework"}),"\n",(0,t.jsx)(e.li,{children:"Async support (perfect for gRPC proxy)"}),"\n",(0,t.jsx)(e.li,{children:"Built-in OpenAPI/Swagger docs"}),"\n",(0,t.jsx)(e.li,{children:"Easy static file serving"}),"\n",(0,t.jsx)(e.li,{children:"Production-ready with Uvicorn"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Cons:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Python dependency (but we already use Python for tooling)"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"why-grpc-web",children:"Why gRPC-Web"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Browser limitation"}),": Browsers can't speak native gRPC (no HTTP/2 trailers support)"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"gRPC-Web solution:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"HTTP/1.1 or HTTP/2 compatible"}),"\n",(0,t.jsx)(e.li,{children:"Protobuf encoding preserved"}),"\n",(0,t.jsx)(e.li,{children:"Generated JavaScript clients"}),"\n",(0,t.jsx)(e.li,{children:"Transparent proxy to gRPC backend"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"frontend-stack",children:"Frontend Stack"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Vanilla JavaScript"})," (no framework):"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Pros"}),": No build step, no dependencies, fast load, simple"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Cons"}),": Manual DOM manipulation, no reactivity"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Modern CSS"})," (Tailwind or custom):"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Pros"}),": Responsive, modern look, utility-first"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Cons"}),": Larger CSS file (but can be minified)"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Generated gRPC-Web client:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# Generate JavaScript client from proto\nprotoc --js_out=import_style=commonjs,binary:./admin-ui/static/js \\\n       --grpc-web_out=import_style=commonjs,mode=grpcwebtext:./admin-ui/static/js \\\n       proto/prism/admin/v1/admin.proto\n"})}),"\n",(0,t.jsx)(e.h3,{id:"fastapi-implementation",children:"FastAPI Implementation"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'# admin-ui/main.py\nfrom fastapi import FastAPI\nfrom fastapi.staticfiles import StaticFiles\nfrom fastapi.responses import FileResponse\nimport grpc\nfrom grpc_web import grpc_web_server\n\napp = FastAPI(title="Prism Admin UI")\n\n# Serve static files\napp.mount("/static", StaticFiles(directory="static"), name="static")\n\n# Serve index.html for root\n@app.get("/")\nasync def read_root():\n    return FileResponse("static/index.html")\n\n# gRPC-Web proxy\n@app.post("/prism.admin.v1.AdminService/{method}")\nasync def grpc_proxy(method: str, request: bytes):\n    """Proxy gRPC-Web requests to gRPC backend"""\n    channel = grpc.aio.insecure_channel("prism-proxy:8981")\n    # Forward request to gRPC backend\n    # Handle response and convert to gRPC-Web format\n    pass\n\n# Health check\n@app.get("/health")\nasync def health():\n    return {"status": "healthy"}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"frontend-structure",children:"Frontend Structure"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"admin-ui/\n\u251c\u2500\u2500 main.py                 # FastAPI app\n\u251c\u2500\u2500 requirements.txt        # Python deps\n\u251c\u2500\u2500 Dockerfile             # Container image\n\u2514\u2500\u2500 static/\n    \u251c\u2500\u2500 index.html         # Main page\n    \u251c\u2500\u2500 css/\n    \u2502   \u2514\u2500\u2500 styles.css     # Tailwind or custom CSS\n    \u251c\u2500\u2500 js/\n    \u2502   \u251c\u2500\u2500 admin_grpc_web_pb.js  # Generated gRPC-Web client\n    \u2502   \u251c\u2500\u2500 config.js      # Config management\n    \u2502   \u251c\u2500\u2500 sessions.js    # Session monitoring\n    \u2502   \u2514\u2500\u2500 health.js      # Health dashboard\n    \u2514\u2500\u2500 lib/\n        \u2514\u2500\u2500 grpc-web.js    # gRPC-Web runtime\n"})}),"\n",(0,t.jsx)(e.h3,{id:"html-template",children:"HTML Template"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'\x3c!-- admin-ui/static/index.html --\x3e\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Prism Admin</title>\n    <link rel="stylesheet" href="/static/css/styles.css">\n</head>\n<body class="bg-gray-100">\n    <div class="container mx-auto px-4 py-8">\n        <header class="mb-8">\n            <h1 class="text-3xl font-bold">Prism Admin</h1>\n            <nav class="mt-4">\n                <button data-page="configs" class="px-4 py-2 bg-blue-500 text-white rounded">Configs</button>\n                <button data-page="sessions" class="px-4 py-2 bg-blue-500 text-white rounded">Sessions</button>\n                <button data-page="health" class="px-4 py-2 bg-blue-500 text-white rounded">Health</button>\n            </nav>\n        </header>\n\n        <main id="content">\n            \x3c!-- Dynamic content loaded here --\x3e\n        </main>\n    </div>\n\n    <script type="module" src="/static/js/admin_grpc_web_pb.js"><\/script>\n    <script type="module" src="/static/js/config.js"><\/script>\n    <script type="module" src="/static/js/sessions.js"><\/script>\n    <script type="module" src="/static/js/health.js"><\/script>\n</body>\n</html>\n'})}),"\n",(0,t.jsx)(e.h3,{id:"javascript-grpc-web-client",children:"JavaScript gRPC-Web Client"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// admin-ui/static/js/config.js\nimport {AdminServiceClient} from './admin_grpc_web_pb.js';\nimport {ListConfigsRequest} from './admin_grpc_web_pb.js';\n\nconst client = new AdminServiceClient('http://localhost:8000', null, null);\n\nasync function loadConfigs() {\n    const request = new ListConfigsRequest();\n\n    client.listConfigs(request, {'x-admin-token': getAdminToken()}, (err, response) => {\n        if (err) {\n            console.error('Error loading configs:', err);\n            return;\n        }\n\n        const configs = response.getConfigsList();\n        renderConfigs(configs);\n    });\n}\n\nfunction renderConfigs(configs) {\n    const html = configs.map(config => `\n        <div class=\"bg-white p-4 rounded shadow mb-4\">\n            <h3 class=\"font-bold\">${config.getName()}</h3>\n            <p class=\"text-sm text-gray-600\">Pattern: ${config.getPattern()}</p>\n            <p class=\"text-sm text-gray-600\">Backend: ${config.getBackend().getType()}</p>\n        </div>\n    `).join('');\n\n    document.getElementById('content').innerHTML = html;\n}\n\n// Export functions\nexport {loadConfigs};\n"})}),"\n",(0,t.jsx)(e.h3,{id:"deployment",children:"Deployment"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-dockerfile",children:'# admin-ui/Dockerfile\nFROM python:3.11-slim\n\nWORKDIR /app\n\n# Install dependencies\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\n# Copy application\nCOPY main.py .\nCOPY static/ static/\n\n# Expose port\nEXPOSE 8000\n\n# Run FastAPI with Uvicorn\nCMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:'# docker-compose.yml\nservices:\n  prism-proxy:\n    image: prism/proxy:latest\n    ports:\n      - "8980:8980"  # Data plane\n      - "8981:8981"  # Admin API\n\n  admin-ui:\n    image: prism/admin-ui:latest\n    ports:\n      - "8000:8000"\n    environment:\n      - PRISM_ADMIN_ENDPOINT=prism-proxy:8981\n      - ADMIN_TOKEN_SECRET=your-secret-key\n    depends_on:\n      - prism-proxy\n'})}),"\n",(0,t.jsx)(e.h3,{id:"security",children:"Security"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Authentication:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'from fastapi import Header, HTTPException\n\nasync def verify_admin_token(x_admin_token: str = Header(...)):\n    if not is_valid_admin_token(x_admin_token):\n        raise HTTPException(status_code=401, detail="Invalid admin token")\n    return x_admin_token\n\n@app.post("/prism.admin.v1.AdminService/{method}")\nasync def grpc_proxy(\n    method: str,\n    request: bytes,\n    admin_token: str = Depends(verify_admin_token)\n):\n    # Forward with admin token\n    metadata = [(\'x-admin-token\', admin_token)]\n    # ... proxy request\n'})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"CORS"})," (if needed):"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'from fastapi.middleware.cors import CORSMiddleware\n\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=["https://admin.example.com"],\n    allow_credentials=True,\n    allow_methods=["*"],\n    allow_headers=["*"],\n)\n'})}),"\n",(0,t.jsx)(e.h3,{id:"alternative-envoy-grpc-web-proxy",children:"Alternative: Envoy gRPC-Web Proxy"}),"\n",(0,t.jsx)(e.p,{children:"Instead of FastAPI, use Envoy:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:'# envoy.yaml\nstatic_resources:\n  listeners:\n  - name: listener_0\n    address:\n      socket_address:\n        address: 0.0.0.0\n        port_value: 8000\n    filter_chains:\n    - filters:\n      - name: envoy.filters.network.http_connection_manager\n        typed_config:\n          "@type": type.googleapis.com/envoy.extensions.filters.network.http_connection_manager.v3.HttpConnectionManager\n          codec_type: AUTO\n          stat_prefix: ingress_http\n          route_config:\n            name: local_route\n            virtual_hosts:\n            - name: backend\n              domains: ["*"]\n              routes:\n              - match:\n                  prefix: "/prism.admin.v1"\n                route:\n                  cluster: grpc_backend\n          http_filters:\n          - name: envoy.filters.http.grpc_web\n          - name: envoy.filters.http.cors\n          - name: envoy.filters.http.router\n\n  clusters:\n  - name: grpc_backend\n    connect_timeout: 0.25s\n    type: LOGICAL_DNS\n    lb_policy: ROUND_ROBIN\n    typed_extension_protocol_options:\n      envoy.extensions.upstreams.http.v3.HttpProtocolOptions:\n        "@type": type.googleapis.com/envoy.extensions.upstreams.http.v3.HttpProtocolOptions\n        explicit_http_config:\n          http2_protocol_options: {}\n    load_assignment:\n      cluster_name: grpc_backend\n      endpoints:\n      - lb_endpoints:\n        - endpoint:\n            address:\n              socket_address:\n                address: prism-proxy\n                port_value: 8981\n'})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Pros:"})," Production-grade, feature-rich\n",(0,t.jsx)(e.strong,{children:"Cons:"})," More complex, separate process"]}),"\n",(0,t.jsx)(e.h3,{id:"alternatives-considered",children:"Alternatives Considered"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"React/Vue/Angular SPA"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Pros: Rich UI, reactive, component-based"}),"\n",(0,t.jsx)(e.li,{children:"Cons: Build step, bundle size, complexity"}),"\n",(0,t.jsx)(e.li,{children:"Rejected: Vanilla JS sufficient for admin UI"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Server-side rendering (Jinja2)"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Pros: No JavaScript needed, SEO-friendly"}),"\n",(0,t.jsx)(e.li,{children:"Cons: Full page reloads, less interactive"}),"\n",(0,t.jsx)(e.li,{children:"Rejected: Admin UI needs interactivity"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Separate Ember.js app (as originally planned)"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Pros: Full-featured framework, ember-data"}),"\n",(0,t.jsx)(e.li,{children:"Cons: Large bundle, build complexity, overkill"}),"\n",(0,t.jsx)(e.li,{children:"Rejected: Too heavy for admin UI"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"grpcurl-based CLI only"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Pros: Simple, no UI needed"}),"\n",(0,t.jsx)(e.li,{children:"Cons: Not user-friendly for non-technical admins"}),"\n",(0,t.jsx)(e.li,{children:"Rejected: Web UI provides better UX"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"consequences",children:"Consequences"}),"\n",(0,t.jsx)(e.h3,{id:"positive",children:"Positive"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Simple deployment"}),": Single container with FastAPI"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"No build step"}),": Vanilla JS loads directly"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"gRPC compatible"}),": Uses gRPC-Web protocol"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Lightweight"}),": Minimal dependencies"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Fast development"}),": Python + simple JS"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"negative",children:"Negative"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Manual DOM updates"}),": No framework reactivity"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Limited UI features"}),": Vanilla JS less powerful than frameworks"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Python dependency"}),": Adds Python to stack (but already used for tooling)"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"neutral",children:"Neutral"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"gRPC-Web limitation"}),": Requires proxy (but handled by FastAPI)"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Browser compatibility"}),": Modern browsers only (ES6+)"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"implementation-notes",children:"Implementation Notes"}),"\n",(0,t.jsx)(e.h3,{id:"development-workflow",children:"Development Workflow"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# Generate gRPC-Web client\nbuf generate --template admin-ui/buf.gen.grpc-web.yaml\n\n# Run FastAPI dev server\ncd admin-ui\nuvicorn main:app --reload --port 8000\n\n# Open browser\nopen http://localhost:8000\n"})}),"\n",(0,t.jsx)(e.h3,{id:"production-build",children:"Production Build"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# Minify CSS\nnpx tailwindcss -i static/css/styles.css -o static/css/styles.min.css --minify\n\n# Minify JS (optional)\nnpx terser static/js/config.js -o static/js/config.min.js\n\n# Build Docker image\ndocker build -t prism/admin-ui:latest ./admin-ui\n"})}),"\n",(0,t.jsx)(e.h3,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-txt",children:"# admin-ui/requirements.txt\nfastapi==0.104.1\nuvicorn[standard]==0.24.0\ngrpcio==1.59.0\ngrpcio-tools==1.59.0\n"})}),"\n",(0,t.jsx)(e.h2,{id:"references",children:"References"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"ADR-027: Admin API via gRPC"}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://github.com/grpc/grpc-web",children:"gRPC-Web"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://fastapi.tiangolo.com/",children:"FastAPI"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://tailwindcss.com/",children:"Tailwind CSS"})}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"revision-history",children:"Revision History"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"2025-10-07: Initial draft and acceptance"}),"\n"]})]})}function p(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(c,{...n})}):c(n)}},8453:(n,e,i)=>{i.d(e,{R:()=>l,x:()=>a});var s=i(6540);const t={},r=s.createContext(t);function l(n){const e=s.useContext(r);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:l(n.components),s.createElement(r.Provider,{value:e},n.children)}}}]);