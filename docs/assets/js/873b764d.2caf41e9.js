"use strict";(globalThis.webpackChunkdocusaurus=globalThis.webpackChunkdocusaurus||[]).push([[44684],{9461:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"rfc-001","title":"Prism Data Access Layer Architecture","description":"Abstract","source":"@site/../docs-cms/rfcs/rfc-001-prism-architecture.md","sourceDirName":".","slug":"/rfc-001","permalink":"/prism-data-layer/rfc/rfc-001","draft":false,"unlisted":false,"editUrl":"https://github.com/jrepp/prism-data-layer/tree/main/docs-cms/../docs-cms/rfcs/rfc-001-prism-architecture.md","tags":[],"version":"current","frontMatter":{"author":"Core Team","created":"2025-10-07T00:00:00.000Z","doc_uuid":"f81acbd4-5650-408a-904d-64a33e0742ef","id":"rfc-001","project_id":"prism-data-layer","status":"Draft","title":"Prism Data Access Layer Architecture","updated":"2025-10-07T00:00:00.000Z"},"sidebar":"rfcSidebar","previous":{"title":"Request for Comments (RFCs)","permalink":"/prism-data-layer/rfc/"},"next":{"title":"Data Layer Interface Specification \u2022 RFC-002","permalink":"/prism-data-layer/rfc/rfc-002"}}');var r=i(74848),l=i(28453);const t={author:"Core Team",created:new Date("2025-10-07T00:00:00.000Z"),doc_uuid:"f81acbd4-5650-408a-904d-64a33e0742ef",id:"rfc-001",project_id:"prism-data-layer",status:"Draft",title:"Prism Data Access Layer Architecture",updated:new Date("2025-10-07T00:00:00.000Z")},c=void 0,a={},o=[{value:"Abstract",id:"abstract",level:2},{value:"1. Introduction",id:"1-introduction",level:2},{value:"1.1 Purpose",id:"11-purpose",level:3},{value:"1.2 Goals",id:"12-goals",level:3},{value:"1.3 Non-Goals",id:"13-non-goals",level:3},{value:"2. Architecture Overview",id:"2-architecture-overview",level:2},{value:"2.1 System Components",id:"21-system-components",level:3},{value:"5.2 Queue Service",id:"52-queue-service",level:3},{value:"5.3 PubSub Service",id:"53-pubsub-service",level:3},{value:"5.4 Reader Service",id:"54-reader-service",level:3},{value:"5.5 Transact Service",id:"55-transact-service",level:3},{value:"6. Container Plugin Model",id:"6-container-plugin-model",level:2},{value:"6.1 Plugin Architecture",id:"61-plugin-architecture",level:3},{value:"6.2 Plugin Contract",id:"62-plugin-contract",level:3},{value:"6.3 Configuration",id:"63-configuration",level:3},{value:"6.4 Deployment",id:"64-deployment",level:3},{value:"6.5 Scaling",id:"65-scaling",level:3},{value:"7. Data Flow Examples",id:"7-data-flow-examples",level:2},{value:"7.1 Queue: Kafka Publisher Flow",id:"71-queue-kafka-publisher-flow",level:3},{value:"7.2 Transactional Write Flow",id:"72-transactional-write-flow",level:3},{value:"7.3 Paged Reader Flow",id:"73-paged-reader-flow",level:3},{value:"8. Observability",id:"8-observability",level:2},{value:"8.1 Distributed Tracing",id:"81-distributed-tracing",level:3},{value:"8.2 Metrics",id:"82-metrics",level:3},{value:"8.3 Logging",id:"83-logging",level:3},{value:"8.4 Audit Logging",id:"84-audit-logging",level:3},{value:"9. Security",id:"9-security",level:2},{value:"9.1 Authentication",id:"91-authentication",level:3},{value:"9.2 Authorization",id:"92-authorization",level:3},{value:"9.3 Data Protection",id:"93-data-protection",level:3},{value:"10. Performance Targets",id:"10-performance-targets",level:2},{value:"10.1 Latency",id:"101-latency",level:3},{value:"10.2 Throughput",id:"102-throughput",level:3},{value:"10.3 Resource Utilization",id:"103-resource-utilization",level:3},{value:"11. Implementation Roadmap",id:"11-implementation-roadmap",level:2},{value:"Phase 1: Foundation (Weeks 1-4)",id:"phase-1-foundation-weeks-1-4",level:3},{value:"Phase 2: Sessions + Config (Weeks 5-6)",id:"phase-2-sessions--config-weeks-5-6",level:3},{value:"Phase 3: Queue Layer (Weeks 7-8)",id:"phase-3-queue-layer-weeks-7-8",level:3},{value:"Phase 4: PubSub Layer (Weeks 9-10)",id:"phase-4-pubsub-layer-weeks-9-10",level:3},{value:"Phase 5: Reader Layer (Weeks 11-12)",id:"phase-5-reader-layer-weeks-11-12",level:3},{value:"Phase 6: Transact Layer (Weeks 13-14)",id:"phase-6-transact-layer-weeks-13-14",level:3},{value:"Phase 7: Production Readiness (Weeks 15-16)",id:"phase-7-production-readiness-weeks-15-16",level:3},{value:"12. Success Criteria",id:"12-success-criteria",level:2},{value:"13. Open Questions",id:"13-open-questions",level:2},{value:"14. References",id:"14-references",level:2},{value:"ADRs",id:"adrs",level:3},{value:"External",id:"external",level:3},{value:"15. Revision History",id:"15-revision-history",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"abstract",children:"Abstract"}),"\n",(0,r.jsx)(n.p,{children:"This RFC defines the complete architecture for Prism, a high-performance data access layer gateway that provides a unified, client-configurable interface to heterogeneous data backends. Prism is inspired by Netflix's Data Gateway but designed for superior performance, developer experience, and operational simplicity."}),"\n",(0,r.jsx)(n.h2,{id:"1-introduction",children:"1. Introduction"}),"\n",(0,r.jsx)(n.h3,{id:"11-purpose",children:"1.1 Purpose"}),"\n",(0,r.jsx)(n.p,{children:"Prism addresses the complexity of managing multiple data backends in modern applications by providing:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Unified Interface"}),": Single gRPC API for accessing databases, message queues, and pub/sub systems"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Dynamic Configuration"}),": Clients declare their data access patterns; Prism handles provisioning and routing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Performance"}),": Rust-based proxy with sub-millisecond overhead and 10k+ RPS per connection"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Backend Abstraction"}),": Applications can switch backends without code changes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Observability"}),": Built-in tracing, metrics, and audit logging"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"12-goals",children:"1.2 Goals"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Performance"}),": P99 latency ",(0,r.jsx)(n.code,{children:"<10ms"}),", 10k+ RPS sustained per connection"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Flexibility"}),": Support multiple access patterns (KV, Queue, PubSub, Paged Reader, Transactions)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scalability"}),": Horizontal scaling of both proxy and backend-specific containers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Security"}),": mTLS, OAuth2, PII tagging, audit logging"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Developer Experience"}),": Type-safe gRPC interfaces with generated clients"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"13-non-goals",children:"1.3 Non-Goals"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Not a database"}),": Prism is a gateway, not a storage engine"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Not for complex queries"}),": Simple access patterns only; complex analytics use dedicated tools"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Not a cache"}),": Caching is optional per-namespace configuration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Not a message broker"}),": Prism wraps existing brokers (Kafka, NATS), doesn't replace them"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"2-architecture-overview",children:"2. Architecture Overview"}),"\n",(0,r.jsx)(n.h3,{id:"21-system-components",children:"2.1 System Components"}),"\n",(0,r.jsx)(n.p,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Client Applications                    \u2502\n\u2502              (Go, Rust, Python, JavaScript)              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2502 gRPC/HTTP2\n\u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Prism Proxy Core                       \u2502\n\u2502                   (Rust + Tokio)                         \u2502\n\u2502                                                           \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502   Config    \u2502  \u2502   Session   \u2502  \u2502    Queue     \u2502    \u2502\n\u2502  \u2502   Service   \u2502  \u2502   Service   \u2502  \u2502   Service    \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                           \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502   PubSub    \u2502  \u2502   Reader    \u2502  \u2502   Transact   \u2502    \u2502\n\u2502  \u2502   Service   \u2502  \u2502   Service   \u2502  \u2502   Service    \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                                 \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Container Plugins\u2502           \u2502 Container Plugins \u2502\n\u2502                  \u2502           \u2502                   \u2502\n\u2502 \u2022 Kafka Pub      \u2502           \u2502 \u2022 NATS Pub       \u2502\n\u2502 \u2022 Kafka Con      \u2502           \u2502 \u2022 NATS Con       \u2502\n\u2502 \u2022 Indexed Reader \u2502           \u2502 \u2022 Transact Proc  \u2502\n\u2502 \u2022 Mailbox Listen \u2502           \u2502 \u2022 Custom...      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2502                                 \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     Backends     \u2502           \u2502     Backends      \u2502\n\u2502                  \u2502           \u2502                   \u2502\n\u2502 \u2022 Postgres       \u2502           \u2502 \u2022 Kafka          \u2502\n\u2502 \u2022 SQLite         \u2502           \u2502 \u2022 NATS           \u2502\n\u2502 \u2022 Neptune        \u2502           \u2502 \u2022 Redis          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"\n### 2.2 Key Design Principles\n\n1. **gRPC-First**: All communication uses gRPC for performance and type safety\n2. **Session-Based**: All operations require an authenticated session\n3. **Layered Interfaces**: From basic (sessions) to use-case-specific (queue, pubsub, reader, transact)\n4. **Backend Polymorphism**: Each interface layer supports multiple backend implementations\n5. **Container Plugins**: Backend-specific logic deployed as independent, scalable containers\n6. **Protobuf-Driven**: All APIs, configurations, and data models defined in protobuf\n\n## 3. Client Configuration System\n\n### 3.1 Overview\n\nPrism separates **server configuration** (infrastructure) from **client configuration** (access patterns).\n\n**Server Configuration** (static, admin-controlled):\n- Backend connection strings\n- Resource pools\n- Auth policies\n- Rate limits\n\n**Client Configuration** (dynamic, runtime):\n- Access pattern (Queue, PubSub, Reader, Transact)\n- Backend selection\n- Consistency requirements\n- Cache policy\n\n### 3.2 Configuration Descriptor\n\nClients provide configuration as protobuf messages:\n\n"})}),"\n",(0,r.jsx)(n.p,{children:"message ClientConfig {\nstring name = 1;                  // Named config or custom\nstring version = 2;               // For evolution\nAccessPattern pattern = 3;        // QUEUE, PUBSUB, READER, TRANSACT\nBackendConfig backend = 4;        // Backend type + options\nConsistencyConfig consistency = 5; // EVENTUAL, STRONG, BOUNDED_STALENESS\nCacheConfig cache = 6;            // TTL, size, enabled\nRateLimitConfig rate_limit = 7;   // RPS, burst\nstring namespace = 8;             // Multi-tenancy isolation\n}"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"\n### 3.3 Configuration Sources\n\n**Named Configurations** (server-provided templates):\n"})}),"\n",(0,r.jsx)(n.h1,{id:"client-requests-pre-configured-pattern",children:"Client requests pre-configured pattern"}),"\n",(0,r.jsx)(n.p,{children:'config, err := client.GetConfig("user-profiles")\nsession, err := client.StartSession(config)'}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"\n**Inline Configurations** (client-provided):\n"})}),"\n",(0,r.jsx)(n.p,{children:"config := &ClientConfig{\nPattern: ACCESS_PATTERN_QUEUE,\nBackend: &BackendConfig{Type: BACKEND_TYPE_KAFKA},\nConsistency: &ConsistencyConfig{Level: CONSISTENCY_LEVEL_EVENTUAL},\n}\nsession, err := client.StartSession(config)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"\n### 3.4 Configuration Validation\n\nServer validates all configurations:\n- Backend compatibility with access pattern\n- Namespace existence\n- Rate limit sanity checks\n- Resource availability\n\n## 4. Session Management\n\n### 4.1 Session Lifecycle\n\n1. **Create**: Client authenticates and provides configuration\n2. **Active**: Session token used for all operations\n3. **Heartbeat**: Periodic keepalives extend session lifetime\n4. **Close**: Clean shutdown releases resources\n\n### 4.2 Session Service API\n\n"})}),"\n",(0,r.jsx)(n.p,{children:"service SessionService {\nrpc CreateSession(CreateSessionRequest) returns (CreateSessionResponse);\nrpc CloseSession(CloseSessionRequest) returns (CloseSessionResponse);\nrpc Heartbeat(HeartbeatRequest) returns (HeartbeatResponse);\nrpc GetSession(GetSessionRequest) returns (GetSessionResponse);\n}"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"\n### 4.3 Session State\n\nServer tracks:\n- Session ID and token\n- User/client identity\n- Active configuration\n- Backend connections\n- Creation and expiration timestamps\n- Activity for idle timeout\n\n### 4.4 Session Security\n\n- mTLS for service-to-service\n- OAuth2/JWT for user-facing APIs\n- API keys for machine clients\n- Session tokens opaque to clients\n- Audit log for all session events\n\n## 5. Interface Layers\n\n### 5.1 Layer Hierarchy\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Layer 5: Use-Case Specific Interfaces    \u2502\n\u2502                                            \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u2502\n\u2502  \u2502 Queue  \u2502 \u2502 PubSub \u2502 \u2502 Reader \u2502        \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                               \u2502\n\u2502  \u2502Transact\u2502                               \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Layer 1: Session Service (Foundation)     \u2502\n\u2502  - Authentication                          \u2502\n\u2502  - Authorization                           \u2502\n\u2502  - Auditing                                \u2502\n\u2502  - Connection State                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(n.h3,{id:"52-queue-service",children:"5.2 Queue Service"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Kafka-style message queue operations"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Operations"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Publish"}),": Send message to topic"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Subscribe"}),": Stream messages from topic (server-streaming)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Acknowledge"}),": Confirm message processing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Commit"}),": Commit offset"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Seek"}),": Jump to specific offset"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Backend Mapping"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Kafka \u2192 Topics, partitions, offsets"}),"\n",(0,r.jsx)(n.li,{children:"NATS JetStream \u2192 Streams, consumers, sequences"}),"\n",(0,r.jsx)(n.li,{children:"Postgres \u2192 Table-based queue with SKIP LOCKED"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"53-pubsub-service",children:"5.3 PubSub Service"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": NATS-style publish-subscribe with topic wildcards"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Operations"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Publish"}),": Publish event to topic"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Subscribe"}),": Subscribe to topic pattern (server-streaming)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Unsubscribe"}),": Cancel subscription"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Topic Patterns"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Exact: ",(0,r.jsx)(n.code,{children:"events.user.created"})]}),"\n",(0,r.jsxs)(n.li,{children:["Wildcard: ",(0,r.jsx)(n.code,{children:"events.user.*"})]}),"\n",(0,r.jsxs)(n.li,{children:["Multi-level: ",(0,r.jsx)(n.code,{children:"events.>"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Backend Mapping"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"NATS \u2192 Native subject routing"}),"\n",(0,r.jsx)(n.li,{children:"Kafka \u2192 Topic prefix matching"}),"\n",(0,r.jsx)(n.li,{children:"Redis Pub/Sub \u2192 Channel patterns"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"54-reader-service",children:"5.4 Reader Service"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Database-style paged reading and queries"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Operations"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Read"}),": Stream pages of data (cursor-based pagination)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Query"}),": Stream filtered/sorted results"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Count"}),": Count matching records"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Pagination"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cursor-based (opaque continuation tokens)"}),"\n",(0,r.jsx)(n.li,{children:"Server streams pages as client ready"}),"\n",(0,r.jsx)(n.li,{children:"No client-side buffering of full result set"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Backend Mapping"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Postgres/SQLite \u2192 SQL with LIMIT/OFFSET"}),"\n",(0,r.jsx)(n.li,{children:"DynamoDB \u2192 Query with pagination tokens"}),"\n",(0,r.jsx)(n.li,{children:"Neptune \u2192 Gremlin with pagination"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"55-transact-service",children:"5.5 Transact Service"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Transactional writes across two tables (inbox/outbox pattern)"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Operations"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Write"}),": Single transactional write (data + mailbox)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Transaction"}),": Streaming transaction (begin, writes, commit/rollback)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Two-Table Pattern"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Data Table"}),": Business data (users, orders, etc.)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Mailbox Table"}),": Outbox for downstream processing"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Transactional outbox pattern"}),"\n",(0,r.jsx)(n.li,{children:"Event sourcing with guaranteed writes"}),"\n",(0,r.jsx)(n.li,{children:"Saga coordination"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Backend Mapping"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Postgres/SQLite \u2192 Native transactions"}),"\n",(0,r.jsx)(n.li,{children:"DynamoDB \u2192 TransactWriteItems"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"6-container-plugin-model",children:"6. Container Plugin Model"}),"\n",(0,r.jsx)(n.h3,{id:"61-plugin-architecture",children:"6.1 Plugin Architecture"}),"\n",(0,r.jsx)(n.p,{children:"Backend-specific functionality deployed as independent containers:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Plugin Roles"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Publisher"}),": Produces messages to backend (Kafka Publisher, NATS Publisher)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Consumer"}),": Consumes messages from backend (Kafka Consumer, NATS Consumer)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Processor"}),": Processes operations (Transaction Processor)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Listener"}),": Listens for events (Mailbox Listener)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"62-plugin-contract",children:"6.2 Plugin Contract"}),"\n",(0,r.jsx)(n.p,{children:"All plugins implement standard interfaces:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-protobuf",children:"service HealthService {\n  rpc Live(LiveRequest) returns (LiveResponse);    // Liveness probe\n  rpc Ready(ReadyRequest) returns (ReadyResponse);  // Readiness probe\n}\n\nservice MetricsService {\n  rpc GetMetrics(MetricsRequest) returns (MetricsResponse);  // Prometheus metrics\n}\n\nservice PluginInfoService {\n  rpc GetInfo(InfoRequest) returns (InfoResponse);  // Name, version, role, backend\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"63-configuration",children:"6.3 Configuration"}),"\n",(0,r.jsx)(n.p,{children:"Plugins configured via environment variables (12-factor):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Common\nPRISM_PROXY_ENDPOINT=localhost:8980\nPRISM_PLUGIN_ROLE=publisher\nPRISM_BACKEND_TYPE=kafka\nPRISM_NAMESPACE=production\n\n# Backend-specific\nKAFKA_BROKERS=localhost:9092\nKAFKA_TOPIC=events\nNATS_URL=nats://localhost:4222\nDATABASE_URL=postgres://...\n"})}),"\n",(0,r.jsx)(n.h3,{id:"64-deployment",children:"6.4 Deployment"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Docker Compose"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'services:\n  prism-proxy:\n    image: prism/proxy:latest\n    ports: ["8980:8980"]\n\n  kafka-publisher:\n    image: prism/kafka-publisher:latest\n    environment:\n      PRISM_PROXY_ENDPOINT: prism-proxy:8980\n      KAFKA_BROKERS: kafka:9092\n    deploy:\n      replicas: 2\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Kubernetes"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: prism-kafka-consumer\nspec:\n  replicas: 3\n  template:\n    spec:\n      containers:\n      - name: kafka-consumer\n        image: prism/kafka-consumer:latest\n        env:\n        - name: PRISM_PROXY_ENDPOINT\n          value: "prism-proxy:8980"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"65-scaling",children:"6.5 Scaling"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Horizontal"}),": Deploy multiple replicas per plugin"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Independent"}),": Scale each plugin independently based on load"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Stateless"}),": Plugins are stateless (state in backend or proxy)"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"7-data-flow-examples",children:"7. Data Flow Examples"}),"\n",(0,r.jsx)(n.h3,{id:"71-queue-kafka-publisher-flow",children:"7.1 Queue: Kafka Publisher Flow"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Client calls ",(0,r.jsx)(n.code,{children:"Publish(topic, message)"})]}),"\n",(0,r.jsx)(n.li,{children:"Proxy validates session"}),"\n",(0,r.jsx)(n.li,{children:"Proxy enqueues message to internal queue"}),"\n",(0,r.jsx)(n.li,{children:"Kafka Publisher container polls internal queue"}),"\n",(0,r.jsx)(n.li,{children:"Publisher sends to Kafka broker"}),"\n",(0,r.jsx)(n.li,{children:"Publisher acknowledges to proxy"}),"\n",(0,r.jsxs)(n.li,{children:["Proxy returns ",(0,r.jsx)(n.code,{children:"PublishResponse"})," to client"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"72-transactional-write-flow",children:"7.2 Transactional Write Flow"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Client calls ",(0,r.jsx)(n.code,{children:"Write(data, mailbox)"})]}),"\n",(0,r.jsx)(n.li,{children:"Proxy routes to Transaction Processor container"}),"\n",(0,r.jsx)(n.li,{children:"Processor begins database transaction"}),"\n",(0,r.jsx)(n.li,{children:"Processor inserts into data table"}),"\n",(0,r.jsx)(n.li,{children:"Processor inserts into mailbox table"}),"\n",(0,r.jsx)(n.li,{children:"Processor commits transaction"}),"\n",(0,r.jsx)(n.li,{children:"Processor returns success to proxy"}),"\n",(0,r.jsxs)(n.li,{children:["Proxy returns ",(0,r.jsx)(n.code,{children:"WriteResponse"})," to client"]}),"\n",(0,r.jsx)(n.li,{children:"Mailbox Listener container polls mailbox table"}),"\n",(0,r.jsx)(n.li,{children:"Listener processes new messages"}),"\n",(0,r.jsx)(n.li,{children:"Listener marks messages as processed"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"73-paged-reader-flow",children:"7.3 Paged Reader Flow"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Client calls ",(0,r.jsx)(n.code,{children:"Read(collection, page_size=100)"})]}),"\n",(0,r.jsx)(n.li,{children:"Proxy starts server-streaming response"}),"\n",(0,r.jsx)(n.li,{children:"Indexed Reader container queries database (LIMIT 100)"}),"\n",(0,r.jsx)(n.li,{children:"Reader streams page 1 to proxy"}),"\n",(0,r.jsx)(n.li,{children:"Proxy streams page 1 to client"}),"\n",(0,r.jsx)(n.li,{children:"Reader queries next page (OFFSET 100)"}),"\n",(0,r.jsx)(n.li,{children:"Reader streams page 2 to proxy"}),"\n",(0,r.jsx)(n.li,{children:"Proxy streams page 2 to client"}),"\n",(0,r.jsx)(n.li,{children:"Repeat until no more results"}),"\n",(0,r.jsx)(n.li,{children:"Reader closes stream"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"8-observability",children:"8. Observability"}),"\n",(0,r.jsx)(n.h3,{id:"81-distributed-tracing",children:"8.1 Distributed Tracing"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"OpenTelemetry from day one"}),"\n",(0,r.jsx)(n.li,{children:"Spans for all gRPC operations"}),"\n",(0,r.jsx)(n.li,{children:"Trace propagation across services"}),"\n",(0,r.jsx)(n.li,{children:"Export to Jaeger/Tempo"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"82-metrics",children:"8.2 Metrics"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Proxy Metrics"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Request rate (per service)"}),"\n",(0,r.jsx)(n.li,{children:"Request latency (P50, P95, P99)"}),"\n",(0,r.jsx)(n.li,{children:"Active sessions"}),"\n",(0,r.jsx)(n.li,{children:"Backend connection pool utilization"}),"\n",(0,r.jsx)(n.li,{children:"Cache hit rate"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Plugin Metrics"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Messages published/consumed"}),"\n",(0,r.jsx)(n.li,{children:"Processing latency"}),"\n",(0,r.jsx)(n.li,{children:"Error rate"}),"\n",(0,r.jsx)(n.li,{children:"Queue depth"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Export"}),": Prometheus ",(0,r.jsx)(n.code,{children:"/metrics"})," endpoint"]}),"\n",(0,r.jsx)(n.h3,{id:"83-logging",children:"8.3 Logging"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rust (Proxy)"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"tracing"})," crate for structured logging"]}),"\n",(0,r.jsx)(n.li,{children:"JSON output in production"}),"\n",(0,r.jsx)(n.li,{children:"Span context for correlation"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Go (Tooling/Clients)"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"slog"})," for structured logging"]}),"\n",(0,r.jsx)(n.li,{children:"Context propagation"}),"\n",(0,r.jsx)(n.li,{children:"JSON output"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"84-audit-logging",children:"8.4 Audit Logging"}),"\n",(0,r.jsx)(n.p,{children:"All operations logged with:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Session ID"}),"\n",(0,r.jsx)(n.li,{children:"User identity"}),"\n",(0,r.jsx)(n.li,{children:"Operation type"}),"\n",(0,r.jsx)(n.li,{children:"Resource accessed"}),"\n",(0,r.jsx)(n.li,{children:"Timestamp"}),"\n",(0,r.jsx)(n.li,{children:"Success/failure"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"9-security",children:"9. Security"}),"\n",(0,r.jsx)(n.h3,{id:"91-authentication",children:"9.1 Authentication"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Service-to-Service"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"mTLS with mutual certificate validation"}),"\n",(0,r.jsx)(n.li,{children:"Certificate rotation"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"User-Facing"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"OAuth2 with JWT tokens"}),"\n",(0,r.jsx)(n.li,{children:"API keys for machine clients"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"92-authorization",children:"9.2 Authorization"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Namespace-level policies"}),"\n",(0,r.jsx)(n.li,{children:"Role-based access control (RBAC)"}),"\n",(0,r.jsx)(n.li,{children:"Operation-level permissions"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"93-data-protection",children:"9.3 Data Protection"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"PII Tagging"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-protobuf",children:'message UserProfile {\n  string user_id = 1;\n  string email = 2 [(prism.pii) = "email"];\n  string name = 3 [(prism.pii) = "name"];\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Automatic Handling"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Encryption at rest (per-field)"}),"\n",(0,r.jsx)(n.li,{children:"Audit logging for PII access"}),"\n",(0,r.jsx)(n.li,{children:"Masking in logs"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"10-performance-targets",children:"10. Performance Targets"}),"\n",(0,r.jsx)(n.h3,{id:"101-latency",children:"10.1 Latency"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"P50"}),": ",(0,r.jsx)(n.code,{children:"<2ms overhead"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"P95"}),": ",(0,r.jsx)(n.code,{children:"<5ms overhead"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"P99"}),": ",(0,r.jsx)(n.code,{children:"<10ms overhead"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"(Overhead measured from gRPC request receipt to backend call)"}),"\n",(0,r.jsx)(n.h3,{id:"102-throughput",children:"10.2 Throughput"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Per connection"}),": 10k+ RPS sustained"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Per proxy instance"}),": 100k+ RPS (10k connections \xd7 10 RPS)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Horizontally scalable"}),": Add more proxy instances"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"103-resource-utilization",children:"10.3 Resource Utilization"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Proxy"}),": ",(0,r.jsx)(n.code,{children:"<500MB RAM"})," per instance"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Plugins"}),": ",(0,r.jsx)(n.code,{children:"<100MB RAM"})," per container"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"CPU"}),": ",(0,r.jsx)(n.code,{children:"<10% overhead"})," for routing logic"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"11-implementation-roadmap",children:"11. Implementation Roadmap"}),"\n",(0,r.jsx)(n.h3,{id:"phase-1-foundation-weeks-1-4",children:"Phase 1: Foundation (Weeks 1-4)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Week 1"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Protobuf foundation (ADR-011, Step 1 complete)"}),"\n",(0,r.jsx)(n.li,{children:"Rust proxy skeleton (Step 2)"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Week 2"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"KeyValue protobuf + stubs (Step 3)"}),"\n",(0,r.jsx)(n.li,{children:"SQLite backend implementation (Step 4)"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Week 3-4"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Integration tests + CI (Step 5)"}),"\n",(0,r.jsx)(n.li,{children:"Postgres backend + docs (Step 6)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"phase-2-sessions--config-weeks-5-6",children:"Phase 2: Sessions + Config (Weeks 5-6)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Dynamic client configuration system (ADR-022)"}),"\n",(0,r.jsx)(n.li,{children:"Session service implementation"}),"\n",(0,r.jsx)(n.li,{children:"Named configuration storage"}),"\n",(0,r.jsx)(n.li,{children:"Auth integration (mTLS, OAuth2)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"phase-3-queue-layer-weeks-7-8",children:"Phase 3: Queue Layer (Weeks 7-8)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Queue service protobuf + implementation"}),"\n",(0,r.jsx)(n.li,{children:"Kafka publisher container"}),"\n",(0,r.jsx)(n.li,{children:"Kafka consumer container"}),"\n",(0,r.jsx)(n.li,{children:"Integration tests with local Kafka"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"phase-4-pubsub-layer-weeks-9-10",children:"Phase 4: PubSub Layer (Weeks 9-10)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"PubSub service protobuf + implementation"}),"\n",(0,r.jsx)(n.li,{children:"NATS publisher container"}),"\n",(0,r.jsx)(n.li,{children:"NATS consumer container"}),"\n",(0,r.jsx)(n.li,{children:"Topic pattern matching"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"phase-5-reader-layer-weeks-11-12",children:"Phase 5: Reader Layer (Weeks 11-12)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Reader service protobuf + implementation"}),"\n",(0,r.jsx)(n.li,{children:"Indexed reader container"}),"\n",(0,r.jsx)(n.li,{children:"Cursor-based pagination"}),"\n",(0,r.jsx)(n.li,{children:"Query filtering"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"phase-6-transact-layer-weeks-13-14",children:"Phase 6: Transact Layer (Weeks 13-14)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Transact service protobuf + implementation"}),"\n",(0,r.jsx)(n.li,{children:"Transaction processor container"}),"\n",(0,r.jsx)(n.li,{children:"Mailbox listener container"}),"\n",(0,r.jsx)(n.li,{children:"Two-table transaction tests"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"phase-7-production-readiness-weeks-15-16",children:"Phase 7: Production Readiness (Weeks 15-16)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"OpenTelemetry integration"}),"\n",(0,r.jsx)(n.li,{children:"Prometheus metrics"}),"\n",(0,r.jsx)(n.li,{children:"Performance benchmarking"}),"\n",(0,r.jsx)(n.li,{children:"Load testing"}),"\n",(0,r.jsx)(n.li,{children:"Documentation"}),"\n",(0,r.jsx)(n.li,{children:"Deployment guides"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"12-success-criteria",children:"12. Success Criteria"}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Functional"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All 5 interface layers implemented"}),"\n",(0,r.jsx)(n.li,{children:"All backend plugins working"}),"\n",(0,r.jsx)(n.li,{children:"End-to-end tests passing"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Performance"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["P99 ",(0,r.jsx)(n.code,{children:"<10ms latency"})]}),"\n",(0,r.jsx)(n.li,{children:"10k+ RPS sustained"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Operational"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Deployed to production"}),"\n",(0,r.jsx)(n.li,{children:"Monitoring dashboards"}),"\n",(0,r.jsx)(n.li,{children:"Runbooks complete"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Developer Experience"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Client libraries for Go, Rust, Python"}),"\n",(0,r.jsx)(n.li,{children:"Complete API documentation"}),"\n",(0,r.jsx)(n.li,{children:"Example applications"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"13-open-questions",children:"13. Open Questions"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Shadow traffic"}),": When to implement for backend migrations?"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Multi-region"}),": Active-active or active-passive?"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cache layer"}),": Implement now or defer?"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Admin UI"}),": Build Ember UI or defer to CLI tools?"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"14-references",children:"14. References"}),"\n",(0,r.jsx)(n.h3,{id:"adrs",children:"ADRs"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ADR-001: Rust for the Proxy"}),"\n",(0,r.jsx)(n.li,{children:"ADR-003: Protobuf as Single Source of Truth"}),"\n",(0,r.jsx)(n.li,{children:"ADR-011: Implementation Roadmap"}),"\n",(0,r.jsx)(n.li,{children:"ADR-022: Dynamic Client Configuration"}),"\n",(0,r.jsx)(n.li,{children:"ADR-023: gRPC-First Interface Design"}),"\n",(0,r.jsx)(n.li,{children:"ADR-024: Layered Interface Hierarchy"}),"\n",(0,r.jsx)(n.li,{children:"ADR-025: Container Plugin Model"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"external",children:"External"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://netflixtechblog.com/data-gateway-a-platform-for-growing-and-protecting-the-data-tier-f1-2019-3fd1a829503",children:"Netflix Data Gateway"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://grpc.io",children:"gRPC Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://microservices.io/patterns/data/transactional-outbox.html",children:"Inbox/Outbox Pattern"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"15-revision-history",children:"15. Revision History"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"2025-10-07: Initial draft"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>c});var s=i(96540);const r={},l=s.createContext(r);function t(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);