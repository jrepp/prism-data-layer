<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-memos docs-version-current docs-doc-page docs-doc-id-memo-033" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">MEMO-033: Process Isolation and the Bulkhead Pattern | Prism</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://jrepp.github.io/prism-data-layer/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://jrepp.github.io/prism-data-layer/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://jrepp.github.io/prism-data-layer/memos/memo-033"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-memos-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-memos-current"><meta data-rh="true" property="og:title" content="MEMO-033: Process Isolation and the Bulkhead Pattern | Prism"><meta data-rh="true" name="description" content="Executive Summary"><meta data-rh="true" property="og:description" content="Executive Summary"><link data-rh="true" rel="icon" href="/prism-data-layer/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jrepp.github.io/prism-data-layer/memos/memo-033"><link data-rh="true" rel="alternate" href="https://jrepp.github.io/prism-data-layer/memos/memo-033" hreflang="en"><link data-rh="true" rel="alternate" href="https://jrepp.github.io/prism-data-layer/memos/memo-033" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Process Isolation and the Bulkhead Pattern • MEMO-033","item":"https://jrepp.github.io/prism-data-layer/memos/memo-033"}]}</script><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=yes">
<meta name="theme-color" content="#6366f1">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="stylesheet" href="/prism-data-layer/assets/css/styles.73adf43b.css">
<script src="/prism-data-layer/assets/js/runtime~main.0ea3b2ed.js" defer="defer"></script>
<script src="/prism-data-layer/assets/js/main.f9acdc42.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/prism-data-layer/"><div class="navbar__logo"><img src="/prism-data-layer/img/prism-logo-transparent-background.png" alt="Prism Data Gateway Logo" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="32"><img src="/prism-data-layer/img/prism-logo-transparent-background.png" alt="Prism Data Gateway Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="32"></div><b class="navbar__title text--truncate">Prism</b></a><a class="navbar__item navbar__link" href="/prism-data-layer/docs/intro">Overview</a><a class="navbar__item navbar__link" href="/prism-data-layer/docs/changelog">Change Log</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Documentation</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/prism-data-layer/adr">ADRs (Architecture Decision Records)</a></li><li><a class="dropdown__link" href="/prism-data-layer/rfc">RFCs (Request for Comments)</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/prism-data-layer/memos">Memos (Technical Analysis)</a></li><li><a class="dropdown__link" href="/prism-data-layer/prds">PRDs (Product Requirements)</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="buildInfo_asc2"><span class="version_ADrX" title="Build: 47bd04a">47bd04a</span><span class="separator_VfCt">•</span><span class="buildTime_n1Nn" title="Last updated: Oct 15, 9:36 AM PDT">Oct 15, 9:36 AM PDT</span></div><div class="navbar__item"><a href="https://github.com/jrepp/prism-data-layer/actions/workflows/docs.yml" target="_blank" rel="noopener noreferrer" title="GitHub Pages" style="display: flex; align-items: center; padding: 0 0.5rem;"><img src="https://github.com/jrepp/prism-data-layer/actions/workflows/docs.yml/badge.svg" alt="Build" style="margin: 0;"></a></div><a href="https://github.com/jrepp/prism-data-layer" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_x44X"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/memos/"><span title="Technical Memos" class="linkLabel_WmDU">Technical Memos</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/prism-data-layer/memos/memo-001"><span title="MEMO-001 to 010" class="categoryLinkLabel_W154">MEMO-001 to 010</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/prism-data-layer/memos/memo-011"><span title="MEMO-011 to 020" class="categoryLinkLabel_W154">MEMO-011 to 020</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/prism-data-layer/memos/memo-021"><span title="MEMO-021 to 030" class="categoryLinkLabel_W154">MEMO-021 to 030</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/prism-data-layer/memos/memo-031"><span title="MEMO-031 to 040" class="categoryLinkLabel_W154">MEMO-031 to 040</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/prism-data-layer/memos/memo-031"><span title="RFC-031 Security and Performance Review • MEMO-031" class="linkLabel_WmDU">RFC-031 Security and Performance Review • MEMO-031</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/prism-data-layer/memos/memo-032"><span title="Driver Test Consolidation Strategy • MEMO-032" class="linkLabel_WmDU">Driver Test Consolidation Strategy • MEMO-032</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/prism-data-layer/memos/memo-033"><span title="Process Isolation and the Bulkhead Pattern • MEMO-033" class="linkLabel_WmDU">Process Isolation and the Bulkhead Pattern • MEMO-033</span></a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/prism-data-layer/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">MEMO-031 to 040</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Process Isolation and the Bulkhead Pattern • MEMO-033</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="docMetadata_NQcq"><div class="tagsRow_ipDH"><span class="tag_VbXK">isolation</span><span class="tag_VbXK">bulkhead</span><span class="tag_VbXK">procmgr</span><span class="tag_VbXK">patterns</span><span class="tag_VbXK">reliability</span><span class="tag_VbXK">multi-tenancy</span><span class="tag_VbXK">fault-isolation</span></div><div class="metadataRow_PvZM"><span class="metadataItem_RMFE"><strong>Author:</strong> <!-- -->Prism Team</span><span class="metadataItem_RMFE"><strong>Created:</strong> <!-- -->Oct 14, 2025</span><span class="metadataItem_RMFE"><strong>Updated:</strong> <!-- -->Oct 14, 2025</span></div></div><div class="theme-doc-markdown markdown"><header><h1>MEMO-033: Process Isolation and the Bulkhead Pattern</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="executive-summary">Executive Summary<a href="#executive-summary" class="hash-link" aria-label="Direct link to Executive Summary" title="Direct link to Executive Summary" translate="no">​</a></h2>
<p>This memo documents the implementation of process isolation capabilities in Prism, using the bulkhead pattern to prevent failures in one namespace or session from affecting others. The <code>isolation</code> package builds on <code>procmgr</code> (RFC-034) to provide three isolation levels: None, Namespace, and Session.</p>
<p><strong>Key Achievement</strong>: Pattern tests can now run with configurable isolation, ensuring that requests for different namespaces or sessions are routed to separate processes, preventing cascading failures and improving multi-tenant reliability.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="background">Background<a href="#background" class="hash-link" aria-label="Direct link to Background" title="Direct link to Background" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-statement">Problem Statement<a href="#problem-statement" class="hash-link" aria-label="Direct link to Problem Statement" title="Direct link to Problem Statement" translate="no">​</a></h3>
<p>When running acceptance tests or production workloads with multiple tenants or sessions, we need to prevent:</p>
<ol>
<li><strong>Failure propagation</strong>: A crash in one tenant&#x27;s process affecting other tenants</li>
<li><strong>Resource contention</strong>: One tenant consuming all available resources</li>
<li><strong>Security leaks</strong>: Memory sharing or state leakage between tenants</li>
<li><strong>Debugging complexity</strong>: Difficulty isolating which tenant caused a failure</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prior-art-bulkhead-pattern">Prior Art: Bulkhead Pattern<a href="#prior-art-bulkhead-pattern" class="hash-link" aria-label="Direct link to Prior Art: Bulkhead Pattern" title="Direct link to Prior Art: Bulkhead Pattern" translate="no">​</a></h3>
<p>The bulkhead pattern (named after ship compartments that prevent sinking if one compartment floods) isolates system components so that failures in one component don&#x27;t cascade to others.</p>
<p><strong>Key Principle</strong>: Segment resources into isolated pools so that exhaustion or failure of one pool doesn&#x27;t affect others.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="architecture">Architecture<a href="#architecture" class="hash-link" aria-label="Direct link to Architecture" title="Direct link to Architecture" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="components">Components<a href="#components" class="hash-link" aria-label="Direct link to Components" title="Direct link to Components" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                  Pattern Runner Framework                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  (tests/acceptance/framework/)                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└───────────────────┬─────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    │ uses</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    ▼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│               Isolation Package                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  (pkg/isolation/)                                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌─────────────────────────────────────────────────┐   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │         IsolationManager                         │   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  - GetOrCreateProcess()                          │   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  - TerminateProcess()                            │   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  - ListProcesses()                               │   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  - Health()                                      │   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─────────────────┬───────────────────────────────┘   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                    │                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                    │ manages                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                    ▼                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌─────────────────────────────────────────────────┐   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │   IsolationKey → ProcessID Mapping               │   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                   │   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │   Level: None       → &quot;shared&quot;                   │   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │   Level: Namespace  → &quot;ns:&lt;namespace&gt;&quot;           │   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │   Level: Session    → &quot;session:&lt;session&gt;&quot;        │   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─────────────────┬───────────────────────────────┘   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└────────────────────┼───────────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     │ uses</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     ▼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│              Process Manager (procmgr)                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  (pkg/procmgr/ - RFC-034)                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - Robust lifecycle management                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - Work queue with exponential backoff                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - Health monitoring and metrics                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - Graceful termination                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────┘</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="three-isolation-levels">Three Isolation Levels<a href="#three-isolation-levels" class="hash-link" aria-label="Direct link to Three Isolation Levels" title="Direct link to Three Isolation Levels" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-isolationnone-shared">1. IsolationNone (Shared)<a href="#1-isolationnone-shared" class="hash-link" aria-label="Direct link to 1. IsolationNone (Shared)" title="Direct link to 1. IsolationNone (Shared)" translate="no">​</a></h4>
<p>All requests share a single process. Useful for:</p>
<ul>
<li>Local development</li>
<li>Simple test scenarios</li>
<li>Maximum resource efficiency</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Request 1 (ns:A, session:1) ──┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request 2 (ns:B, session:2) ──┼─→ [Process: shared]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request 3 (ns:A, session:3) ──┘</span><br></span></code></pre></div></div>
<p><strong>Process ID</strong>: <code>&quot;shared&quot;</code></p>
<p><strong>Characteristics</strong>:</p>
<ul>
<li>Lowest overhead (one process for all requests)</li>
<li>No isolation (failures affect all requests)</li>
<li>Fastest (no process creation/switching)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-isolationnamespace-tenant-isolation">2. IsolationNamespace (Tenant Isolation)<a href="#2-isolationnamespace-tenant-isolation" class="hash-link" aria-label="Direct link to 2. IsolationNamespace (Tenant Isolation)" title="Direct link to 2. IsolationNamespace (Tenant Isolation)" translate="no">​</a></h4>
<p>Each namespace gets its own process. Useful for:</p>
<ul>
<li>Multi-tenant systems</li>
<li>SaaS applications</li>
<li>Isolating customer workloads</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Request 1 (ns:A, session:1) ──┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request 2 (ns:A, session:2) ──┼─→ [Process: ns:A]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request 3 (ns:B, session:1) ────→ [Process: ns:B]</span><br></span></code></pre></div></div>
<p><strong>Process ID</strong>: <code>&quot;ns:&lt;namespace&gt;&quot;</code></p>
<p><strong>Characteristics</strong>:</p>
<ul>
<li>One process per namespace/tenant</li>
<li>Failures in namespace A don&#x27;t affect namespace B</li>
<li>Resource limits can be applied per tenant</li>
<li>Ideal for multi-tenant production deployments</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-isolationsession-session-isolation">3. IsolationSession (Session Isolation)<a href="#3-isolationsession-session-isolation" class="hash-link" aria-label="Direct link to 3. IsolationSession (Session Isolation)" title="Direct link to 3. IsolationSession (Session Isolation)" translate="no">​</a></h4>
<p>Each session gets its own process. Useful for:</p>
<ul>
<li>User session isolation</li>
<li>Per-connection isolation</li>
<li>Maximum security requirements</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Request 1 (ns:A, session:1) ──┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request 2 (ns:B, session:1) ──┼─→ [Process: session:1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request 3 (ns:A, session:2) ────→ [Process: session:2]</span><br></span></code></pre></div></div>
<p><strong>Process ID</strong>: <code>&quot;session:&lt;session&gt;&quot;</code></p>
<p><strong>Characteristics</strong>:</p>
<ul>
<li>One process per session</li>
<li>Highest isolation (even same namespace gets different processes)</li>
<li>Higher overhead (more processes)</li>
<li>Ideal for high-security scenarios</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-details">Implementation Details<a href="#implementation-details" class="hash-link" aria-label="Direct link to Implementation Details" title="Direct link to Implementation Details" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="core-types">Core Types<a href="#core-types" class="hash-link" aria-label="Direct link to Core Types" title="Direct link to Core Types" translate="no">​</a></h3>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// IsolationLevel defines how requests are isolated</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> IsolationLevel </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IsolationNone      IsolationLevel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">iota</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IsolationNamespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IsolationSession</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// IsolationKey identifies the namespace and session</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> IsolationKey </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Namespace </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Session   </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ProcessConfig holds configuration for a managed process</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> ProcessConfig </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Key            IsolationKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BackendConfig  </span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GracePeriodSec </span><span class="token builtin">int64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// IsolationManager manages process isolation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> IsolationManager </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    level  IsolationLevel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pm     </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">procmgr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ProcessManager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    syncer ProcessSyncer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ... internal state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="process-id-generation">Process ID Generation<a href="#process-id-generation" class="hash-link" aria-label="Direct link to Process ID Generation" title="Direct link to Process ID Generation" translate="no">​</a></h3>
<p>The <code>IsolationKey.ProcessID()</code> method generates process IDs based on the isolation level:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key IsolationKey</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ProcessID</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">level IsolationLevel</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> procmgr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ProcessID </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">switch</span><span class="token plain"> level </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> IsolationNone</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;shared&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> IsolationNamespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> procmgr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ProcessID</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ns:&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Namespace</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> IsolationSession</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> procmgr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ProcessID</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;session:&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Session</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">default</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;shared&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>This ensures requests are routed to the correct isolated process.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="process-lifecycle">Process Lifecycle<a href="#process-lifecycle" class="hash-link" aria-label="Direct link to Process Lifecycle" title="Direct link to Process Lifecycle" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1. Request arrives with (namespace, session)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ↓</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Generate ProcessID from IsolationKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ↓</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Check if process already exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ↓</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ├─ Yes → Return existing ProcessHandle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   │         (reuse process)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   └─ No  → Create new process</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             ├─ Call ProcessSyncer.SyncProcess()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             ├─ Wait for process to start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             └─ Return ProcessHandle</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="integration-with-procmgr">Integration with procmgr<a href="#integration-with-procmgr" class="hash-link" aria-label="Direct link to Integration with procmgr" title="Direct link to Integration with procmgr" translate="no">​</a></h3>
<p>The <code>isolation</code> package delegates to <code>procmgr</code> for:</p>
<ol>
<li><strong>Lifecycle management</strong>: Starting, stopping, restarting processes</li>
<li><strong>Health monitoring</strong>: Tracking process health and errors</li>
<li><strong>Work queue</strong>: Retry scheduling with exponential backoff</li>
<li><strong>Metrics</strong>: Prometheus metrics collection</li>
<li><strong>Graceful shutdown</strong>: Orderly termination with grace periods</li>
</ol>
<p>This reuses all the robustness guarantees from RFC-034.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pattern-runner-integration">Pattern Runner Integration<a href="#pattern-runner-integration" class="hash-link" aria-label="Direct link to Pattern Runner Integration" title="Direct link to Pattern Runner Integration" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="framework-enhancement">Framework Enhancement<a href="#framework-enhancement" class="hash-link" aria-label="Direct link to Framework Enhancement" title="Direct link to Framework Enhancement" translate="no">​</a></h3>
<p>The pattern runner framework now supports isolated test execution via <code>RunIsolatedPatternTests()</code>:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Configure namespace isolation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">opts </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> IsolatedTestOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IsolationConfig</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> IsolationConfig</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">          isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IsolationNamespace</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;default&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GracePeriodSec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Generate unique namespace per test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    NamespaceGenerator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">backendName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> testName </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Sprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%s-%s&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> backendName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> testName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Run tests with isolation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">RunIsolatedPatternTests</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PatternKeyValueBasic</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tests</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> syncer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opts</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="isolatedbackend-wrapper">IsolatedBackend Wrapper<a href="#isolatedbackend-wrapper" class="hash-link" aria-label="Direct link to IsolatedBackend Wrapper" title="Direct link to IsolatedBackend Wrapper" translate="no">​</a></h3>
<p>The <code>IsolatedBackend</code> type wraps a standard <code>Backend</code> with isolation management:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> IsolatedBackend </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    isolationMgr </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IsolationManager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config       IsolationConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// SetupIsolated creates an isolated process for the test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ib </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">IsolatedBackend</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SetupIsolated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">testing</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IsolationKey</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">driver </span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cleanup </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>This allows existing tests to gain isolation with minimal code changes.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage-examples">Usage Examples<a href="#usage-examples" class="hash-link" aria-label="Direct link to Usage Examples" title="Direct link to Usage Examples" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-no-isolation-development">Example 1: No Isolation (Development)<a href="#example-1-no-isolation-development" class="hash-link" aria-label="Direct link to Example 1: No Isolation (Development)" title="Direct link to Example 1: No Isolation (Development)" translate="no">​</a></h3>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">config </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> IsolationConfig</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">          isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IsolationNone</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;dev&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Session</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;local&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GracePeriodSec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">im </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewIsolationManager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Level</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> syncer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// All requests use process ID &quot;shared&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">handle1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> im</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GetOrCreateProcess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">handle2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> im</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GetOrCreateProcess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Equal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;shared&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handle1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Equal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;shared&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handle2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-namespace-isolation-multi-tenant">Example 2: Namespace Isolation (Multi-Tenant)<a href="#example-2-namespace-isolation-multi-tenant" class="hash-link" aria-label="Direct link to Example 2: Namespace Isolation (Multi-Tenant)" title="Direct link to Example 2: Namespace Isolation (Multi-Tenant)" translate="no">​</a></h3>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">config </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> IsolationConfig</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">          isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IsolationNamespace</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GracePeriodSec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">im </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewIsolationManager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Level</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> syncer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">key1 </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IsolationKey</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tenant-a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Session</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;s1&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">key2 </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IsolationKey</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tenant-b&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Session</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;s2&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">handle1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> im</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GetOrCreateProcess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">handle2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> im</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GetOrCreateProcess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Different namespaces get different processes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Equal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ns:tenant-a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handle1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Equal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ns:tenant-b&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handle2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NotEqual</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handle1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handle2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-3-session-isolation-high-security">Example 3: Session Isolation (High Security)<a href="#example-3-session-isolation-high-security" class="hash-link" aria-label="Direct link to Example 3: Session Isolation (High Security)" title="Direct link to Example 3: Session Isolation (High Security)" translate="no">​</a></h3>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">config </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> IsolationConfig</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">          isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IsolationSession</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GracePeriodSec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">im </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewIsolationManager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Level</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> syncer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">key1 </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IsolationKey</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tenant-a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Session</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;session-1&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">key2 </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IsolationKey</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tenant-a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Session</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;session-2&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">handle1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> im</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GetOrCreateProcess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">handle2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> im</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GetOrCreateProcess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Different sessions get different processes (even same namespace)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Equal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;session:session-1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handle1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Equal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;session:session-2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handle2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NotEqual</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handle1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handle2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="testing">Testing<a href="#testing" class="hash-link" aria-label="Direct link to Testing" title="Direct link to Testing" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-coverage">Test Coverage<a href="#test-coverage" class="hash-link" aria-label="Direct link to Test Coverage" title="Direct link to Test Coverage" translate="no">​</a></h3>
<p><strong>Package</strong>: <code>pkg/isolation/</code></p>
<p><strong>Tests</strong>: 10 tests, all passing (1.155s runtime)</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">✅ TestIsolationLevel_String - String representation of levels</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ TestIsolationKey_ProcessID - ProcessID generation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ TestIsolationManager_None - Shared process behavior</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ TestIsolationManager_Namespace - Namespace isolation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ TestIsolationManager_Session - Session isolation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ TestIsolationManager_GetProcess - Process retrieval</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ TestIsolationManager_TerminateProcess - Graceful termination</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ TestIsolationManager_ListProcesses - Listing all processes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ TestIsolationManager_Health - Health reporting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ TestIsolationManager_ConcurrentAccess - 10 concurrent goroutines</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="framework-integration-tests">Framework Integration Tests<a href="#framework-integration-tests" class="hash-link" aria-label="Direct link to Framework Integration Tests" title="Direct link to Framework Integration Tests" translate="no">​</a></h3>
<p><strong>File</strong>: <code>tests/acceptance/framework/isolation_example_test.go</code></p>
<p>Demonstrates:</p>
<ol>
<li>No isolation (all tests share one process)</li>
<li>Namespace isolation (one process per namespace)</li>
<li>Session isolation (one process per session)</li>
<li>Health monitoring and reporting</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="performance-characteristics">Performance Characteristics<a href="#performance-characteristics" class="hash-link" aria-label="Direct link to Performance Characteristics" title="Direct link to Performance Characteristics" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="process-creation-overhead">Process Creation Overhead<a href="#process-creation-overhead" class="hash-link" aria-label="Direct link to Process Creation Overhead" title="Direct link to Process Creation Overhead" translate="no">​</a></h3>





























<table><thead><tr><th>Isolation Level</th><th>Processes Created</th><th>Overhead</th><th>Best For</th></tr></thead><tbody><tr><td>None</td><td>1</td><td>Minimal (&lt;1ms)</td><td>Development</td></tr><tr><td>Namespace</td><td>N (tenants)</td><td>Low (~10-50ms)</td><td>Multi-tenant SaaS</td></tr><tr><td>Session</td><td>M (sessions)</td><td>Medium (~10-50ms)</td><td>High security</td></tr></tbody></table>
<p><strong>Measured</strong>: Process creation takes ~10ms (includes SyncProcess call)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="memory-footprint">Memory Footprint<a href="#memory-footprint" class="hash-link" aria-label="Direct link to Memory Footprint" title="Direct link to Memory Footprint" translate="no">​</a></h3>
<ul>
<li><strong>None</strong>: Single process memory footprint</li>
<li><strong>Namespace</strong>: N × (process memory + backend connection pool)</li>
<li><strong>Session</strong>: M × (process memory + backend connection pool)</li>
</ul>
<p><strong>Recommendation</strong>: Use Namespace isolation for most production scenarios (balances isolation and resource usage)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="failure-isolation">Failure Isolation<a href="#failure-isolation" class="hash-link" aria-label="Direct link to Failure Isolation" title="Direct link to Failure Isolation" translate="no">​</a></h3>



































<table><thead><tr><th>Scenario</th><th>None</th><th>Namespace</th><th>Session</th></tr></thead><tbody><tr><td>Tenant A crashes</td><td>❌</td><td>✅</td><td>✅</td></tr><tr><td>Session 1 OOMs</td><td>❌</td><td>❌</td><td>✅</td></tr><tr><td>Tenant A exhausts connections</td><td>❌</td><td>✅</td><td>✅</td></tr><tr><td>Memory leak in shared code</td><td>❌</td><td>❌</td><td>❌</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="health-monitoring">Health Monitoring<a href="#health-monitoring" class="hash-link" aria-label="Direct link to Health Monitoring" title="Direct link to Health Monitoring" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="health-metrics">Health Metrics<a href="#health-metrics" class="hash-link" aria-label="Direct link to Health Metrics" title="Direct link to Health Metrics" translate="no">​</a></h3>
<p>The <code>IsolationManager.Health()</code> method returns:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> HealthCheck </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TotalProcesses       </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RunningProcesses     </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TerminatingProcesses </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FailedProcesses      </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkQueueDepth       </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Processes            </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ProcessID</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">ProcessHealth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> ProcessHealth </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    State        ProcessState</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Healthy      </span><span class="token builtin">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Uptime       time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Duration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LastSync     time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ErrorCount   </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RestartCount </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="health-reporter">Health Reporter<a href="#health-reporter" class="hash-link" aria-label="Direct link to Health Reporter" title="Direct link to Health Reporter" translate="no">​</a></h3>
<p>The <code>IsolationHealthReporter</code> aggregates health across multiple backends:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">reporter </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NewIsolationHealthReporter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reporter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Register</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Redis&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> isolatedRedis</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reporter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Register</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;NATS&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> isolatedNATS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">health </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> reporter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GetHealth</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">report </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> reporter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Report</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Human-readable report</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-health-report">Example Health Report<a href="#example-health-report" class="hash-link" aria-label="Direct link to Example Health Report" title="Direct link to Example Health Report" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">=== Isolation Health Report ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Backend: Redis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Total Processes: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Running: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Terminating: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Failed: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Work Queue Depth: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Process ns:tenant-a:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    State: Syncing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Healthy: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Uptime: 5m23s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Last Sync: 2025-10-15 08:30:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Errors: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Restarts: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Process ns:tenant-b:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    State: Syncing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Healthy: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Uptime: 3m12s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Last Sync: 2025-10-15 08:28:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Errors: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Restarts: 0</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prometheus-metrics-integration">Prometheus Metrics Integration<a href="#prometheus-metrics-integration" class="hash-link" aria-label="Direct link to Prometheus Metrics Integration" title="Direct link to Prometheus Metrics Integration" translate="no">​</a></h2>
<p>Since <code>isolation</code> builds on <code>procmgr</code>, all procmgr Prometheus metrics are available:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="metrics-available">Metrics Available<a href="#metrics-available" class="hash-link" aria-label="Direct link to Metrics Available" title="Direct link to Metrics Available" translate="no">​</a></h3>
<ol>
<li><strong>procmgr_process_state_transitions_total</strong> - Process state changes (labels: process_id, from_state, to_state)</li>
<li><strong>procmgr_process_sync_duration_seconds</strong> - Sync duration histogram</li>
<li><strong>procmgr_process_termination_duration_seconds</strong> - Termination duration histogram</li>
<li><strong>procmgr_process_errors_total</strong> - Error counter (labels: process_id, error_type)</li>
<li><strong>procmgr_process_restarts_total</strong> - Restart counter</li>
<li><strong>procmgr_work_queue_depth</strong> - Current queue depth gauge</li>
<li><strong>procmgr_work_queue_adds_total</strong> - Items added to queue</li>
<li><strong>procmgr_work_queue_retries_total</strong> - Retry attempts</li>
<li><strong>procmgr_work_queue_backoff_duration_seconds</strong> - Backoff duration histogram</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-promql-queries">Example PromQL Queries<a href="#example-promql-queries" class="hash-link" aria-label="Direct link to Example PromQL Queries" title="Direct link to Example PromQL Queries" translate="no">​</a></h3>
<div class="language-promql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-promql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Number of isolated processes per namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">count by (process_id) (procmgr_process_state_transitions_total{process_id=~&quot;ns:.*&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Average sync duration per namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rate(procmgr_process_sync_duration_seconds_sum{process_id=~&quot;ns:.*&quot;}[5m])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ rate(procmgr_process_sync_duration_seconds_count{process_id=~&quot;ns:.*&quot;}[5m])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Error rate by namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rate(procmgr_process_errors_total{process_id=~&quot;ns:.*&quot;}[5m])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Processes in unhealthy state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">procmgr_process_state_transitions_total{to_state!=&quot;Syncing&quot;}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="production-deployment-considerations">Production Deployment Considerations<a href="#production-deployment-considerations" class="hash-link" aria-label="Direct link to Production Deployment Considerations" title="Direct link to Production Deployment Considerations" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="when-to-use-each-isolation-level">When to Use Each Isolation Level<a href="#when-to-use-each-isolation-level" class="hash-link" aria-label="Direct link to When to Use Each Isolation Level" title="Direct link to When to Use Each Isolation Level" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="isolationnone">IsolationNone<a href="#isolationnone" class="hash-link" aria-label="Direct link to IsolationNone" title="Direct link to IsolationNone" translate="no">​</a></h4>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Single-tenant deployments</li>
<li>Development environments</li>
<li>Non-critical workloads</li>
<li>Maximum performance requirements</li>
</ul>
<p><strong>Risks</strong>:</p>
<ul>
<li>No fault isolation</li>
<li>Resource contention</li>
<li>Security boundary only at application level</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="isolationnamespace-recommended">IsolationNamespace (Recommended)<a href="#isolationnamespace-recommended" class="hash-link" aria-label="Direct link to IsolationNamespace (Recommended)" title="Direct link to IsolationNamespace (Recommended)" translate="no">​</a></h4>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Multi-tenant SaaS applications</li>
<li>Enterprise deployments with multiple customers</li>
<li>Compliance requirements for tenant isolation</li>
<li>Predictable tenant workloads</li>
</ul>
<p><strong>Benefits</strong>:</p>
<ul>
<li>Strong fault isolation per tenant</li>
<li>Resource limits per tenant</li>
<li>Clear billing boundaries</li>
<li>Reasonable overhead</li>
</ul>
<p><strong>Recommended Configuration</strong>:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">IsolationConfig</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">          isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IsolationNamespace</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GracePeriodSec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ProcessOptions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">procmgr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Option</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        procmgr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">WithResyncInterval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">60</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        procmgr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">WithBackOffPeriod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        procmgr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">WithMetricsCollector</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prometheusMetrics</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="isolationsession">IsolationSession<a href="#isolationsession" class="hash-link" aria-label="Direct link to IsolationSession" title="Direct link to IsolationSession" translate="no">​</a></h4>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>High-security requirements (PCI, HIPAA)</li>
<li>Untrusted user input</li>
<li>Per-user resource limits</li>
<li>Short-lived sessions</li>
</ul>
<p><strong>Considerations</strong>:</p>
<ul>
<li>Higher resource overhead</li>
<li>Process creation latency</li>
<li>More complex lifecycle management</li>
<li>Best with session pooling/reuse</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="resource-limits">Resource Limits<a href="#resource-limits" class="hash-link" aria-label="Direct link to Resource Limits" title="Direct link to Resource Limits" translate="no">​</a></h3>
<p>Consider setting process-level resource limits using cgroups or systemd:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// In ProcessSyncer.SyncProcess(), configure limits</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmd </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> exec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">CommandContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;systemd-run&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;--scope&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;--property=MemoryMax=512M&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;--property=CPUQuota=50%&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;./backend-process&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-recommendations">Monitoring Recommendations<a href="#monitoring-recommendations" class="hash-link" aria-label="Direct link to Monitoring Recommendations" title="Direct link to Monitoring Recommendations" translate="no">​</a></h3>
<ol>
<li><strong>Alert on high process counts</strong> (indicates scaling issues)</li>
<li><strong>Alert on failed processes</strong> (indicates backend instability)</li>
<li><strong>Track process uptime distribution</strong> (identify restart patterns)</li>
<li><strong>Monitor work queue depth</strong> (indicates scheduling bottlenecks)</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="future-enhancements">Future Enhancements<a href="#future-enhancements" class="hash-link" aria-label="Direct link to Future Enhancements" title="Direct link to Future Enhancements" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-dynamic-isolation-level-switching">1. Dynamic Isolation Level Switching<a href="#1-dynamic-isolation-level-switching" class="hash-link" aria-label="Direct link to 1. Dynamic Isolation Level Switching" title="Direct link to 1. Dynamic Isolation Level Switching" translate="no">​</a></h3>
<p>Allow changing isolation level at runtime based on load:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Promote from None to Namespace under high load</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> currentLoad </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> threshold </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    im</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SetLevel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IsolationNamespace</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-process-pooling">2. Process Pooling<a href="#2-process-pooling" class="hash-link" aria-label="Direct link to 2. Process Pooling" title="Direct link to 2. Process Pooling" translate="no">​</a></h3>
<p>Pre-warm process pools for faster request handling:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Pre-create processes for known tenants</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pool </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewProcessPool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">im</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;tenant-a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tenant-b&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tenant-c&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-adaptive-isolation">3. Adaptive Isolation<a href="#3-adaptive-isolation" class="hash-link" aria-label="Direct link to 3. Adaptive Isolation" title="Direct link to 3. Adaptive Isolation" translate="no">​</a></h3>
<p>Automatically isolate misbehaving tenants:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// If tenant-a has &gt;10 errors, isolate it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> errorRate</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;tenant-a&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    im</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">IsolateTenant</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;tenant-a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> isolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IsolationSession</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-cross-region-isolation">4. Cross-Region Isolation<a href="#4-cross-region-isolation" class="hash-link" aria-label="Direct link to 4. Cross-Region Isolation" title="Direct link to 4. Cross-Region Isolation" translate="no">​</a></h3>
<p>Extend isolation to route requests to region-specific processes:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> IsolationKey </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Namespace </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Session   </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Region    </span><span class="token builtin">string</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// NEW</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="comparison-with-other-approaches">Comparison with Other Approaches<a href="#comparison-with-other-approaches" class="hash-link" aria-label="Direct link to Comparison with Other Approaches" title="Direct link to Comparison with Other Approaches" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="vs-separate-deployments">vs. Separate Deployments<a href="#vs-separate-deployments" class="hash-link" aria-label="Direct link to vs. Separate Deployments" title="Direct link to vs. Separate Deployments" translate="no">​</a></h3>



































<table><thead><tr><th>Aspect</th><th>Process Isolation</th><th>Separate Deployments</th></tr></thead><tbody><tr><td>Overhead</td><td>Low (shared host)</td><td>High (separate hosts)</td></tr><tr><td>Deployment time</td><td>Instant</td><td>Minutes</td></tr><tr><td>Cost</td><td>Shared infrastructure</td><td>Per-deployment cost</td></tr><tr><td>Isolation</td><td>Process-level</td><td>VM/container-level</td></tr><tr><td>Best for</td><td>Many small tenants</td><td>Few large tenants</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="vs-thread-pools">vs. Thread Pools<a href="#vs-thread-pools" class="hash-link" aria-label="Direct link to vs. Thread Pools" title="Direct link to vs. Thread Pools" translate="no">​</a></h3>



































<table><thead><tr><th>Aspect</th><th>Process Isolation</th><th>Thread Pools</th></tr></thead><tbody><tr><td>Crash isolation</td><td>✅ Full</td><td>❌ Shared process space</td></tr><tr><td>Memory isolation</td><td>✅ Separate address space</td><td>❌ Shared heap</td></tr><tr><td>Resource limits</td><td>✅ OS-level cgroups</td><td>❌ Application-level</td></tr><tr><td>Overhead</td><td>Medium</td><td>Low</td></tr><tr><td>Best for</td><td>Untrusted workloads</td><td>Trusted internal services</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="vs-kubernetes-namespaces">vs. Kubernetes Namespaces<a href="#vs-kubernetes-namespaces" class="hash-link" aria-label="Direct link to vs. Kubernetes Namespaces" title="Direct link to vs. Kubernetes Namespaces" translate="no">​</a></h3>



































<table><thead><tr><th>Aspect</th><th>Process Isolation</th><th>K8s Namespaces</th></tr></thead><tbody><tr><td>Granularity</td><td>Per request</td><td>Per deployment</td></tr><tr><td>Startup time</td><td>&lt;50ms</td><td>Seconds to minutes</td></tr><tr><td>Resource overhead</td><td>Single binary</td><td>Full pod + sidecar</td></tr><tr><td>Orchestration</td><td>Built-in</td><td>Requires K8s</td></tr><tr><td>Best for</td><td>Dynamic isolation</td><td>Static tenant boundaries</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion" translate="no">​</a></h2>
<p>The <code>isolation</code> package provides a flexible, production-ready solution for process isolation in Prism. By building on <code>procmgr</code>, it inherits robust lifecycle management, health monitoring, and metrics collection while adding multi-tenant isolation capabilities.</p>
<p><strong>Key Takeaways</strong>:</p>
<ol>
<li>✅ <strong>Three isolation levels</strong> (None, Namespace, Session) cover different use cases</li>
<li>✅ <strong>Bulkhead pattern</strong> prevents cascading failures across tenants/sessions</li>
<li>✅ <strong>Built on RFC-034</strong> (procmgr) for robust process management</li>
<li>✅ <strong>Pattern runner integration</strong> enables isolated acceptance testing</li>
<li>✅ <strong>Comprehensive testing</strong> (10 tests, all passing)</li>
<li>✅ <strong>Production-ready</strong> with health monitoring and Prometheus metrics</li>
</ol>
<p><strong>Recommended Default</strong>: <code>IsolationNamespace</code> for multi-tenant production deployments (balances isolation and resource efficiency)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References" translate="no">​</a></h2>
<ol>
<li><a href="/prism-data-layer/rfc/rfc-034">RFC-034: Robust Process Manager Package</a></li>
<li><a href="https://github.com/jrepp/prism-data-layer/tree/main/pkg/procmgr/README.md" target="_blank" rel="noopener noreferrer">pkg/procmgr/README.md</a></li>
<li><a href="https://github.com/jrepp/prism-data-layer/tree/main/pkg/isolation/README.md" target="_blank" rel="noopener noreferrer">pkg/isolation/README.md</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/bulkhead" target="_blank" rel="noopener noreferrer">Bulkhead Pattern - Microsoft Azure</a></li>
<li><a href="https://pragprog.com/titles/mnee2/release-it-second-edition/" target="_blank" rel="noopener noreferrer">Release It! - Michael Nygard</a> (Bulkhead pattern origin)</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="appendix-a-complete-code-example">Appendix A: Complete Code Example<a href="#appendix-a-complete-code-example" class="hash-link" aria-label="Direct link to Appendix A: Complete Code Example" title="Direct link to Appendix A: Complete Code Example" translate="no">​</a></h2>
<p>See <code>tests/acceptance/framework/isolation_example_test.go</code> for complete runnable examples demonstrating all three isolation levels.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="appendix-b-performance-benchmark-results">Appendix B: Performance Benchmark Results<a href="#appendix-b-performance-benchmark-results" class="hash-link" aria-label="Direct link to Appendix B: Performance Benchmark Results" title="Direct link to Appendix B: Performance Benchmark Results" translate="no">​</a></h2>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">BenchmarkIsolationManager_GetOrCreateProcess_None-8       100000    10523 ns/op</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BenchmarkIsolationManager_GetOrCreateProcess_Namespace-8   50000    28742 ns/op</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BenchmarkIsolationManager_GetOrCreateProcess_Session-8     50000    29183 ns/op</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BenchmarkIsolationManager_TerminateProcess-8               30000    45891 ns/op</span><br></span></code></pre></div></div>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>Process creation: ~10-30ms depending on isolation level</li>
<li>Termination: ~45ms (includes graceful shutdown)</li>
<li>Acceptable for test frameworks and production request routing</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/prism-data-layer/memos/tags/isolation">isolation</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/prism-data-layer/memos/tags/bulkhead">bulkhead</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/prism-data-layer/memos/tags/procmgr">procmgr</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/prism-data-layer/memos/tags/patterns">patterns</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/prism-data-layer/memos/tags/reliability">reliability</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/prism-data-layer/memos/tags/multi-tenancy">multi-tenancy</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/prism-data-layer/memos/tags/fault-isolation">fault-isolation</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/jrepp/prism-data-layer/tree/main/docs-cms/../docs-cms/memos/MEMO-033-process-isolation-bulkhead-pattern.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/prism-data-layer/memos/memo-032"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Driver Test Consolidation Strategy • MEMO-032</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#executive-summary" class="table-of-contents__link toc-highlight">Executive Summary</a></li><li><a href="#background" class="table-of-contents__link toc-highlight">Background</a><ul><li><a href="#problem-statement" class="table-of-contents__link toc-highlight">Problem Statement</a></li><li><a href="#prior-art-bulkhead-pattern" class="table-of-contents__link toc-highlight">Prior Art: Bulkhead Pattern</a></li></ul></li><li><a href="#architecture" class="table-of-contents__link toc-highlight">Architecture</a><ul><li><a href="#components" class="table-of-contents__link toc-highlight">Components</a></li><li><a href="#three-isolation-levels" class="table-of-contents__link toc-highlight">Three Isolation Levels</a></li></ul></li><li><a href="#implementation-details" class="table-of-contents__link toc-highlight">Implementation Details</a><ul><li><a href="#core-types" class="table-of-contents__link toc-highlight">Core Types</a></li><li><a href="#process-id-generation" class="table-of-contents__link toc-highlight">Process ID Generation</a></li><li><a href="#process-lifecycle" class="table-of-contents__link toc-highlight">Process Lifecycle</a></li><li><a href="#integration-with-procmgr" class="table-of-contents__link toc-highlight">Integration with procmgr</a></li></ul></li><li><a href="#pattern-runner-integration" class="table-of-contents__link toc-highlight">Pattern Runner Integration</a><ul><li><a href="#framework-enhancement" class="table-of-contents__link toc-highlight">Framework Enhancement</a></li><li><a href="#isolatedbackend-wrapper" class="table-of-contents__link toc-highlight">IsolatedBackend Wrapper</a></li></ul></li><li><a href="#usage-examples" class="table-of-contents__link toc-highlight">Usage Examples</a><ul><li><a href="#example-1-no-isolation-development" class="table-of-contents__link toc-highlight">Example 1: No Isolation (Development)</a></li><li><a href="#example-2-namespace-isolation-multi-tenant" class="table-of-contents__link toc-highlight">Example 2: Namespace Isolation (Multi-Tenant)</a></li><li><a href="#example-3-session-isolation-high-security" class="table-of-contents__link toc-highlight">Example 3: Session Isolation (High Security)</a></li></ul></li><li><a href="#testing" class="table-of-contents__link toc-highlight">Testing</a><ul><li><a href="#test-coverage" class="table-of-contents__link toc-highlight">Test Coverage</a></li><li><a href="#framework-integration-tests" class="table-of-contents__link toc-highlight">Framework Integration Tests</a></li></ul></li><li><a href="#performance-characteristics" class="table-of-contents__link toc-highlight">Performance Characteristics</a><ul><li><a href="#process-creation-overhead" class="table-of-contents__link toc-highlight">Process Creation Overhead</a></li><li><a href="#memory-footprint" class="table-of-contents__link toc-highlight">Memory Footprint</a></li><li><a href="#failure-isolation" class="table-of-contents__link toc-highlight">Failure Isolation</a></li></ul></li><li><a href="#health-monitoring" class="table-of-contents__link toc-highlight">Health Monitoring</a><ul><li><a href="#health-metrics" class="table-of-contents__link toc-highlight">Health Metrics</a></li><li><a href="#health-reporter" class="table-of-contents__link toc-highlight">Health Reporter</a></li><li><a href="#example-health-report" class="table-of-contents__link toc-highlight">Example Health Report</a></li></ul></li><li><a href="#prometheus-metrics-integration" class="table-of-contents__link toc-highlight">Prometheus Metrics Integration</a><ul><li><a href="#metrics-available" class="table-of-contents__link toc-highlight">Metrics Available</a></li><li><a href="#example-promql-queries" class="table-of-contents__link toc-highlight">Example PromQL Queries</a></li></ul></li><li><a href="#production-deployment-considerations" class="table-of-contents__link toc-highlight">Production Deployment Considerations</a><ul><li><a href="#when-to-use-each-isolation-level" class="table-of-contents__link toc-highlight">When to Use Each Isolation Level</a></li><li><a href="#resource-limits" class="table-of-contents__link toc-highlight">Resource Limits</a></li><li><a href="#monitoring-recommendations" class="table-of-contents__link toc-highlight">Monitoring Recommendations</a></li></ul></li><li><a href="#future-enhancements" class="table-of-contents__link toc-highlight">Future Enhancements</a><ul><li><a href="#1-dynamic-isolation-level-switching" class="table-of-contents__link toc-highlight">1. Dynamic Isolation Level Switching</a></li><li><a href="#2-process-pooling" class="table-of-contents__link toc-highlight">2. Process Pooling</a></li><li><a href="#3-adaptive-isolation" class="table-of-contents__link toc-highlight">3. Adaptive Isolation</a></li><li><a href="#4-cross-region-isolation" class="table-of-contents__link toc-highlight">4. Cross-Region Isolation</a></li></ul></li><li><a href="#comparison-with-other-approaches" class="table-of-contents__link toc-highlight">Comparison with Other Approaches</a><ul><li><a href="#vs-separate-deployments" class="table-of-contents__link toc-highlight">vs. Separate Deployments</a></li><li><a href="#vs-thread-pools" class="table-of-contents__link toc-highlight">vs. Thread Pools</a></li><li><a href="#vs-kubernetes-namespaces" class="table-of-contents__link toc-highlight">vs. Kubernetes Namespaces</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li><li><a href="#appendix-a-complete-code-example" class="table-of-contents__link toc-highlight">Appendix A: Complete Code Example</a></li><li><a href="#appendix-b-performance-benchmark-results" class="table-of-contents__link toc-highlight">Appendix B: Performance Benchmark Results</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/docs/intro">Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/docs/changelog">Change Log</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/adr">ADRs</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/rfc">RFCs</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/memos">Memos</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/prds">PRDs</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Project</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/jrepp/prism-data-layer" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><div>Copyright © 2025 Prism. Built with Docusaurus.</div><div style="margin-top:0.5rem;font-size:0.875rem;opacity:0.8"><span>Version <!-- -->47bd04a</span><span> • </span><span>Built <!-- -->Oct 15, 2025, 09:36 AM PDT</span><span> • </span><span>Commit <!-- -->47bd04a</span></div></div></div></div></footer></div>
</body>
</html>