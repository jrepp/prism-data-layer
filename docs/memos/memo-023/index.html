<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-memos docs-version-current docs-doc-page docs-doc-id-memo-023" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">MEMO-023: Multi-Tenancy Models and Isolation Strategies | Prism</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://jrepp.github.io/prism-data-layer/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://jrepp.github.io/prism-data-layer/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://jrepp.github.io/prism-data-layer/memos/memo-023"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-memos-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-memos-current"><meta data-rh="true" property="og:title" content="MEMO-023: Multi-Tenancy Models and Isolation Strategies | Prism"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/prism-data-layer/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jrepp.github.io/prism-data-layer/memos/memo-023"><link data-rh="true" rel="alternate" href="https://jrepp.github.io/prism-data-layer/memos/memo-023" hreflang="en"><link data-rh="true" rel="alternate" href="https://jrepp.github.io/prism-data-layer/memos/memo-023" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Multi-Tenancy Models and Isolation Strategies • MEMO-023","item":"https://jrepp.github.io/prism-data-layer/memos/memo-023"}]}</script><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=yes">
<meta name="theme-color" content="#6366f1">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="stylesheet" href="/prism-data-layer/assets/css/styles.73adf43b.css">
<script src="/prism-data-layer/assets/js/runtime~main.a2a16cbe.js" defer="defer"></script>
<script src="/prism-data-layer/assets/js/main.607f16d9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/prism-data-layer/"><div class="navbar__logo"><img src="/prism-data-layer/img/prism-logo-transparent-background.png" alt="Prism Data Gateway Logo" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="32"><img src="/prism-data-layer/img/prism-logo-transparent-background.png" alt="Prism Data Gateway Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="32"></div><b class="navbar__title text--truncate">Prism</b></a><a class="navbar__item navbar__link" href="/prism-data-layer/docs/intro">Overview</a><a class="navbar__item navbar__link" href="/prism-data-layer/docs/changelog">Change Log</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Documentation</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/prism-data-layer/adr">ADRs (Architecture Decision Records)</a></li><li><a class="dropdown__link" href="/prism-data-layer/rfc">RFCs (Request for Comments)</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/prism-data-layer/memos">Memos (Technical Analysis)</a></li><li><a class="dropdown__link" href="/prism-data-layer/prds">PRDs (Product Requirements)</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="buildInfo_asc2"><span class="version_ADrX" title="Build: b5cdb9d">b5cdb9d</span><span class="separator_VfCt">•</span><span class="buildTime_n1Nn" title="Last updated: Oct 15, 9:15 AM PDT">Oct 15, 9:15 AM PDT</span></div><div class="navbar__item"><a href="https://github.com/jrepp/prism-data-layer/actions/workflows/docs.yml" target="_blank" rel="noopener noreferrer" title="GitHub Pages" style="display: flex; align-items: center; padding: 0 0.5rem;"><img src="https://github.com/jrepp/prism-data-layer/actions/workflows/docs.yml/badge.svg" alt="Build" style="margin: 0;"></a></div><a href="https://github.com/jrepp/prism-data-layer" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_x44X"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/prism-data-layer/memos/"><span title="Technical Memos" class="linkLabel_WmDU">Technical Memos</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/prism-data-layer/memos/memo-001"><span title="MEMO-001 to 010" class="categoryLinkLabel_W154">MEMO-001 to 010</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/prism-data-layer/memos/memo-011"><span title="MEMO-011 to 020" class="categoryLinkLabel_W154">MEMO-011 to 020</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/prism-data-layer/memos/memo-021"><span title="MEMO-021 to 030" class="categoryLinkLabel_W154">MEMO-021 to 030</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/prism-data-layer/memos/memo-021"><span title="Parallel Linting System for Multi-Language Monorepo • MEMO-021" class="linkLabel_WmDU">Parallel Linting System for Multi-Language Monorepo • MEMO-021</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/prism-data-layer/memos/memo-022"><span title="Prismctl OIDC Integration Testing Requirements • MEMO-022" class="linkLabel_WmDU">Prismctl OIDC Integration Testing Requirements • MEMO-022</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/prism-data-layer/memos/memo-023"><span title="Multi-Tenancy Models and Isolation Strategies • MEMO-023" class="linkLabel_WmDU">Multi-Tenancy Models and Isolation Strategies • MEMO-023</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/prism-data-layer/memos/memo-030"><span title="Pattern-Based Acceptance Testing Framework • MEMO-030" class="linkLabel_WmDU">Pattern-Based Acceptance Testing Framework • MEMO-030</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/prism-data-layer/memos/memo-031"><span title="MEMO-031 to 040" class="categoryLinkLabel_W154">MEMO-031 to 040</span></a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/prism-data-layer/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">MEMO-021 to 030</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Multi-Tenancy Models and Isolation Strategies • MEMO-023</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="docMetadata_NQcq"><div class="tagsRow_ipDH"><span class="tag_VbXK">tenancy</span><span class="tag_VbXK">isolation</span><span class="tag_VbXK">architecture</span><span class="tag_VbXK">deployment</span><span class="tag_VbXK">security</span></div><div class="metadataRow_PvZM"><span class="metadataItem_RMFE"><strong>Author:</strong> <!-- -->Jacob Repp</span><span class="metadataItem_RMFE"><strong>Created:</strong> <!-- -->Oct 12, 2025</span><span class="metadataItem_RMFE"><strong>Updated:</strong> <!-- -->Oct 12, 2025</span></div></div><div class="theme-doc-markdown markdown"><header><h1>Multi-Tenancy Models and Isolation Strategies</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview" translate="no">​</a></h2>
<p>Prism is designed to support multiple tenancy models with configurable component isolation at the proxy level. This flexibility allows organizations to choose the right balance between resource efficiency, performance isolation, security boundaries, and operational complexity based on their specific requirements.</p>
<p>This memo explores three primary tenancy models and three isolation levels, providing guidance on when to use each approach and how to configure Prism accordingly.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tenancy-models">Tenancy Models<a href="#tenancy-models" class="hash-link" aria-label="Direct link to Tenancy Models" title="Direct link to Tenancy Models" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-single-tenancy-self-managed">1. Single Tenancy (Self-Managed)<a href="#1-single-tenancy-self-managed" class="hash-link" aria-label="Direct link to 1. Single Tenancy (Self-Managed)" title="Direct link to 1. Single Tenancy (Self-Managed)" translate="no">​</a></h3>
<p><strong>Architecture</strong>: One proxy deployment per tenant, fully isolated infrastructure.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ Tenant A (Large Enterprise Application)            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌──────────────────────────────────────── ──┐     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │ Prism Proxy Cluster (N-way deployment)   │     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                           │     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ┌────────┐  ┌────────┐  ┌────────┐     │     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │Proxy-1 │  │Proxy-2 │  │Proxy-N │     │     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  └────────┘  └────────┘  └────────┘     │     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └──────────────────────────────────────────┘     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           │           │           │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           └───────────┴───────────┘                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                       │                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌──────────────────────────────────────────┐     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │ Dedicated Backend Infrastructure         │     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  • Redis cluster                         │     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  • NATS cluster                          │     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  • PostgreSQL instance                   │     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  • Kafka cluster                         │     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └──────────────────────────────────────────┘     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ Tenant B (Separate Infrastructure)                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  [Similar isolated deployment]                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────┘</span><br></span></code></pre></div></div>
<p><strong>Use Cases</strong>:</p>
<ul>
<li><strong>Large enterprise applications</strong> with high throughput requirements (&gt;10K RPS)</li>
<li><strong>Regulatory compliance</strong> requirements mandating physical infrastructure separation (HIPAA, PCI-DSS, FedRAMP)</li>
<li><strong>Noisy neighbor elimination</strong> for mission-critical applications</li>
<li><strong>Independent upgrade cycles</strong> - tenant controls when to upgrade Prism versions</li>
<li><strong>Custom performance tuning</strong> - dedicated resources can be sized precisely for workload</li>
</ul>
<p><strong>Characteristics</strong>:</p>
<ul>
<li><strong>Complete isolation</strong>: No shared infrastructure between tenants</li>
<li><strong>Dedicated resources</strong>: CPU, memory, network, storage all tenant-specific</li>
<li><strong>Independent lifecycle</strong>: Each tenant deployment can be upgraded, scaled, or maintained independently</li>
<li><strong>Maximum performance</strong>: No resource contention with other tenants</li>
<li><strong>Higher cost</strong>: Full infrastructure stack per tenant</li>
</ul>
<p><strong>Configuration Example</strong> (<code>single-tenant-config.yaml</code>):</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> single_tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tenant_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> enterprise</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">customer</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">proxy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># N-way deployment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;4&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;8Gi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Each tenant gets dedicated proxy cluster</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">cluster</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dedicated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">load_balancer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> haproxy  </span><span class="token comment" style="color:#999988;font-style:italic"># or nginx, envoy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">backends</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># All backends are tenant-specific</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;redis.tenant-a.svc.cluster.local:6379&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">isolation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> physical</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">nats</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;nats.tenant-a.svc.cluster.local:4222&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">isolation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> physical</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">postgres</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;postgres.tenant-a.svc.cluster.local:5432&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">database</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tenant_a_db&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">isolation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> physical</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">observability</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Dedicated observability stack</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">metrics_endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;prometheus.tenant-a.svc:9090&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">traces_endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tempo.tenant-a.svc:4317&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">logs_endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;loki.tenant-a.svc:3100&quot;</span><br></span></code></pre></div></div>
<p><strong>Deployment Patterns</strong>:</p>
<ol>
<li>
<p><strong>Kubernetes Namespace per Tenant</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create namespace tenant-a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> prism-proxy prism/proxy </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">--namespace</span><span class="token plain"> tenant-a </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">--values</span><span class="token plain"> tenant-a-values.yaml</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Bare Metal / VM Deployment</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Each tenant gets dedicated servers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ansible-playbook deploy-prism.yml </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --extra-vars </span><span class="token string" style="color:#e3116c">&quot;tenant_id=tenant-a servers=proxy-a-[1:5]&quot;</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Cloud Provider (AWS)</strong>:</p>
<div class="language-terraform codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-terraform codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module &quot;prism_tenant_a&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  source = &quot;./modules/prism-single-tenant&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tenant_id = &quot;tenant-a&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  vpc_id = aws_vpc.tenant_a.id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  proxy_count = 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  instance_type = &quot;c6i.2xlarge&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
</li>
</ol>
<p><strong>Operational Considerations</strong>:</p>
<ul>
<li><strong>Cost</strong>: Highest per-tenant cost due to dedicated infrastructure</li>
<li><strong>Maintenance</strong>: Requires separate maintenance windows per tenant</li>
<li><strong>Monitoring</strong>: Dedicated observability stack per tenant increases operational overhead</li>
<li><strong>Networking</strong>: Requires careful network segmentation and firewall rules</li>
<li><strong>Disaster Recovery</strong>: Each tenant needs independent backup and recovery procedures</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-multi-tenant-shared-proxy-pool">2. Multi-Tenant (Shared Proxy Pool)<a href="#2-multi-tenant-shared-proxy-pool" class="hash-link" aria-label="Direct link to 2. Multi-Tenant (Shared Proxy Pool)" title="Direct link to 2. Multi-Tenant (Shared Proxy Pool)" translate="no">​</a></h3>
<p><strong>Architecture</strong>: Control plane manages pool of proxies using <code>prism-bridge</code>, serving multiple tenants.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ Prism Control Plane (prism-bridge)                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌──────────────────────────────────────────────────┐      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │ Namespace Registry                                │      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  • tenant-a → proxy-pool-1                       │      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  • tenant-b → proxy-pool-1                       │      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  • tenant-c → proxy-pool-2 (premium tier)        │      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └──────────────────────────────────────────────────┘      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌──────────────────────────────────────────────────┐      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │ Load Balancer Integration                        │      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  • HAProxy config generation                     │      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  • DNS-based routing                             │      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  • Service mesh integration (Istio/Linkerd)      │      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └──────────────────────────────────────────────────┘      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ┌───────────────┼───────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          │               │               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┌─────────▼─────┐  ┌──────▼──────┐  ┌────▼──────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ Proxy Pool 1  │  │ Proxy Pool 2│  │ Proxy Pool N  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ (Standard)    │  │ (Premium)   │  │ (High-Perf)   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│               │  │             │  │               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ┌────┐ ┌────┐│  │ ┌────┐      │  │ ┌────┐        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ │Px-1│ │Px-2││  │ │Px-3│      │  │ │Px-N│        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ └────┘ └────┘│  │ └────┘      │  │ └────┘        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└───────────────┘  └─────────────┘  └───────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        │                 │                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌───────▼─────────────────▼─────────────────▼──────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ Shared Backend Infrastructure (with namespacing)     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  • Redis (multi-db or keyspace prefixes)             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  • NATS (subject hierarchies: tenant-a.*, tenant-b.*)│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  • PostgreSQL (row-level security, schemas)          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  • Kafka (topic prefixes: tenant-a.*, tenant-b.*)    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──────────────────────────────────────────────────────┘</span><br></span></code></pre></div></div>
<p><strong>Use Cases</strong>:</p>
<ul>
<li><strong>SaaS platforms</strong> serving hundreds or thousands of customers</li>
<li><strong>Internal platform teams</strong> providing data access as a service</li>
<li><strong>Cost optimization</strong> when complete isolation is not required</li>
<li><strong>Rapid tenant onboarding</strong> - add new tenants without provisioning infrastructure</li>
<li><strong>Development/staging environments</strong> where isolation requirements are lower</li>
</ul>
<p><strong>Characteristics</strong>:</p>
<ul>
<li><strong>Shared proxy infrastructure</strong>: Multiple tenants route through same proxy pool</li>
<li><strong>Logical isolation</strong>: Namespacing and access control separate tenant data</li>
<li><strong>Resource efficiency</strong>: Higher utilization through multiplexing</li>
<li><strong>Centralized management</strong>: Single control plane manages all tenants</li>
<li><strong>Noisy neighbor risk</strong>: One tenant&#x27;s traffic can impact others</li>
</ul>
<p><strong>Configuration Example</strong> (<code>multi-tenant-config.yaml</code>):</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> multi_tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">control_plane</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prism</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">prism_bridge</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Control plane for managing proxy pools</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">listen_addr</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0.0.0.0:8980&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Namespace-to-pool mapping</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace_routing</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tenant-a-*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;standard&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">weight</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tenant-b-*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;standard&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">weight</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;premium-*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;premium&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">weight</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Load balancer integration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">load_balancer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> haproxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">config_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/etc/haproxy/haproxy.cfg&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">reload_command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;systemctl reload haproxy&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Service discovery integration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">service_discovery</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kubernetes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">label_selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;app=prism-proxy&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">proxy_pools</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">standard</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;4Gi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">isolation_level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> namespace  </span><span class="token comment" style="color:#999988;font-style:italic"># See isolation section below</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">premium</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;4&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;8Gi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">isolation_level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">backends</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Shared backends with logical isolation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;redis-cluster.svc.cluster.local:6379&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">isolation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> keyspace_prefix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tenant:{tenant_id}:{key}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">nats</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;nats.svc.cluster.local:4222&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">isolation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> subject_hierarchy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tenant.{tenant_id}.{subject}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">postgres</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;postgres.svc.cluster.local:5432&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">isolation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> row_level_security</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enable_rls</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">tenant_column</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tenant_id&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kafka</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;kafka.svc.cluster.local:9092&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">isolation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> topic_prefix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{tenant_id}.{topic}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">observability</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Shared observability with tenant labels</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">metrics_endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;prometheus.svc:9090&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">traces_endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tempo.svc:4317&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">logs_endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;loki.svc:3100&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tenant_label</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;prism_tenant_id&quot;</span><br></span></code></pre></div></div>
<p><strong>prism-bridge Architecture</strong>:</p>
<p><code>prism-bridge</code> is the control plane component for multi-tenant deployments:</p>
<ol>
<li><strong>Namespace Registry</strong>: Maps tenant namespaces to proxy pools</li>
<li><strong>Load Balancer Integration</strong>: Generates HAProxy/nginx configs, updates DNS records</li>
<li><strong>Health Monitoring</strong>: Tracks proxy health and removes unhealthy instances</li>
<li><strong>Dynamic Routing</strong>: Routes tenant requests to appropriate proxy pool</li>
<li><strong>Orchestrator Integration</strong>: Works with Kubernetes, Nomad, or other orchestrators</li>
</ol>
<p><strong>Example prism-bridge API</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Register new tenant</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-X</span><span class="token plain"> POST http://prism-bridge:8980/api/v1/tenants </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-H</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Content-Type: application/json&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;tenant_id&quot;: &quot;tenant-c&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;namespace_pattern&quot;: &quot;tenant-c-*&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;pool&quot;: &quot;standard&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;isolation_level&quot;: &quot;namespace&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  }&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Get tenant routing info</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://prism-bridge:8980/api/v1/tenants/tenant-c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># List available proxy pools</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://prism-bridge:8980/api/v1/pools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Update load balancer configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-X</span><span class="token plain"> POST http://prism-bridge:8980/api/v1/loadbalancer/reload</span><br></span></code></pre></div></div>
<p><strong>Orchestrator Integration</strong>:</p>
<ol>
<li>
<p><strong>Kubernetes (Controller Pattern)</strong>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prism.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PrismTenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tenant</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> standard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">isolation_level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespaces</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> tenant</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> tenant</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">staging</span><br></span></code></pre></div></div>
<p>prism-bridge watches for <code>PrismTenant</code> CRDs and updates routing accordingly.</p>
</li>
<li>
<p><strong>Nomad (Service Discovery)</strong>:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">job &quot;prism-bridge&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  group &quot;control-plane&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    task &quot;bridge&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      driver = &quot;docker&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      config {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image = &quot;prism/bridge:latest&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      service {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name = &quot;prism-bridge&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port = &quot;api&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tags = [&quot;control-plane&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Bare Metal (Address Lists)</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># prism-bridge maintains address list file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prism-bridge get-addresses </span><span class="token parameter variable" style="color:#36acaa">--pool</span><span class="token plain"> standard </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /etc/haproxy/backends-standard.lst</span><br></span></code></pre></div></div>
</li>
</ol>
<p><strong>Operational Considerations</strong>:</p>
<ul>
<li><strong>Cost</strong>: Significantly lower per-tenant cost (10-100x reduction)</li>
<li><strong>Noisy Neighbors</strong>: Requires careful resource limits and quality of service policies</li>
<li><strong>Security</strong>: Strong authentication and authorization critical (mTLS, namespace-based ACLs)</li>
<li><strong>Monitoring</strong>: Must track per-tenant metrics to identify noisy neighbors</li>
<li><strong>Scalability</strong>: Can scale to thousands of tenants on same infrastructure</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-hybrid-tenancy-tiered-service">3. Hybrid Tenancy (Tiered Service)<a href="#3-hybrid-tenancy-tiered-service" class="hash-link" aria-label="Direct link to 3. Hybrid Tenancy (Tiered Service)" title="Direct link to 3. Hybrid Tenancy (Tiered Service)" translate="no">​</a></h3>
<p><strong>Architecture</strong>: Combination of single-tenant for premium customers and multi-tenant for standard customers.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌──────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ Prism Control Plane (prism-bridge)                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  Tenant Routing Rules:                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    • enterprise-tier-* → dedicated proxy pools       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    • standard-tier-*   → shared proxy pools          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└───────────────┬──────────────────┬───────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                │                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ┌───────▼────────┐   ┌─────▼──────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        │ Enterprise     │   │ Standard       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        │ Dedicated      │   │ Shared Pool    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        │ Proxy Pool     │   │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        └────────────────┘   └────────────────┘</span><br></span></code></pre></div></div>
<p><strong>Use Cases</strong>:</p>
<ul>
<li><strong>Tiered SaaS pricing</strong>: Enterprise customers get dedicated resources</li>
<li><strong>Migration path</strong>: Start multi-tenant, upgrade to single-tenant as customers grow</li>
<li><strong>Compliance boundaries</strong>: Some customers require dedicated infrastructure, others don&#x27;t</li>
<li><strong>Performance SLAs</strong>: Different SLAs for different customer tiers</li>
</ul>
<p><strong>Configuration Example</strong>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> hybrid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">tenant_routing</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">rules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">match</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">tier</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> enterprise</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">annual_revenue</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&gt;100000&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">action</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> single_tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dedicated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">match</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">tier</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> premium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">action</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> multi_tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> premium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">isolation_level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">match</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">tier</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> standard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">action</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> multi_tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> standard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">isolation_level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> namespace</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="isolation-levels">Isolation Levels<a href="#isolation-levels" class="hash-link" aria-label="Direct link to Isolation Levels" title="Direct link to Isolation Levels" translate="no">​</a></h2>
<p>Isolation levels control how tenant workloads are separated <strong>within</strong> a shared proxy deployment. These can be configured independently of the tenancy model.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-none-no-isolation">1. None (No Isolation)<a href="#1-none-no-isolation" class="hash-link" aria-label="Direct link to 1. None (No Isolation)" title="Direct link to 1. None (No Isolation)" translate="no">​</a></h3>
<p><strong>Description</strong>: No enforced bulkhead between tenant data. All tenants share the same connection pools and backend resources.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ Prism Proxy                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌────────────────────────────┐    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │ Shared Connection Pool     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  • 100 Redis connections   │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  • 50 NATS connections     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  • 20 PostgreSQL conns     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └────────────────────────────┘    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  All tenants use same connections   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────┘</span><br></span></code></pre></div></div>
<p><strong>When to Use</strong>:</p>
<ul>
<li><strong>Development environments</strong> where isolation is not a concern</li>
<li><strong>Single logical application</strong> with multiple &quot;namespaces&quot; that are actually just organizational units</li>
<li><strong>Maximum performance</strong> - connection pooling and multiplexing reduce latency</li>
<li><strong>Trusted tenants</strong> - all tenants are internal teams within same organization</li>
</ul>
<p><strong>Configuration</strong>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">proxy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">isolation_level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">connection_pools</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">max_connections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">shared</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nats</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">max_connections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">shared</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre></div></div>
<p><strong>Security Implications</strong>:</p>
<ul>
<li>⚠️ <strong>No tenant isolation</strong>: One tenant can exhaust connections for others</li>
<li>⚠️ <strong>Cross-tenant visibility</strong>: Application bugs could expose data across tenants</li>
<li>✅ <strong>Use only in trusted environments</strong></li>
</ul>
<p><strong>Performance Characteristics</strong>:</p>
<ul>
<li>✅ <strong>Lowest latency</strong>: No per-request connection setup</li>
<li>✅ <strong>Highest throughput</strong>: Maximum connection reuse</li>
<li>✅ <strong>Lowest resource usage</strong>: Minimal overhead</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-namespace-isolation">2. Namespace Isolation<a href="#2-namespace-isolation" class="hash-link" aria-label="Direct link to 2. Namespace Isolation" title="Direct link to 2. Namespace Isolation" translate="no">​</a></h3>
<p><strong>Description</strong>: Each namespace has its own pool of pattern providers (backend connections). Namespaces are the primary isolation boundary.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ Prism Proxy                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌────────────────────────────────────────────┐    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │ Namespace: tenant-a-production             │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ┌──────────────────────────────────┐     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ Pattern Provider Pool            │     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │  • 20 Redis connections          │     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │  • 10 NATS connections           │     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  └──────────────────────────────────┘     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └────────────────────────────────────────────┘    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌────────────────────────────────────────────┐    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │ Namespace: tenant-b-production             │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ┌ ──────────────────────────────────┐     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ Pattern Provider Pool            │     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │  • 20 Redis connections          │     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │  • 10 NATS connections           │     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  └──────────────────────────────────┘     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └────────────────────────────────────────────┘    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────┘</span><br></span></code></pre></div></div>
<p><strong>When to Use</strong>:</p>
<ul>
<li><strong>Standard multi-tenant SaaS</strong> where tenants share infrastructure but need resource guarantees</li>
<li><strong>Internal platform teams</strong> serving multiple product teams</li>
<li><strong>Noisy neighbor mitigation</strong> - one tenant&#x27;s traffic spike doesn&#x27;t affect others</li>
<li><strong>Compliance requirements</strong> needing logical separation (but not physical)</li>
</ul>
<p><strong>Configuration</strong>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">proxy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">isolation_level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">connection_pools</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">per_namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">connections_per_namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">max_total_connections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Hard limit across all namespaces</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nats</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">connections_per_namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">max_total_connections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">250</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resource_limits</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">per_namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic"># 1 CPU core per namespace</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2Gi&quot;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># 2GB RAM per namespace</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">max_rps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># Max requests per second</span><br></span></code></pre></div></div>
<p><strong>Implementation Details</strong>:</p>
<ol>
<li>
<p><strong>Connection Pool Isolation</strong>:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> NamespaceConnectionPool </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    namespace   </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    redisConns  </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">pool</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pool  </span><span class="token comment" style="color:#999988;font-style:italic">// Dedicated Redis connection pool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    natsConns   </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">pool</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pool  </span><span class="token comment" style="color:#999988;font-style:italic">// Dedicated NATS connection pool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kafkaConns  </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">pool</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pool  </span><span class="token comment" style="color:#999988;font-style:italic">// Dedicated Kafka connection pool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Proxy maintains map: namespace -&gt; pool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pools </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">NamespaceConnectionPool</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;tenant-a-prod&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NewNamespaceConnectionPool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;tenant-a-prod&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;tenant-b-prod&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NewNamespaceConnectionPool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;tenant-b-prod&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Dynamic Pool Creation</strong>:</p>
<ul>
<li>First request from new namespace creates dedicated pool</li>
<li>Pools are lazily initialized (not created until first use)</li>
<li>Idle pools can be garbage collected after timeout</li>
</ul>
</li>
<li>
<p><strong>Resource Accounting</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Query per-namespace resource usage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prismctl metrics namespace tenant-a-prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Connections: Redis=18/20, NATS=7/10, Kafka=3/5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># CPU: 0.7/1.0 cores</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Memory: 1.2/2.0 GiB</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># RPS: 450/1000</span><br></span></code></pre></div></div>
</li>
</ol>
<p><strong>Security Implications</strong>:</p>
<ul>
<li>✅ <strong>Resource isolation</strong>: One tenant cannot exhaust another&#x27;s connections</li>
<li>✅ <strong>Failure isolation</strong>: Connection pool exhaustion in one namespace doesn&#x27;t affect others</li>
<li>⚠️ <strong>Still shared process</strong>: All namespaces run in same proxy process (memory limits apply to whole proxy)</li>
<li>✅ <strong>Authentication required</strong>: Namespace must be authenticated (mTLS, JWT, API key)</li>
</ul>
<p><strong>Performance Characteristics</strong>:</p>
<ul>
<li>✅ <strong>Good latency</strong>: Connections are reused within namespace</li>
<li>✅ <strong>Good throughput</strong>: Each namespace has dedicated resources</li>
<li>⚠️ <strong>Higher memory usage</strong>: N namespaces × M connections per namespace</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-session-isolation">3. Session Isolation<a href="#3-session-isolation" class="hash-link" aria-label="Direct link to 3. Session Isolation" title="Direct link to 3. Session Isolation" translate="no">​</a></h3>
<p><strong>Description</strong>: Shared pool of pattern providers (connections), but each session (client connection) gets dedicated connections that are <strong>not reused</strong> for other sessions. Connections are set up and torn down for each unique session.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ Prism Proxy                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  Session 1 (client-a)                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    ┌──────────────────────────────────┐            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │ Dedicated Connections            │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │  Redis-conn-1, NATS-conn-1       │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    └─────────  ─────────────────────────┘            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          ↓ Torn down when session ends              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  Session 2 (client-b)                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    ┌──────────────────────────────────┐            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │ Dedicated Connections            │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │  Redis-conn-2, NATS-conn-2       │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    └──────────────────────────────────┘            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ⚠️ Connections NOT reused between sessions         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────┘</span><br></span></code></pre></div></div>
<p><strong>When to Use</strong>:</p>
<ul>
<li><strong>Compliance requirements</strong> mandating connection-level isolation (PCI-DSS, HIPAA)</li>
<li><strong>Security-sensitive applications</strong> where connection reuse is prohibited</li>
<li><strong>Audit requirements</strong> needing per-session connection lifecycle tracking</li>
<li><strong>Premium tier customers</strong> who pay for guaranteed dedicated connections</li>
<li><strong>Short-lived sessions</strong> where setup cost is acceptable</li>
</ul>
<p><strong>Configuration</strong>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">proxy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">isolation_level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">session_management</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">connection_reuse</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Key: disable connection reuse</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">max_sessions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic"># Limit concurrent sessions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">session_timeout</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 300s    </span><span class="token comment" style="color:#999988;font-style:italic"># Idle session timeout</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">connection_pools</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">shared</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain">             </span><span class="token comment" style="color:#999988;font-style:italic"># Pool exists but connections are not reused</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">max_connections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># Total pool size</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">per_session_limit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># Max connections per session</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nats</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">max_connections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">250</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">per_session_limit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">audit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">log_connection_lifecycle</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">log_session_lifecycle</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre></div></div>
<p><strong>Implementation Details</strong>:</p>
<ol>
<li>
<p><strong>Session Identification</strong>:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Session </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ID          </span><span class="token builtin">string</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// UUID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ClientID    </span><span class="token builtin">string</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Authenticated client identity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Namespace   </span><span class="token builtin">string</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Tenant namespace</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CreatedAt   time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LastActivity time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Connections  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Connection  </span><span class="token comment" style="color:#999988;font-style:italic">// Dedicated connections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Connection Lifecycle</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Client connects → Session created → Connections established</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                  ↓</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Client sends request → Use session&#x27;s dedicated connections</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                  ↓</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Client disconnects → Session destroyed → Connections closed</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Connection Setup Cost</strong>:</p>
<ul>
<li><strong>Redis</strong>: ~1-2ms per connection setup (TCP + AUTH)</li>
<li><strong>NATS</strong>: ~2-5ms per connection setup (TCP + TLS + AUTH)</li>
<li><strong>PostgreSQL</strong>: ~5-10ms per connection setup (TCP + TLS + AUTH + query cache warm-up)</li>
<li><strong>Kafka</strong>: ~10-50ms per connection setup (TCP + SASL + metadata fetch)</li>
</ul>
</li>
<li>
<p><strong>Audit Trail</strong>:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;event&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;session_created&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;session_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;550e8400-e29b-41d4-a716-446655440000&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;client_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user@example.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;namespace&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tenant-a-prod&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;timestamp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2025-10-13T22:45:00Z&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;event&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;connection_established&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;session_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;550e8400-e29b-41d4-a716-446655440000&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;backend&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;redis&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;connection_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;redis-conn-12345&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;timestamp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2025-10-13T22:45:00.123Z&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;event&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;session_destroyed&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;session_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;550e8400-e29b-41d4-a716-446655440000&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;duration_ms&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">45000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;requests_handled&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">120</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;timestamp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2025-10-13T22:45:45Z&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
</ol>
<p><strong>Security Implications</strong>:</p>
<ul>
<li>✅ <strong>Maximum isolation</strong>: No connection state shared between sessions</li>
<li>✅ <strong>Audit compliance</strong>: Full connection lifecycle tracking</li>
<li>✅ <strong>Credential isolation</strong>: Each session can use different backend credentials</li>
<li>⚠️ <strong>DoS risk</strong>: Malicious client can exhaust connection pool by creating many sessions</li>
</ul>
<p><strong>Performance Characteristics</strong>:</p>
<ul>
<li>⚠️ <strong>Higher latency</strong>: Connection setup cost on every session (5-50ms depending on backend)</li>
<li>⚠️ <strong>Lower throughput</strong>: Cannot reuse connections, must establish fresh connections</li>
<li>⚠️ <strong>Higher resource usage</strong>: More total connections needed (no reuse)</li>
<li>✅ <strong>Predictable latency</strong>: No connection pool contention</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="comparison-matrix">Comparison Matrix<a href="#comparison-matrix" class="hash-link" aria-label="Direct link to Comparison Matrix" title="Direct link to Comparison Matrix" translate="no">​</a></h2>





















































































<table><thead><tr><th>Aspect</th><th>Single Tenancy</th><th>Multi-Tenant</th><th>Isolation: None</th><th>Isolation: Namespace</th><th>Isolation: Session</th></tr></thead><tbody><tr><td><strong>Resource Efficiency</strong></td><td>Low (dedicated infra)</td><td>High (shared)</td><td>Highest</td><td>Medium</td><td>Lower</td></tr><tr><td><strong>Noisy Neighbor Risk</strong></td><td>None</td><td>Medium-High</td><td>High</td><td>Low</td><td>Very Low</td></tr><tr><td><strong>Cost per Tenant</strong></td><td>$1000-10000/month</td><td>$1-100/month</td><td>Lowest</td><td>Medium</td><td>Higher</td></tr><tr><td><strong>Compliance</strong></td><td>Easiest (physical isolation)</td><td>Harder (logical isolation)</td><td>Not suitable</td><td>GDPR, SOC2</td><td>HIPAA, PCI-DSS</td></tr><tr><td><strong>Scalability</strong></td><td>10-100 tenants</td><td>1000-100000 tenants</td><td>Unlimited (within proxy capacity)</td><td>100-1000 namespaces</td><td>100-1000 concurrent sessions</td></tr><tr><td><strong>Performance</strong></td><td>Highest (no contention)</td><td>Good (with limits)</td><td>Highest (connection reuse)</td><td>Good</td><td>Lower (setup cost)</td></tr><tr><td><strong>Setup Latency</strong></td><td>N/A (pre-provisioned)</td><td>Instant (shared pool)</td><td>~1ms</td><td>~1ms</td><td>5-50ms</td></tr><tr><td><strong>Operational Complexity</strong></td><td>High (many deployments)</td><td>Medium (single control plane)</td><td>Lowest</td><td>Medium (pool management)</td><td>Higher (session tracking)</td></tr><tr><td><strong>Blast Radius</strong></td><td>One tenant only</td><td>All tenants in pool</td><td>All tenants</td><td>One namespace</td><td>One session</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="decision-framework">Decision Framework<a href="#decision-framework" class="hash-link" aria-label="Direct link to Decision Framework" title="Direct link to Decision Framework" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="choose-single-tenancy-if">Choose <strong>Single Tenancy</strong> if:<a href="#choose-single-tenancy-if" class="hash-link" aria-label="Direct link to choose-single-tenancy-if" title="Direct link to choose-single-tenancy-if" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> Regulatory compliance requires physical isolation (HIPAA, FedRAMP, PCI-DSS Level 1)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Customer pays &gt;$10K/month and demands dedicated resources</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Throughput requirements exceed 10K RPS per tenant</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Independent upgrade cycles are required</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Maximum performance is critical (trading cost for speed)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="choose-multi-tenant-if">Choose <strong>Multi-Tenant</strong> if:<a href="#choose-multi-tenant-if" class="hash-link" aria-label="Direct link to choose-multi-tenant-if" title="Direct link to choose-multi-tenant-if" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> Serving 100+ customers on SaaS platform</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Cost optimization is priority (shared infrastructure is 10-100x cheaper)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Rapid tenant onboarding is needed (minutes, not days)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Centralized management is preferred</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Noisy neighbor risk is acceptable with proper limits</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="choose-hybrid-if">Choose <strong>Hybrid</strong> if:<a href="#choose-hybrid-if" class="hash-link" aria-label="Direct link to choose-hybrid-if" title="Direct link to choose-hybrid-if" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> You have both enterprise and standard tier customers</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Some customers need dedicated resources, others don&#x27;t</li>
<li class="task-list-item"><input type="checkbox" disabled=""> You want migration path from multi-tenant to single-tenant</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Different SLAs for different customer tiers</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="choose-isolation-none-if">Choose <strong>Isolation: None</strong> if:<a href="#choose-isolation-none-if" class="hash-link" aria-label="Direct link to choose-isolation-none-if" title="Direct link to choose-isolation-none-if" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> Development/staging environment only</li>
<li class="task-list-item"><input type="checkbox" disabled=""> All &quot;tenants&quot; are internal teams (trusted)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Absolute maximum performance is required</li>
<li class="task-list-item"><input type="checkbox" disabled=""> No compliance requirements</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="choose-isolation-namespace-if">Choose <strong>Isolation: Namespace</strong> if:<a href="#choose-isolation-namespace-if" class="hash-link" aria-label="Direct link to choose-isolation-namespace-if" title="Direct link to choose-isolation-namespace-if" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> Production multi-tenant SaaS</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Noisy neighbor mitigation is required</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Compliance requires logical separation (GDPR, SOC2)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Resource guarantees needed per tenant</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="choose-isolation-session-if">Choose <strong>Isolation: Session</strong> if:<a href="#choose-isolation-session-if" class="hash-link" aria-label="Direct link to choose-isolation-session-if" title="Direct link to choose-isolation-session-if" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> Compliance mandates connection-level isolation (PCI-DSS, HIPAA)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Audit requirements need per-session connection tracking</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Premium customers pay for guaranteed dedicated connections</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Sessions are short-lived (&lt;5 minutes)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Connection setup cost (5-50ms) is acceptable</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-examples">Configuration Examples<a href="#configuration-examples" class="hash-link" aria-label="Direct link to Configuration Examples" title="Direct link to Configuration Examples" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-saas-startup-multi-tenant--namespace-isolation">Example 1: SaaS Startup (Multi-Tenant + Namespace Isolation)<a href="#example-1-saas-startup-multi-tenant--namespace-isolation" class="hash-link" aria-label="Direct link to Example 1: SaaS Startup (Multi-Tenant + Namespace Isolation)" title="Direct link to Example 1: SaaS Startup (Multi-Tenant + Namespace Isolation)" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> multi_tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">control_plane</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prism</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">proxy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">isolation_level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">connection_pools</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">per_namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">connections_per_namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">max_total_connections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resource_limits</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">per_namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0.5&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1Gi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">max_rps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">backends</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;redis-cluster.svc:6379&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">isolation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> keyspace_prefix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tenant:{tenant_id}:{key}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">observability</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tenant_label</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;prism_tenant_id&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-enterprise-healthcare-single-tenant--session-isolation">Example 2: Enterprise Healthcare (Single Tenant + Session Isolation)<a href="#example-2-enterprise-healthcare-single-tenant--session-isolation" class="hash-link" aria-label="Direct link to Example 2: Enterprise Healthcare (Single Tenant + Session Isolation)" title="Direct link to Example 2: Enterprise Healthcare (Single Tenant + Session Isolation)" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> single_tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tenant_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> healthcare</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">customer</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">proxy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">isolation_level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">session_management</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">connection_reuse</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">max_sessions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">session_timeout</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 300s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">audit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">log_connection_lifecycle</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">log_session_lifecycle</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">audit_backend</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> s3</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//audit</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">logs/healthcare</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">a/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">backends</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">postgres</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;postgres.healthcare-a.internal:5432&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ssl_mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> require</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">client_cert_auth</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">compliance</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">frameworks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;HIPAA&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SOC2&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">pii_encryption</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">audit_retention_days</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2555</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 7 years</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-3-hybrid-platform-mix-of-enterprise-and-standard">Example 3: Hybrid Platform (Mix of Enterprise and Standard)<a href="#example-3-hybrid-platform-mix-of-enterprise-and-standard" class="hash-link" aria-label="Direct link to Example 3: Hybrid Platform (Mix of Enterprise and Standard)" title="Direct link to Example 3: Hybrid Platform (Mix of Enterprise and Standard)" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> hybrid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">tenant_routing</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">rules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">match</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">tier</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> enterprise</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">contracts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;healthcare-a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;finance-b&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">action</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> single_tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">isolation_level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">match</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">tier</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> premium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">annual_revenue</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&gt;10000&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">action</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> multi_tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> premium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">isolation_level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">connection_pools</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">connections_per_namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">match</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">tier</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> standard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">action</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> multi_tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> standard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">isolation_level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">connection_pools</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">connections_per_namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-roadmap">Implementation Roadmap<a href="#implementation-roadmap" class="hash-link" aria-label="Direct link to Implementation Roadmap" title="Direct link to Implementation Roadmap" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-1-multi-tenant-with-namespace-isolation-poc">Phase 1: Multi-Tenant with Namespace Isolation (POC)<a href="#phase-1-multi-tenant-with-namespace-isolation-poc" class="hash-link" aria-label="Direct link to Phase 1: Multi-Tenant with Namespace Isolation (POC)" title="Direct link to Phase 1: Multi-Tenant with Namespace Isolation (POC)" translate="no">​</a></h3>
<p><strong>Timeline</strong>: 4-6 weeks</p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> Implement namespace-aware connection pooling</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Add per-namespace resource accounting</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Implement prism-bridge basic routing</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Add namespace-based authentication (mTLS, JWT)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Implement Redis keyspace prefix isolation</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Implement NATS subject hierarchy isolation</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Add per-namespace metrics and logging</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-2-session-isolation-and-audit">Phase 2: Session Isolation and Audit<a href="#phase-2-session-isolation-and-audit" class="hash-link" aria-label="Direct link to Phase 2: Session Isolation and Audit" title="Direct link to Phase 2: Session Isolation and Audit" translate="no">​</a></h3>
<p><strong>Timeline</strong>: 3-4 weeks</p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> Implement session lifecycle management</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Add connection-level audit logging</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Implement connection setup/teardown per session</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Add session timeout and cleanup</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Implement audit trail export (S3, CloudWatch Logs)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-3-single-tenant-deployment-automation">Phase 3: Single-Tenant Deployment Automation<a href="#phase-3-single-tenant-deployment-automation" class="hash-link" aria-label="Direct link to Phase 3: Single-Tenant Deployment Automation" title="Direct link to Phase 3: Single-Tenant Deployment Automation" translate="no">​</a></h3>
<p><strong>Timeline</strong>: 4-6 weeks</p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> Create Terraform modules for single-tenant deployment</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Add Kubernetes Helm charts with namespace-per-tenant pattern</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Implement tenant-specific observability stacks</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Add automated backup/restore per tenant</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Create cost tracking per tenant</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-4-prism-bridge-advanced-features">Phase 4: prism-bridge Advanced Features<a href="#phase-4-prism-bridge-advanced-features" class="hash-link" aria-label="Direct link to Phase 4: prism-bridge Advanced Features" title="Direct link to Phase 4: prism-bridge Advanced Features" translate="no">​</a></h3>
<p><strong>Timeline</strong>: 6-8 weeks</p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> Implement load balancer integration (HAProxy, nginx, Envoy)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Add service mesh integration (Istio, Linkerd)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Implement dynamic pool scaling based on load</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Add tenant migration tools (move tenant between pools)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Implement advanced routing (geo, latency-based, weighted)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-5-compliance-and-security-hardening">Phase 5: Compliance and Security Hardening<a href="#phase-5-compliance-and-security-hardening" class="hash-link" aria-label="Direct link to Phase 5: Compliance and Security Hardening" title="Direct link to Phase 5: Compliance and Security Hardening" translate="no">​</a></h3>
<p><strong>Timeline</strong>: 4-6 weeks</p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> HIPAA compliance validation and documentation</li>
<li class="task-list-item"><input type="checkbox" disabled=""> PCI-DSS compliance validation</li>
<li class="task-list-item"><input type="checkbox" disabled=""> SOC2 audit preparation</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Implement field-level encryption for PII</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Add credential rotation automation</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Implement anomaly detection for tenant behavior</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-considerations">Security Considerations<a href="#security-considerations" class="hash-link" aria-label="Direct link to Security Considerations" title="Direct link to Security Considerations" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="authentication-and-authorization">Authentication and Authorization<a href="#authentication-and-authorization" class="hash-link" aria-label="Direct link to Authentication and Authorization" title="Direct link to Authentication and Authorization" translate="no">​</a></h3>
<ol>
<li>
<p><strong>Namespace Authentication</strong>:</p>
<ul>
<li>Every request must include authenticated namespace identity</li>
<li>mTLS (client certificates) or JWT tokens</li>
<li>API keys for less sensitive environments</li>
</ul>
</li>
<li>
<p><strong>Backend Authorization</strong>:</p>
<ul>
<li>Proxy enforces namespace-to-backend access control</li>
<li>Row-level security (PostgreSQL)</li>
<li>Keyspace prefixes (Redis)</li>
<li>Subject hierarchies (NATS)</li>
<li>Topic ACLs (Kafka)</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-isolation">Data Isolation<a href="#data-isolation" class="hash-link" aria-label="Direct link to Data Isolation" title="Direct link to Data Isolation" translate="no">​</a></h3>
<ol>
<li>
<p><strong>At-Rest Encryption</strong>:</p>
<ul>
<li>All backend data encrypted (backend responsibility)</li>
<li>Separate encryption keys per tenant (single-tenant)</li>
<li>Key rotation automation</li>
</ul>
</li>
<li>
<p><strong>In-Transit Encryption</strong>:</p>
<ul>
<li>TLS for all client → proxy connections</li>
<li>TLS for all proxy → backend connections</li>
<li>Certificate validation and pinning</li>
</ul>
</li>
<li>
<p><strong>Cross-Tenant Protection</strong>:</p>
<ul>
<li>Mandatory namespace prefix validation</li>
<li>SQL injection protection (parameterized queries)</li>
<li>Subject/topic ACL enforcement</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="audit-and-compliance">Audit and Compliance<a href="#audit-and-compliance" class="hash-link" aria-label="Direct link to Audit and Compliance" title="Direct link to Audit and Compliance" translate="no">​</a></h3>
<ol>
<li>
<p><strong>Audit Logging</strong>:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;timestamp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2025-10-13T22:45:00Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;tenant_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;healthcare-a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;namespace&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;healthcare-a-prod&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;session_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;550e8400-e29b-41d4-a716-446655440000&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;user_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;doctor@hospital.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;action&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;query&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;resource&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;patient_records&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;result&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;success&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;rows_accessed&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;pii_accessed&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Compliance Reports</strong>:</p>
<ul>
<li>HIPAA audit trail (7-year retention)</li>
<li>GDPR data access logs (right to know)</li>
<li>SOC2 access control reports</li>
<li>PCI-DSS data flow diagrams</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="operational-considerations">Operational Considerations<a href="#operational-considerations" class="hash-link" aria-label="Direct link to Operational Considerations" title="Direct link to Operational Considerations" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring">Monitoring<a href="#monitoring" class="hash-link" aria-label="Direct link to Monitoring" title="Direct link to Monitoring" translate="no">​</a></h3>
<p>Per-tenant metrics to track:</p>
<div class="language-promql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-promql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Request rate per tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rate(prism_requests_total{tenant_id=&quot;tenant-a&quot;}[5m])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Error rate per tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rate(prism_errors_total{tenant_id=&quot;tenant-a&quot;}[5m]) / rate(prism_requests_total{tenant_id=&quot;tenant-a&quot;}[5m])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Latency percentiles per tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">histogram_quantile(0.99, prism_request_duration_seconds{tenant_id=&quot;tenant-a&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Connection pool usage per tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prism_connection_pool_active{tenant_id=&quot;tenant-a&quot;, backend=&quot;redis&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prism_connection_pool_max{tenant_id=&quot;tenant-a&quot;, backend=&quot;redis&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Resource usage per namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prism_namespace_cpu_usage{namespace=&quot;tenant-a-prod&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prism_namespace_memory_usage{namespace=&quot;tenant-a-prod&quot;}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="alerting">Alerting<a href="#alerting" class="hash-link" aria-label="Direct link to Alerting" title="Direct link to Alerting" translate="no">​</a></h3>
<p>Critical alerts:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">alerts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> TenantConnectionPoolExhausted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">condition</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prism_connection_pool_active / prism_connection_pool_max </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"> 0.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">severity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> warning</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">message</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Tenant {{$labels.tenant_id}} using &gt;90% of connection pool&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> TenantHighErrorRate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">condition</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rate(prism_errors_total</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">5m</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">) / rate(prism_requests_total</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">5m</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">) </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"> 0.05</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">severity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> critical</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">message</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Tenant {{$labels.tenant_id}} error rate &gt;5%&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> TenantHighLatency</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">condition</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> histogram_quantile(0.99</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> prism_request_duration_seconds) </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"> 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">severity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> warning</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">message</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Tenant {{$labels.tenant_id}} p99 latency &gt;1s&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="capacity-planning">Capacity Planning<a href="#capacity-planning" class="hash-link" aria-label="Direct link to Capacity Planning" title="Direct link to Capacity Planning" translate="no">​</a></h3>
<p>Resource scaling guidelines:</p>















































<table><thead><tr><th>Tenant Count</th><th>Proxy Replicas</th><th>Total Connections</th><th>Memory per Proxy</th><th>CPU per Proxy</th></tr></thead><tbody><tr><td>10</td><td>2</td><td>200</td><td>4GB</td><td>2 cores</td></tr><tr><td>50</td><td>5</td><td>500</td><td>4GB</td><td>2 cores</td></tr><tr><td>100</td><td>10</td><td>1000</td><td>4GB</td><td>2 cores</td></tr><tr><td>500</td><td>20</td><td>2000</td><td>8GB</td><td>4 cores</td></tr><tr><td>1000</td><td>40</td><td>4000</td><td>8GB</td><td>4 cores</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion" translate="no">​</a></h2>
<p>Prism&#x27;s flexible tenancy and isolation model allows organizations to choose the right balance between cost, performance, security, and operational complexity. Key takeaways:</p>
<ol>
<li><strong>Single-tenant</strong> for enterprise customers with regulatory requirements or &gt;10K RPS</li>
<li><strong>Multi-tenant</strong> for SaaS platforms serving hundreds/thousands of customers</li>
<li><strong>Namespace isolation</strong> for production multi-tenant deployments (standard choice)</li>
<li><strong>Session isolation</strong> only when compliance mandates connection-level isolation</li>
<li><strong>No isolation</strong> only for development/trusted environments</li>
</ol>
<p>The recommended starting point for most SaaS platforms is <strong>multi-tenant with namespace isolation</strong>, as it provides good balance of cost efficiency, noisy neighbor protection, and operational simplicity. Upgrade to single-tenant or session isolation only when specific requirements dictate.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References" translate="no">​</a></h2>
<ul>
<li>ADR-042: Multi-Tenancy Architecture</li>
<li>ADR-043: Namespace-Based Access Control</li>
<li>RFC-025: prism-bridge Control Plane Design</li>
<li>RFC-026: Session Lifecycle Management</li>
<li>RFC-030: Schema Evolution and Pub/Sub Validation (Consumer Metadata)</li>
<li>MEMO-009: Topaz Local Authorizer Configuration (Authorization)</li>
<li>MEMO-016: Observability Lifecycle Implementation (Per-Tenant Metrics)</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/prism-data-layer/memos/tags/tenancy">tenancy</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/prism-data-layer/memos/tags/isolation">isolation</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/prism-data-layer/memos/tags/architecture">architecture</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/prism-data-layer/memos/tags/deployment">deployment</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/prism-data-layer/memos/tags/security">security</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/jrepp/prism-data-layer/tree/main/docs-cms/../docs-cms/memos/memo-023-tenancy-models.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/prism-data-layer/memos/memo-022"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Prismctl OIDC Integration Testing Requirements • MEMO-022</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/prism-data-layer/memos/memo-030"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Pattern-Based Acceptance Testing Framework • MEMO-030</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#tenancy-models" class="table-of-contents__link toc-highlight">Tenancy Models</a><ul><li><a href="#1-single-tenancy-self-managed" class="table-of-contents__link toc-highlight">1. Single Tenancy (Self-Managed)</a></li><li><a href="#2-multi-tenant-shared-proxy-pool" class="table-of-contents__link toc-highlight">2. Multi-Tenant (Shared Proxy Pool)</a></li><li><a href="#3-hybrid-tenancy-tiered-service" class="table-of-contents__link toc-highlight">3. Hybrid Tenancy (Tiered Service)</a></li></ul></li><li><a href="#isolation-levels" class="table-of-contents__link toc-highlight">Isolation Levels</a><ul><li><a href="#1-none-no-isolation" class="table-of-contents__link toc-highlight">1. None (No Isolation)</a></li><li><a href="#2-namespace-isolation" class="table-of-contents__link toc-highlight">2. Namespace Isolation</a></li><li><a href="#3-session-isolation" class="table-of-contents__link toc-highlight">3. Session Isolation</a></li></ul></li><li><a href="#comparison-matrix" class="table-of-contents__link toc-highlight">Comparison Matrix</a></li><li><a href="#decision-framework" class="table-of-contents__link toc-highlight">Decision Framework</a><ul><li><a href="#choose-single-tenancy-if" class="table-of-contents__link toc-highlight">Choose <strong>Single Tenancy</strong> if:</a></li><li><a href="#choose-multi-tenant-if" class="table-of-contents__link toc-highlight">Choose <strong>Multi-Tenant</strong> if:</a></li><li><a href="#choose-hybrid-if" class="table-of-contents__link toc-highlight">Choose <strong>Hybrid</strong> if:</a></li><li><a href="#choose-isolation-none-if" class="table-of-contents__link toc-highlight">Choose <strong>Isolation: None</strong> if:</a></li><li><a href="#choose-isolation-namespace-if" class="table-of-contents__link toc-highlight">Choose <strong>Isolation: Namespace</strong> if:</a></li><li><a href="#choose-isolation-session-if" class="table-of-contents__link toc-highlight">Choose <strong>Isolation: Session</strong> if:</a></li></ul></li><li><a href="#configuration-examples" class="table-of-contents__link toc-highlight">Configuration Examples</a><ul><li><a href="#example-1-saas-startup-multi-tenant--namespace-isolation" class="table-of-contents__link toc-highlight">Example 1: SaaS Startup (Multi-Tenant + Namespace Isolation)</a></li><li><a href="#example-2-enterprise-healthcare-single-tenant--session-isolation" class="table-of-contents__link toc-highlight">Example 2: Enterprise Healthcare (Single Tenant + Session Isolation)</a></li><li><a href="#example-3-hybrid-platform-mix-of-enterprise-and-standard" class="table-of-contents__link toc-highlight">Example 3: Hybrid Platform (Mix of Enterprise and Standard)</a></li></ul></li><li><a href="#implementation-roadmap" class="table-of-contents__link toc-highlight">Implementation Roadmap</a><ul><li><a href="#phase-1-multi-tenant-with-namespace-isolation-poc" class="table-of-contents__link toc-highlight">Phase 1: Multi-Tenant with Namespace Isolation (POC)</a></li><li><a href="#phase-2-session-isolation-and-audit" class="table-of-contents__link toc-highlight">Phase 2: Session Isolation and Audit</a></li><li><a href="#phase-3-single-tenant-deployment-automation" class="table-of-contents__link toc-highlight">Phase 3: Single-Tenant Deployment Automation</a></li><li><a href="#phase-4-prism-bridge-advanced-features" class="table-of-contents__link toc-highlight">Phase 4: prism-bridge Advanced Features</a></li><li><a href="#phase-5-compliance-and-security-hardening" class="table-of-contents__link toc-highlight">Phase 5: Compliance and Security Hardening</a></li></ul></li><li><a href="#security-considerations" class="table-of-contents__link toc-highlight">Security Considerations</a><ul><li><a href="#authentication-and-authorization" class="table-of-contents__link toc-highlight">Authentication and Authorization</a></li><li><a href="#data-isolation" class="table-of-contents__link toc-highlight">Data Isolation</a></li><li><a href="#audit-and-compliance" class="table-of-contents__link toc-highlight">Audit and Compliance</a></li></ul></li><li><a href="#operational-considerations" class="table-of-contents__link toc-highlight">Operational Considerations</a><ul><li><a href="#monitoring" class="table-of-contents__link toc-highlight">Monitoring</a></li><li><a href="#alerting" class="table-of-contents__link toc-highlight">Alerting</a></li><li><a href="#capacity-planning" class="table-of-contents__link toc-highlight">Capacity Planning</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/docs/intro">Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/docs/changelog">Change Log</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/adr">ADRs</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/rfc">RFCs</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/memos">Memos</a></li><li class="footer__item"><a class="footer__link-item" href="/prism-data-layer/prds">PRDs</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Project</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/jrepp/prism-data-layer" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><div>Copyright © 2025 Prism. Built with Docusaurus.</div><div style="margin-top:0.5rem;font-size:0.875rem;opacity:0.8"><span>Version <!-- -->b5cdb9d</span><span> • </span><span>Built <!-- -->Oct 15, 2025, 09:15 AM PDT</span><span> • </span><span>Commit <!-- -->b5cdb9d</span></div></div></div></div></footer></div>
</body>
</html>